var er=Object.defineProperty;var tr=(e,c,v)=>c in e?er(e,c,{enumerable:!0,configurable:!0,writable:!0,value:v}):e[c]=v;var Nt=(e,c,v)=>(tr(e,typeof c!="symbol"?c+"":c,v),v);(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))b(y);new MutationObserver(y=>{for(const E of y)if(E.type==="childList")for(const x of E.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&b(x)}).observe(document,{childList:!0,subtree:!0});function v(y){const E={};return y.integrity&&(E.integrity=y.integrity),y.referrerpolicy&&(E.referrerPolicy=y.referrerpolicy),y.crossorigin==="use-credentials"?E.credentials="include":y.crossorigin==="anonymous"?E.credentials="omit":E.credentials="same-origin",E}function b(y){if(y.ep)return;y.ep=!0;const E=v(y);fetch(y.href,E)}})();const ir="imgs/icons/Apps/";function Re(e){return ir+e}const ie={settings:{name:"settings",productName:"Settings",icon:Re("settings.png")},notepad:{name:"notepad",productName:"NotePad",icon:Re("notepad.png")},explorer:{name:"explorer",productName:"File Explorer",icon:Re("explorer.png")},word:{name:"word",productName:"Word",icon:Re("word.png")},powerpoint:{name:"powerpoint",productName:"PowerPoint",icon:Re("powerpoint.png")},onenote:{name:"onenote",productName:"OneNote",icon:Re("onenote.png")},mail:{name:"mail",productName:"Mail",icon:Re("mail.png")},todo:{name:"todo",productName:"To Do",icon:Re("todo.png")},store:{name:"store",productName:"Store",icon:Re("store.png")},photos:{name:"photos",productName:"Photos (Demo)",icon:Re("photos.png")},yourphone:{name:"yourphone",productName:"Your Phone",icon:Re("yourphone.png")},whiteboard:{name:"whiteboard",productName:"White Board",icon:Re("whiteboard.png")},calculator:{name:"calculator",productName:"Calculator",icon:Re("calculator.png")},spotify:{name:"spotify",productName:"Spotify",icon:Re("spotify.png")},twitter:{name:"twitter",productName:"Twitter",icon:Re("twitter.png")},vscode:{name:"vscode",productName:"VS Code",icon:Re("vscode.png")},terminal:{name:"terminal",productName:"Terminal",icon:Re("terminal.png")},cmd:{name:"cmd",productName:"Command Promt",icon:Re("terminal.png")},github:{name:"github",productName:"GitHub",icon:Re("github.png")},discord:{name:"discord",productName:"Discord",icon:Re("discord.png")}},sr=Object.keys(ie).map(e=>ie[e]);function nr(e,c){return e.name>c.name?1:e.name<c.name?-1:0}function rr(){const e=sr.sort(nr),c={},v=e.length;for(let b=0;b<v;b++){const y=e[b];let E=y.name.substring(0,1).toUpperCase();/[A-Z]/.test(E)||(/[0-9]/.test(E)?E="#":E="&"),c[E]||(c[E]=[]),c[E].push(y)}return c}const wt={photoViewer:{name:"photoViewer",productName:"Photos Viewer",icon:Re("photos.png")},mediaPlayer:{name:"mediaPlayer",productName:"Media Player",icon:Re("media-player.png")}};function nt(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?Dt(e,c):e.appendChild(document.createTextNode(c.toString())))}function Dt(e,c){c instanceof Array?c.forEach(v=>{nt(e,v)}):nt(e,c)}function ve(e,c){for(let v in c)v.indexOf("-")>-1?e.style.setProperty(v,c[v]):v==="myBackgroundImage"?zi(c[v],b=>{e.style.backgroundImage=`url(${b})`}):e.style[v]=c[v]}function $s(e){for(let c of e){if(c.children.length>0){const v=Array.from(c.children);$s(v)}pe(c.onBeforeRemove)&&c.onBeforeRemove()}}Element.prototype.remove=function(){var v;const e=Array.from(this.children);$s(e);const c=this;pe(c.onBeforeRemove)&&c.onBeforeRemove(),(v=this.parentElement)==null||v.removeChild(this)};function w(e,c,v){let b=document.createElement(e);function y(E){zi(E,x=>{b.src=x})}if((e==="img"||e==="audio"||e==="video")&&Object.defineProperty(b,"mySrc",{set:function(E){y(E)}}),c){const E=c;for(let x in E)if(x==="style"){const r=E[x];ve(b,r)}else if(x==="mySrc"){const r=E[x];y(r)}else if(x.indexOf("-")>-1||x.indexOf(":")>-1){const r=E[x];b.setAttribute(x,r)}else b[x]=E[x]}return v&&Dt(b,v),Object.defineProperty(b.style,"myBackgroundImage",{set:function(E){zi(E,x=>{b.style.backgroundImage=`url(${x})`})}}),b}function ot(e){let c=e.firstChild;for(;c;)c.remove(),c=e.firstChild}function zi(e,c){Xe(e)?hs(e,(v,b)=>{if(v)c(null);else{const y=URL.createObjectURL(b);c(y)}}):c(e)}function or(e){let c;const v=Object.create(null);v.width=0,e.color&&(v.backgroundColor=e.color);let b=w("div",{className:"progress"},c=w("div",{className:"progress-value",style:v}));function y(E){c.style.width=E/e.maxValue*100+"%"}return{element:b,setValue:y}}const Us=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,5 10,5 10,6 0,6 Z"></path>
</svg>
`,Wi=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="m 2,1e-5 0,2 -2,0 0,8 8,0 0,-2 2,0 0,-8 z m 1,1 6,0 0,6 -1,0 0,-5 -5,0 z m -2,2 6,0 0,6 -6,0 z"></path>
</svg>
`,$i=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,10 10,10 10,0 Z M 1,1 9,1 9,9 1,9 Z"></path>
</svg>
`,js=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`;function ar(e){const c={};e&&(c.backgroundImage=`url("${e}")`);let v=w("div",{className:"window-titlebar-icon flex content-center items-center flex-shrink-0",style:c});function b(y){G(y)&&(v.style.backgroundImage=`url("${y}")`)}return{element:v,setWindowIcon:b}}const lr={window:{titlebar:{buttons:{minimize:"Minimize",maximize:"Restore Down",maximizeDown:"Maximize",close:"Close"}}}},cr={window:{titlebar:{buttons:{minimize:"Thu gọn",maximize:"Thu nhỏ",maximizeDown:"Phóng to",close:"Đóng"}}}},hr={"en-us":lr,"vi-vn":cr};function dr(e){return hr[e]}function ur(e,c){const v=dr("en-us");let b=r(e.isMaximized),y=w("div",{title:b.title,className:"window-titlebar-button window-titlebar-maximize-button flex items-center content-center"+(e.disableMaximize?" disabled":""),innerHTML:b.icon,onclick:c.onMaximizeButtonClick}),E=w("div",{className:"window-titlebar-buttons flex"},[w("div",{title:v.window.titlebar.buttons.minimize,className:"window-titlebar-button window-titlebar-minimize-button flex items-center content-center",innerHTML:Us,onclick:c.onMinimizeButtonClick}),y,w("div",{title:v.window.titlebar.buttons.close,className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:js,onclick:c.onCloseButtonClick})]);function x(n){let l=r(n);y.title=l.title,y.innerHTML=n?Wi:$i}function r(n){return{title:n?v.window.titlebar.buttons.maximize:v.window.titlebar.buttons.maximizeDown,icon:n?Wi:$i}}return{element:E,setMaximize:x}}function fr(e,c,v,b){let y,E,x=w("div",{tabIndex:-1,className:"window-title h-full flex items-center"+(e.stretchTitlebarContent?" stretch":""),onfocus:b,oncontextmenu:v,ondblclick:e.disableMaximize?null:c},[w("div",{["drag-region"]:"drag",className:"absolute w-full h-full top left-0"}),e.hideTitle?null:w("div",{className:"window-title-text h-full flex items-center"},y=w("div",{title:e.title,className:"text-ellipsis"},e.title)),E=w("div",{className:"window-titlebar-content flex-1 h-full flex items-center relative"+(G(e.content)?"":" hide")},G(e.content)&&pe(e.content)?e.content():e.content)]);function r(l){G(y)&&(y.title=l,y.textContent=l)}function n(l){ot(E),E.classList.remove("hide"),E.appendChild(pe(l)?l():l)}return{element:x,setTitle:r,setContent:n}}function mr(e,c){let v=ar(e.icon),b=fr({title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,content:e.content,stretchTitlebarContent:e.stretchTitlebarContent},c.onDoubleClick,c.onContextMenu,c.onTitleFocus),y=ur({isMaximized:e.maximized,disableMaximize:e.disableMaximize},{onMinimizeButtonClick:c.onMinimizeButtonClick,onMaximizeButtonClick:c.onMaximizeButtonClick,onCloseButtonClick:c.onCloseButtonClick}),E,x=!1;E=w("div",{className:"window-titlebar flex items-center"+(e.hideIcon?" no-icon":"")+(e.hideTitle?" no-title":"")},[v.element,b.element,y.element]),e.autoHide&&(E.addEventListener("mouseover",()=>{x=!0},!1),E.addEventListener("mouseout",()=>{x=!1},!1));function r(m){m?(E.classList.remove("titlebar-fade-in"),x||(E.classList.add("titlebar-fade-out"),c.onHidden&&c.onHidden())):(E.classList.add("titlebar-fade-in"),E.classList.remove("titlebar-fade-out"),c.onVisible&&c.onVisible())}function n(m){x=m}function l(m){m?E.classList.remove("hidden"):E.classList.add("hidden")}return{element:E,titleElem:b.element,setIcon:v.setWindowIcon,setTitle:b.setTitle,setTitlebarContent:b.setContent,setMaximize:y.setMaximize,setVisible:l,setAutoHide:r,setPreventHide:n}}function Vs(e,c,v){var b=0,y=0,E=0,x=0;c?(c.onmousedown=n,c.ontouchstart=l):(e.onmousedown=n,e.ontouchstart=l);let r=!1;function n(f){f.button===0&&(f.preventDefault(),E=f.clientX,x=f.clientY,document.onmouseup=u,document.onmousemove=m,G(v)&&pe(v.onDragStart)&&v.onDragStart())}function l(f){f.preventDefault();const t=f.targetTouches[0];E=t.clientX,x=t.clientY,window.ontouchmove=a,window.ontouchend=d,G(v)&&pe(v.onTouch)&&v.onTouch()}function m(f){b=E-f.clientX,y=x-f.clientY,E=f.clientX,x=f.clientY,h(f.clientX,f.clientY)}function a(f){const t=f.touches[0];b=E-t.clientX,y=x-t.clientY,E=t.clientX,x=t.clientY,h(t.clientX,t.clientY)}function h(f,t){let i=e.offsetTop-y,s=e.offsetLeft-b;r=Math.abs(s)>0||Math.abs(i)>0,e.style.top=i+"px",e.style.left=s+"px",G(v)&&pe(v.onDrag)&&v.onDrag({x:f,y:t},{top:i,left:s})}function u(){r&&G(v)&&pe(v.onDragEnd)&&v.onDragEnd(e),r=!1,document.onmouseup=null,document.onmousemove=null}function d(){r&&G(v)&&pe(v.onDragEnd)&&v.onDragEnd(e),r=!1,window.ontouchmove=null,window.ontouchend=null}}function Je(e,c,v,b,y){let E=v,x=b,r="default",n="";c.onmousedown=T,c.ontouchstart=_;let l=0,m=0,a=0,h=0,u=0,d=0,f=0,t=0,i=0,s=0,o,p,g,C;function T(P){l=P.clientX,m=P.clientY,n=P.currentTarget.dataset.resize,window.addEventListener("mousemove",D,!1),window.addEventListener("mouseup",B,!1),k()}function _(P){P.preventDefault(),l=P.touches[0].clientX,m=P.touches[0].clientY,e.style.outline="12px solid var(--blue-color)",n=P.currentTarget.dataset.resize,window.addEventListener("touchmove",M,!1),window.addEventListener("touchend",H,!1),k()}function k(){let P=window.getComputedStyle(e);a=parseInt(P.left),h=parseInt(P.top),u=e.offsetWidth,d=e.offsetHeight,i=parseInt(P.minHeight),s=parseInt(P.minWidth),G(y)&&pe(y.onResizeStart)&&y.onResizeStart()}function D(P){let L=P.clientX-l+f,I=P.clientY-m+t;l=P.clientX,m=P.clientY,S(L,I)}function M(P){const L=P.touches[0];let I=L.clientX-l+f,A=L.clientY-m+t;l=L.clientX,m=L.clientY,S(I,A)}function S(P,L){f=0,t=0;var I=L,A=P;n==="t"?(r="ns-resize",d-I<i?t=I-(L=d-i):h+I<g&&(t=I-(L=g-h)),h+=L,d-=L,E&&(u=Math.round(d*x))):n==="l"?(r="ew-resize",u-A<s?f=A-(P=u-s):a+A<o&&(f=A-(P=o-a)),a+=P,u-=P,E&&(d=Math.round(u/x))):n==="tl"?(r="nw-resize",u-A<s?f=A-(P=u-s):a+A<o&&(f=A-(P=o-a)),a+=P,u-=P,d-I<i?t=I-(L=d-i):h+I<g&&(t=I-(L=g-h)),h+=L,E?Math.abs(P)>Math.abs(L)?d=Math.round(u/x):u=Math.round(d*x):d-=L):n==="b"?(r="ns-resize",d+I<i?t=I-(L=i-d):h+d+I>C&&(t=I-(L=C-h-d)),d+=L,E&&(u=Math.round(d*x))):n==="bl"?(r="ne-resize",u-A<s?f=A-(P=u-s):a+A<o&&(f=A-(P=o-a)),a+=P,u-=P,E?d=Math.round(u/x):(d+I<i?t=I-(L=i-d):h+d+I>C&&(t=I-(L=C-h-d)),d+=L)):n==="r"?(r="ew-resize",u+A<s?f=A-(P=s-u):a+u+A>p&&(f=A-(P=p-a-u)),u+=P,E&&(d=Math.round(u/x))):n==="tr"?(r="ne-resize",u+A<s?f=A-(P=s-u):a+u+A>p&&(f=A-(P=p-a-u)),u+=P,d-I<i?t=I-(L=d-i):h+I<g&&(t=I-(L=g-h)),h+=L,d-=L,E&&(u=Math.round(d*x))):n==="br"&&(r="nw-resize",u+A<s?f=A-(P=s-u):a+u+A>p&&(f=A-(P=p-a-u)),u+=P,d+I<i?t=I-(L=i-d):h+d+I>C&&(t=I-(L=C-h-d)),d+=L,E&&(u=Math.round(d*x))),e.style.top=h+"px",e.style.left=a+"px",e.style.width=u+"px",e.style.height=d+"px",document.body.style.pointerEvents="none",document.documentElement.style.cursor=r,G(y)&&pe(y.onResize)&&y.onResize({top:h,left:a,width:u,height:d})}function B(){G(y)&&pe(y.onResizeEnd)&&y.onResizeEnd(),document.body.style.pointerEvents="initial",document.documentElement.style.cursor="default",window.removeEventListener("mousemove",D,!1),window.removeEventListener("mouseup",B,!1)}function H(){e.style.outline="none",G(y)&&pe(y.onResizeEnd)&&y.onResizeEnd(),document.body.style.pointerEvents="initial",window.removeEventListener("touchmove",M,!1),window.removeEventListener("touchend",H,!1)}function F(P){x=P}function O(P){E=P}return{setAspectRatio:F,setKeepAspectRatio:O}}const Qi=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],pr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ui=["January","February","March","April","May","June","July","August","September","October","November","December"],Mt=30,_t=38,We=46,gr="imgs/user.gif",Ee={top:"top",left:"left",right:"right",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",topRight:"topRight"},De=()=>"var(--window-icon-color)",vr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
<path
  d="M 3 3 L 11 3 L 11 11 L 3 11 L 3 3 z M 11 13 L 11 21 L 3 21 V 13 L 11 13 z M 13 3 L 21 3 V 11 L 13 11 V 3 z M 21 13 L 21 21 L 13 21 L 13 13 L 21 13 z" />
</svg>
`,es=`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
  <circle cx="12" cy="12" r="3" />
</svg>
`,_r=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="${De()}"><path d="M20 5h-9.586L8.707 3.293A.997.997 0 0 0 8 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2z"></path></svg>
`,Ks=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${De()}" fill="none" stroke-linecap="round">
  <circle cx="12" cy="17" r="1" style="fill: ${De()}" />
  <path d="M9.172 14a4 4 0 0 1 5.656 0" />
  <path d="M6.343 12a8 8 0 0 1 11.314 0" />
  <path d="M3.515 9.5c4.686 -4.687 12.284 -4.687 17 0" />
</svg>
`,qs=`
<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${De()}"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
`,Xs=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke-linejoin="round">
<rect x="5.5" y="7.5" width="14" height="9" stroke="${De()}"/>
<rect x="7" y="9" width="11" height="6" fill="${De()}"/>
<rect x="19.5" y="10" width="1.5" height="4" fill="${De()}"/>
</svg>
`,Gs=`
<svg aria-hidden="true" version="1.1" width="10" height="10">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`,Ys=`
<svg class="svg-stroke" width="14" height="14" viewBox="0 0 24 24" stroke-width="2" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
</svg>
`,wr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke="${De()}" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M7 6a7.75 7.75 0 1 0 10 0" />
<line x1="12" y1="4" x2="12" y2="12" />
</svg>
`,br=`
 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"  stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
 <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
 <path d="M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5" />
</svg>
`,Zs=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="6 15 12 9 18 15" />
</svg>
`,jt=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="${De()}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="9 6 15 12 9 18" />
</svg>
 `,yr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="7 8 17 16 12 20 12 4 17 8 7 16" />
</svg>
`,Sr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M16 10h4a2 2 0 0 1 0 4h-4l-4 7h-3l2 -7h-4l-2 2h-3l2 -4l-2 -4h3l2 2h4l-2 -7h3z" />
</svg>
`,xr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
</svg>
`,Cr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M5 12l5 5l10 -10" />
</svg>
`,Js=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="10" cy="10" r="7" />
<line x1="21" y1="21" x2="15" y2="15" />
</svg>
`,kr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${De()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="12" cy="12" r="4" style="fill: ${De()}"/>
<circle cx="12" cy="12" r="9"/>
</svg>
`,Er=`
<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" class="no-stroke">
  <circle cx="12" cy="12" r="9" fill="#000" />
  <circle cx="12" cy="12" r="8" fill="#fff" />
  <path d="M12 21A2 2 1 0 1 12 3" fill="#000" />
</svg>
`,Lr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${De()}"
  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="12" r="3"></circle>
  <line x1="12" y1="1" x2="12" y2="5"></line>
  <line x1="12" y1="19" x2="12" y2="23"></line>
  <line x1="4" y1="4" x2="7" y2="7"></line>
  <line x1="17" y1="17" x2="20" y2="20"></line>
  <line x1="1" y1="12" x2="5" y2="12"></line>
  <line x1="19" y1="12" x2="23" y2="12"></line>
  <line x1="4" y1="20" x2="7" y2="17"></line>
  <line x1="17" y1="7" x2="20" y2="4"></line>
</svg>
`,Tr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${De()}"
stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<circle cx="12" cy="12" r="5"></circle>
<circle cx="10" cy="11" r="2" fill="${De()}"></circle>
<line x1="12" y1="1" x2="12" y2="3"></line>
<line x1="12" y1="21" x2="12" y2="23"></line>
<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
<line x1="1" y1="12" x2="3" y2="12"></line>
<line x1="21" y1="12" x2="23" y2="12"></line>
<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>
`,Dr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
stroke="${De()}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<path d="M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6">
</path>
<line x1="2" y1="20" x2="2.01" y2="20"></line>
</svg>
`,Mr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke="${De()}">
<rect x="3" y="3" width="18" height="18" />
<line x1="6" x2="10" y1="10" y2="6" />
<line x1="6" x2="18" y1="18" y2="6" />
<line x1="14" x2="18" y1="18" y2="14" />
</svg>
`;function ts(e=24,c=1.5,v=De()){return`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="${v}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<line x1="12" y1="5" x2="12" y2="19" />
<line x1="5" y1="12" x2="19" y2="12" />
</svg>
`}function Ir(e=20,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${c}"
"><rect x="1" y="1" width="22" height="14" style="" stroke-width="2"></rect><path d="M8.5 1L8.5 15.5M11.5 15.5L11.5 20.5L2.5 20.5M11.5 20.5L21.5 20.5"></path></svg>`}function Br(e=24,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="${c}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(60 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(120 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(180 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(240 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(300 12 12)"></path>
</svg>`}function Rr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M5 12l6 6" />
  <path d="M5 12l6 -6" />
</svg>`}function Ar(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M13 18l6 -6" />
  <path d="M13 6l6 6" />
</svg>`}function Nr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M12 5l0 14" />
  <path d="M18 11l-6 -6" />
  <path d="M6 11l6 -6" />
</svg>`}function Pr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M3.5 5.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 11.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 17.5l1.5 1.5l2.5 -2.5" />
  <path d="M11.5 6.5l9.5 0" />
  <path d="M11.5 12.5l9.5 0" />
  <path d="M11.5 18.5l9.5 0" />
</svg>`}function Hr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.653 -.629 1.413 -.815 2.13 -.559" />
  <path d="M19 16v6" />
  <path d="M22 19l-3 3l-3 -3" />
</svg>`}function Or(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.67 -.644 1.45 -.824 2.182 -.54" />
  <path d="M16 19h6" />
  <path d="M19 16v6" />
</svg>`}function Fr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e} " viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M19.933 13.041a8 8 0 1 1 -9.925 -8.788c3.899 -1 7.935 1.007 9.425 4.747"></path>
   <path d="M20 4v5h-5"></path>
</svg>`}function Qs(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
</svg>`}function en(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 8h.01" />
  <path d="M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5" />
  <path d="M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3" />
</svg>`}function zr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M11 20h-4a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v4" />
  <path d="M4 15l4 -4c.928 -.893 2.072 -.893 3 0l3 3" />
  <path d="M14 14l1 -1c.31 -.298 .644 -.497 .987 -.596" />
  <path d="M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z" />
</svg>`}function Wr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <rect x="1" y="3" width="4" height="4"/>
  <path d="M10 5h10" />
  <rect x="1" y="10" width="4" height="4"/>
  <path d="M10 12h10" />
  <rect x="1" y="17" width="4" height="4"/>
  <path d="M10 19h10" />
</svg>`}function $r(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M10 7l0 6" />
  <path d="M21 21l-6 -6" />
</svg>`}function Ur(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M21 21l-6 -6" />
</svg>`}function jr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5z" />
  <path d="M3.5 6.5v-3h3m14 3v-3h-3m3 6v3h-3m-11 0h-3v-3" />
</svg>`}function Vr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5zM6.5 4.5v7m11-7v7" />
  <circle cx="12" cy="5.5" r=".5" />
  <circle cx="12" cy="10.5" r=".5" />
</svg>`}function Kr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 1h8v8m0-8L1 23v-8m0 8h8" />
</svg>`}function qr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 7l16 0" />
  <path d="M10 11l0 6" />
  <path d="M14 11l0 6" />
  <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
  <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
</svg>`}function Xr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
</svg>`}function Gr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" />
  <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" />
  <path d="M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z" />
</svg>`}function Yr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M13 4v4c-6.575 1.028 -9.02 6.788 -10 12c-.037 .206 5.384 -5.962 10 -6v4l8 -7l-8 -7z" />
</svg>`}const Tt={};function Ne(e,c,v){typeof Tt[e]>"u"&&(Tt[e]=Object.create(null)),Tt[e][c]=v}function Te(e,c){if(!(typeof Tt[e]>"u"))for(let v in Tt[e])Tt[e][v](c)}function si(e,c){delete Tt[e][c]}const ae={backgroundImageChange:"background-image-change",backgroundImageStyleChange:"background-image-style-change",themeChange:"theme-change",blurChange:"blur-change",nightLightChange:"night-light-change",closePopup:"close-popup",showPopup:"show-popup",hidePopup:"hide-popup",createWindow:"create-window",startProcess:"start-process",viewWindow:"view-window",restoreView:"restore-view",showDesktopHover:"show-desktop-hover",showDesktopOut:"show-desktop-out",showDesktop:"show-desktop",blurAllWindow:"blur-all-window",brightnessChange:"brightness-change",transparentChange:"transparency-change",customThemeChange:"custom-theme-change"};function Fe(e,c){Te(ae.createWindow,{appName:e,args:c})}function ni(e){Te(ae.startProcess,e)}let Ve,ei;function Zr(){return Ve}function Jr(e,c){if(Ve instanceof HTMLDivElement){Ve.innerHTML="",n();return}function v(){return e.map(l=>{const m=parseInt(l.element.style.width),a=parseInt(l.element.style.height),h=Array.from(l.element.getElementsByTagName("video")),u=l.element.cloneNode(!0),d=Array.from(u.getElementsByTagName("video")),f=Array.from(u.getElementsByTagName("audio"));for(let i=0;i<d.length;i++){const s=d[i];s.muted=!0,s.pause(),s.controls=!1,s.currentTime=h[i].currentTime}for(let i of f)i.muted=!0,i.pause(),i.controls=!1;u.style.pointerEvents="none",u.classList.add("taskbar-app-thumbnail-content");let t=120/a;return t*m>200&&(t=200/m),u.className.indexOf("fluid")===-1&&(u.style.height=a-Mt+"px"),u.style.transform=`scale(${t})`,{container:w("div",{title:l.getTitle(),className:"taskbar-app-thumbnail"+(l.isFocused()?" active":""),onmouseover:b.bind(null,l.id),onmouseout:y.bind(null,l.id)},[w("div",{className:"taskbar-app-thumbnail-inner relative w-full h-full fade-in",onclick:x.bind(null,l)},[w("div",{className:"taskbar-app-thumbnail-heading flex items-center"},[w("div",{className:"taskbar-app-thumbnail-icon image-cover flex-shrink-0",style:{backgroundImage:`url("${l.icon}")`}}),w("div",{className:"taskbar-app-thumbnail-title"},w("div",{className:"text-ellipsis"},l.getTitle())),w("div",{title:"Close",className:"taskbar-app-thumbnail-close-button flex content-center items-center flex-shrink-0",innerHTML:Gs,onclick:()=>{l.close(),bi(),E()}})]),w("div",{className:"taskbar-app-thumbnail-container"},u)])]),thumbnail:u}})}function b(l){Te(ae.viewWindow,{id:l}),Te(ae.hidePopup)}function y(l){E(l),Te(ae.showPopup)}function E(l){Te(ae.restoreView,{id:l})}function x(l){l.show(),l.focus(),bi(),E()}function r(l){if(Ve){const m=Ve.getBoundingClientRect(),a=Math.round(c.left+c.width/2-m.width/2);Ve.style.left=a+"px",Ve.style.height=l+62+"px"}}function n(){const l=v();Ve&&Dt(Ve,l.map(a=>a.container));let m=0;l.forEach(a=>{const h=a.thumbnail.getBoundingClientRect();a.container.style.width=h.width+"px",a.container.style.height=h.height+32+"px",h.height>m&&(m=h.height)}),r(m),setTimeout(()=>{ve(Ve,{visibility:"visible"})},50)}Ve=w("div",{className:"taskbar-app-thumbnails flex",style:{visibility:"hidden"},onmouseover:tn,onmouseleave:sn}),document.body.appendChild(Ve),n()}function tn(){ei&&clearTimeout(ei)}function sn(){ei&&clearTimeout(ei),ei=setTimeout(()=>{bi()},500)}function bi(){Ve==null||Ve.remove(),Ve=void 0}function nn(e,c){const v=Object.create(null);return v.className="taskbar-app-item-icon w-full h-full flex items-center content-center",c==="svg"?v.innerHTML=e:(v.className+=" image-icon",v.style||(v.style=Object.create(null)),v.style.backgroundImage=`url("${e}")`,v.style.pointerEvents="none"),v}function Qr(e,c,v){let b;const y=Object.create(null);y.title=e.productName,y.className="taskbar-item taskbar-app-item";const E=nn(e.icon,e.iconType);return y.onmousedown=x=>x.stopImmediatePropagation(),y.ontouchstart=x=>x.stopPropagation(),y.onclick=c==null?void 0:c.onclick,y.oncontextmenu=c==null?void 0:c.oncontextmenu,b=w("div",y,w("div",E)),G(v)&&b.style.setProperty("--window-icon-color",v),{element:b}}function vt(e,c){let v;const b=[],y=Object.create(null);y.className="taskbar-item taskbar-app-item";const E=nn(e.icon,e.iconType);let x;y.onmousedown=o=>{at(),o.stopPropagation(),Te(ae.closePopup),x&&clearTimeout(x)},y.ontouchstart=o=>{at(),o.stopPropagation(),Te(ae.closePopup),x&&clearTimeout(x)},y.oncontextmenu=o=>{o.stopPropagation(),o.preventDefault(),at(),typeof c.oncontextmenu=="function"&&c.oncontextmenu(o)};function r(){const o=b.map(p=>p.app);Jr(o,v.getBoundingClientRect())}y.onmouseover=()=>{b.length&&(tn(),x&&clearTimeout(x),Zr()?r():x=setTimeout(()=>{r()},500))},y.onmouseleave=()=>{x&&clearTimeout(x),b.length&&sn()},y.onclick=n;function n(){if(b.length===0)Fe(e.name);else if(b.length===1){bi();const o=b[0];o.app.isVisible()?o.app.isFocused()?o.app.hide():o.app.focus():(o.app.show(),o.app.focus())}else b.length>1&&r()}let l;v=w("div",y,[w("div",E),l=w("div",{className:"taskbar-app-item-status"})]),v.addEventListener("customdragover",m,!1),v.addEventListener("customdrop",a,!1);function m(o){}function a(o){}function h(){b.length?l.classList.add("active"):l.classList.remove("active")}function u(o,p){b.push({name:o,active:!0,app:p}),h()}function d(o){const p=b.findIndex(g=>g.name===o);p>-1&&(b.splice(p,1),b.length===0&&c!=null&&c.onRemove&&c.onRemove()),h()}function f(o){setTimeout(()=>{v.classList.add("active")},10)}function t(o){setTimeout(()=>{v.classList.remove("active")},0)}function i(){return b}function s(){v.remove()}return{element:v,addInstance:u,removeInstance:d,getInstances:i,setActive:f,removeActive:t,remove:s}}function Bt(e,c,v){const b="popup"+Ii(32);let y="popup dropdown-box"+(e.noBorder?" no-border":""),E=!1,x={};e.className&&(y+=" "+e.className),G(e.top)&&(x.top=e.top+"px"),G(e.left)&&(x.left=e.left+"px"),G(e.width)&&(x.width=e.width+"px"),G(e.height)&&(x.height=e.height+"px");let r=w("div");function n(s){r=w("div",{tabIndex:-1,className:y,style:x},w("div",{className:"popup-inner relative w-full h-full"},s)),nt(document.body,r),Te(ae.blurAllWindow),r.focus(),document.addEventListener("mousedown",d,!1),window.addEventListener("touchstart",f,!1)}function l(s){ve(r,s)}function m(s){n(c),G(s)&&(G(s.top)&&(r.style.top=s.top+"px"),G(s.left)&&(r.style.left=s.left+"px"),G(s.width)&&(r.style.width=s.width+"px"),G(s.height)&&(r.style.height=s.height+"px")),E=!0,v&&v.onShow&&v.onShow()}function a(){r.remove(),document.removeEventListener("mousedown",d,!1),window.removeEventListener("touchstart",f,!1),E=!1,v&&v.onHide&&v.onHide()}function h(s){E?a():m(s)}function u(s){r.contains(s)||a()}function d(s){u(s.target)}function f(s){u(s.target)}function t(){r&&r.classList.add("hidden")}function i(){r&&r.classList.remove("hidden")}return Ne(ae.closePopup,b,s=>{E&&b!==s&&a()}),Ne(ae.showPopup,b,()=>{i()}),Ne(ae.hidePopup,b,()=>{t()}),{element:r,id:b,show:m,close:a,visible:i,hide:t,toggleShow:h,setStyle:l}}let Zt=class{constructor({startDate:c=null,endDate:v=null,siblingMonths:b=!1,weekNumbers:y=!1,weekStart:E=0}={}){Nt(this,"startDate");Nt(this,"endDate");Nt(this,"siblingMonths");Nt(this,"weekNumbers");Nt(this,"weekStart");this.startDate=c,this.endDate=v,this.siblingMonths=b,this.weekNumbers=y,this.weekStart=E}getCalendar(c,v){const b=new Date(Date.UTC(c,v,1,0,0,0,0));c=b.getUTCFullYear(),v=b.getUTCMonth();const y=[],E=b.getUTCDay(),x=-((7-this.weekStart+E)%7),r=Zt.daysInMonth(c,v),n=(r-x)%7,l=Zt.daysInMonth(c,v-1);let m=x,a,h,u=!1,d=null,f,t;const i=r-m+(n!==0?7-n:0)+x;for(;m<i;)h=m+1,a=((m<1?7+m:m)+E)%7,h<1||h>r?this.siblingMonths?(h<1?(f=v-1,t=c,f<0&&(f=11,t--),h=l+h):h>r&&(f=v+1,t=c,f>11&&(f=0,t++),h=m-r+1),f!==void 0&&t!==void 0&&(u={day:h,weekDay:a,month:f,year:t,siblingMonth:!0})):u=!1:u={day:h,weekDay:a,month:v,year:c},u&&this.weekNumbers&&(d===null?d=Zt.calculateWeekNumber(u):a===1&&d===52?d=1:a===1&&d++,u.weekNumber=d),u&&this.startDate&&(u.selected=this.isDateSelected(u)),y.push(u),m++;return y}isDateSelected(c){return this.startDate?c.year===this.startDate.year&&c.month===this.startDate.month&&c.day===this.startDate.day?!0:!(!this.endDate||c.year===this.startDate.year&&c.month===this.startDate.month&&c.day<this.startDate.day||c.year===this.endDate.year&&c.month===this.endDate.month&&c.day>this.endDate.day||c.year===this.startDate.year&&c.month<this.startDate.month||c.year===this.endDate.year&&c.month>this.endDate.month||c.year<this.startDate.year||c.year>this.endDate.year):!1}setStartDate(c){this.startDate=c}setEndDate(c){this.endDate=c}setDate(c){return this.setStartDate(c)}static diff(c,v){const b=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),y=new Date(Date.UTC(v.year,v.month,v.day,0,0,0,0));return Math.ceil((b.getTime()-y.getTime())/864e5)}static interval(c,v){return Math.abs(Zt.diff(c,v))+1}static compare(c,v){if(typeof c!="object"||typeof v!="object"||c===null||v===null)throw new TypeError("dates must be objects");return c.year<v.year?-1:c.year>v.year?1:c.month<v.month?-1:c.month>v.month?1:c.day<v.day?-1:c.day>v.day?1:0}static daysInMonth(c,v){return new Date(c,v+1,0).getDate()}static isLeapYear(c){return c%4===0&&c%100!==0||c%400===0}static calculateWeekNumber(c){const v=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),b=new Date(v.valueOf()),y=(v.getUTCDay()+6)%7;b.setUTCDate(b.getUTCDate()-y+3);const E=b.valueOf();return b.setUTCMonth(0,1),b.getUTCDay()!==4&&b.setUTCMonth(0,1+(4-b.getUTCDay()+7)%7),1+Math.ceil((E-b.getTime())/6048e5)}};function eo(){let e,c,v=new Date().getDate(),b;const y=new Zt({siblingMonths:!0});function E(){c.innerHTML="";const l=new Date;e.innerHTML=Ui[l.getUTCMonth()];const m=Qi.map(a=>a.substring(0,2));for(let a=0;a<m.length;a++){const h=m[a];c.appendChild(w("div",{className:"calendar-day -weekday"},w("div",{className:"w-full h-full flex items-center content-center"},h)))}y.getCalendar(l.getUTCFullYear(),l.getUTCMonth()).forEach(a=>{const h=w("div",{className:"calendar-day"+(a&&a.siblingMonth?" -sibling-month":"")},w("div",{"data-date":a?a.day:"",className:"calendar-day-inner w-full h-full flex items-center content-center"+(a&&l.getDate()===a.day&&!a.siblingMonth?" active":"")},a?a.day.toString():""));c.appendChild(h)})}function x(){const l=new Date,m=l.getDate();if(v!==m){const a=c.querySelector(`[data-date="${v}"`);a instanceof HTMLDivElement&&a.classList.remove("active");const h=c.querySelector(`[data-date="${m}"`);h instanceof HTMLDivElement&&h.classList.add("active"),v=m,e.innerHTML=Ui[l.getUTCMonth()]}}function r(){E(),b=setInterval(()=>{x()},1e3)}function n(){clearInterval(b)}return Bt({className:"calendar-popup"},w("div",{className:"calendar-content"},[e=w("div",{className:"calendar-month"}),c=w("div",{className:"calendar-items"})]),{onShow:r,onHide:n})}const Ss=eo();function to(){function e(){at(),Te(ae.closePopup,Ss.id),Ss.toggleShow()}const c=w("div",{className:"taskbar-item taskbar-date-time taskbar-date h-full flex items-center flex-shrink-0",onclick:e,onmousedown:v=>v.stopPropagation(),ontouchstart(v){v.stopPropagation()}},ji(new Date));return setInterval(()=>{c.textContent=ji(new Date)},500),{element:c}}function io(){let e,c,v,b,y;function E(){const n=new Date,l=n.getSeconds(),m=l/60*360+90;e.style.transform=`rotate(${m}deg)`;const a=n.getMinutes(),h=a/60*360+l/60*6+90;c.style.transform=`rotate(${h}deg)`;const d=n.getHours()/12*360+a/60*30+90;v.style.transform=`rotate(${d}deg)`,b.textContent=It(n,!0)}function x(){E(),setInterval(E,500)}function r(){clearInterval(y)}return Bt({className:"clock-popup"},w("div",{className:"clock-container flex"},[w("div",{className:"clock-inner"},[w("div",{className:"clock"},[w("div",{className:"outer-clock-face"},[w("div",{className:"clock-marking clock-marking-one"}),w("div",{className:"clock-marking clock-marking-two"}),w("div",{className:"clock-marking clock-marking-three"}),w("div",{className:"clock-marking clock-marking-four"}),w("div",{className:"inner-clock-face"},[v=w("div",{className:"clock-hand clock-hour-hand"}),c=w("div",{className:"clock-hand clock-min-hand"}),e=w("div",{className:"clock-hand clock-second-hand"})])])]),b=w("div",{className:"clock-time"})]),w("div",{className:"clock-divider"}),w("div",{className:"alarm-container flex flex-col flex-1 w-full"},[w("div",{className:"alarm-heading"},"Alarms"),w("div",{className:"alarm-items flex items-center content-center flex-1"},"No alarms")])]),{onShow:x,onHide:r})}const xs=io();function so(){const e=w("div",{className:"taskbar-item taskbar-date-time taskbar-time h-full flex items-center",onclick:()=>{at(),Te(ae.closePopup,xs.id),xs.toggleShow({left:Math.round(e.getBoundingClientRect().left)})},style:{whiteSpace:"nowrap"},onmousedown:c=>c.stopPropagation(),ontouchstart(c){c.stopPropagation()}},It(new Date));return setInterval(()=>{e.textContent=It(new Date)},500),{element:e}}function no(){let e,c;function v(){c=setInterval(()=>{e.textContent=It(new Date)},500)}function b(){clearInterval(c)}function y(x,r){return w("div",{},[w("div",{},x),w("div",{style:{fontSize:"16px"}},r)])}return Bt({className:"weather-popup"},w("div",{className:"weather-container w-full h-full p-20"},[w("div",{className:"flex"},[e=w("div",{className:"weather-popup-time flex items-center"},It(new Date)),w("div",{className:"flex items-center",style:{fontWeight:"bold",marginLeft:"auto"}},[w("div",{style:{marginRight:"10px"}},"Somewhere"),w("div",{className:"flex items-center",innerHTML:es})])]),w("div",{className:"flex items-center",style:{paddingBlock:"20px"}},[w("div",{style:{width:"80px",height:"80px",backgroundImage:'url("imgs/icons/Weather/sunny snow.png")',backgroundRepeat:"no-repeat",backgroundSize:"contain"}}),w("div",{className:"weather-popup-temperature",style:{marginLeft:"20px",fontSize:"32px"}},"-37°C"),w("div",{style:{marginLeft:"20px"}},[w("div",{style:{fontWeight:"bold",fontSize:"14px"}},"Snow"),w("div",{className:"flex",style:{marginTop:"10px"}},[w("div",{},"Feel like"),w("div",{style:{marginLeft:"10px",fontWeight:"bold",fontSize:"14px"}},"-37°C")])])]),w("div",{className:"weather-popup-index"},[y("Air quality","60"),y("Winds","4 km/h"),y("Humidity","50 %"),y("Visibility","10 km"),y("Pressure","1021 mb"),y("Dew point","10°")])]),{onShow:v,onHide:b})}function ro(){const e=no(),c=w("div",{title:"Somewhere, -37°C, Snow",className:"taskbar-item taskbar-weather h-full flex items-center",onclick:()=>{at(),Te(ae.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:v=>v.stopPropagation(),ontouchstart(v){v.stopPropagation()}},[w("div",{style:{height:"20px"},innerHTML:Br(20,"var(--accent-color)")}),w("div",{style:{marginLeft:"5px"}},"-37°C")]);return{element:c}}const je=[];for(let e=0;e<6;e++){const c="IMG"+e+".jpg";je.push({name:c,path:"imgs/Wallpapers/"+c,thumbnailPath:"imgs/Wallpapers/Thumbnails/"+c})}const Ht={useTitleBarAccentColor:!1,useTaskbarAndStartMenuAccentColor:!1,useWindowBorderAccentColor:!1},oo={name:"Default Light",background:je[0],accentColor:{h:200,s:100,l:50},dark:!1,transparency:!0,backgroundImageStyle:"Fill",...Ht},ao={name:"Default Dark",background:je[1],backgroundImageStyle:"Fill",accentColor:{h:200,s:100,l:50},dark:!0,transparency:!0,...Ht},lo=[{name:"Spring",background:je[2],backgroundImageStyle:"Fill",accentColor:{h:120,s:100,l:40},dark:!1,transparency:!0,...Ht},{name:"Autumn",background:je[3],backgroundImageStyle:"Fill",accentColor:{h:48,s:100,l:49},dark:!1,transparency:!0,...Ht},{name:"Abstract",background:je[4],backgroundImageStyle:"Fill",accentColor:{h:356,s:98,l:69},dark:!1,transparency:!0,...Ht},{name:"Moody",background:je[5],backgroundImageStyle:"Fill",accentColor:{h:215,s:50,l:40},dark:!0,transparency:!1,...Ht}],co=[oo,ao].concat(lo),rn={scale:"0.5",showDesktopIcons:!0,volume:100,brightness:100,nightlight:!1,themes:co,themeIndex:0,recentImages:[je[0],je[2],je[3],je[4],je[5]],roundedCorner:!0,useBorder:!1},xe=is("preferences",rn);function is(e,c={}){let v={};try{const x=localStorage.getItem(e);x?v=_n(JSON.parse(x),c):v=c}catch{}function b(x){if(typeof x=="string")return{[x]:v[x]};if(x instanceof Array){const r={};for(let n=0;n<x.length;n++){const l=x[n];r[l]=v[l]}return r}return v}function y(x){v={...v,...x},localStorage.setItem(e,JSON.stringify(v))}function E(){v=rn,localStorage.setItem(e,JSON.stringify(v))}return{getState:b,setState:y,reset:E}}function ho(){let{nightlight:e}=xe.getState("nightlight"),c,v,b=w("div",{className:"screen"},[c=w("div",{className:"screen-bright-overlay w-full h-full"}),v=w("div",{className:"screen-nightlight w-full h-full"+(e?" active":"")})]);nt(document.body,b);function y(r){let n=Ft(.7-r/100*.7,2);c.style.opacity=n.toString(),Te(ae.brightnessChange,r)}function E(r,n=!0){e=r,v.classList[e?"add":"remove"]("active"),n&&xe.setState({nightlight:e}),Te(ae.nightLightChange,e)}function x(){E(!e)}return{setBrightness:y,setNightLight:E,toogleNightLight:x}}const ri=ho();function Cs(e){let c,v,b,y,E,x,r,n=e.min||0,l=e.max||100,m=!1,a={top:0,left:0,width:0,height:0};function h(){a=y.getBoundingClientRect()}function u(D,M){let S=D-a.left;S<0?S=0:S>a.width&&(S=a.width);let B=S/a.width*100;M(B)}function d(D){typeof D=="number"&&u(D,M=>{c=M,E.style.width=M+"%",x.style.width=M+"%";const S=M*(l-n)/100+n;v=S,pe(e.onChange)?e.onChange(M,B=>{e.showBagde&&(r.textContent=B.toString())}):e.showBagde&&(r.textContent=Math.round(M).toString()),pe(e.onValueChange)&&(e.showBagde&&(r.textContent=Ft(S,2).toString()),e.onValueChange(S))})}function f(D){m=!0,b.classList.add("hoding"),h(),d(D.x),pe(e.onHoding)&&e.onHoding(),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",o,!1)}function t(D){D.preventDefault(),m=!0,b.classList.add("hoding"),h(),d(D.touches[0].clientX),pe(e.onHoding)&&e.onHoding(),window.addEventListener("touchmove",s,!1),window.addEventListener("touchend",p,!1)}function i(D){m&&d(D.x)}function s(D){d(D.touches[0].clientX)}function o(){m=!1,b.classList.remove("hoding"),typeof e.onRelease=="function"&&e.onRelease(c,v),document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",o,!1)}function p(){m=!1,b.classList.remove("hoding"),typeof e.onRelease=="function"&&e.onRelease(c,v),window.removeEventListener("touchmove",s,!1),window.removeEventListener("touchend",p,!1)}function g(){h()}function C(D){m||u(D.x,M=>{M||(M=0),x.style.width=M+"%",typeof e.onHoverMove=="function"?e.onHoverMove(M,S=>{e.showBagde&&(r.textContent=S.toString())}):e.showBagde&&(r.textContent=Math.round(M).toString())})}function T(){x.style.width="0%"}b=w("div",{className:"slider",onmousedown:f,ontouchstart:t,onmouseover:g,onmousemove:C,onmouseleave:T},y=w("div",{className:"slider-inner"},[E=w("div",{className:"slider-thumb-primary"},w("div",{className:"slider-thumb-primary-inner"})),x=w("div",{className:"slider-thumb-secondary"},w("div",{className:"slider-thumb-secondary-inner"},e.showBagde?r=w("div",{className:"slider-thumb-secondary-text"}):null))]));function _(D){D>100&&(D=100),m||(E.style.width=D+"%")}function k(D){const M=(D-n)/(l-n)*100;_(M)}return{element:b,update:_,updateValue:k}}function ct(e){let c=e.active,v=w("div",{className:"action-center-button"+(c?" active":"")},[w("div",{className:"action-center-button-icon",innerHTML:e.icon,onclick:b}),w("div",{className:"action-center-button-text"},e.text)]);function b(){e.disableActiveOnClick||(c=!c,typeof e.onclick=="function"&&e.onclick(c))}function y(x){v.classList[x?"add":"remove"]("active")}function E(x){c=x,y(x)}return{element:v,setActive:E}}function uo(){const{themes:e,themeIndex:c,customTheme:v,nightlight:b,brightness:y,volume:E}=xe.getState(["themes","themeIndex","customTheme","nightlight","brightness","volume"]),x=c>-1?e[c]:v,r=x.dark,n=x.transparency,l=ct({icon:Ks,text:"Wifi"}),m=ct({icon:yr,text:"Bluetooth"}),a=ct({icon:Sr,text:"Airplan Mode"}),h=ct({active:r,icon:Er,text:"Dark Theme",onclick:g=>{ls(g)}}),u=ct({icon:xr,text:"Focus Assist"}),d=ct({icon:kr,text:"Location"}),f=ct({active:b,icon:Tr,text:"Night Light",onclick:()=>{ri.toogleNightLight()}}),t=ct({icon:Dr,text:"Connect"}),i=ct({active:n,icon:Mr,text:"Transparency",onclick:g=>{cs(g)}});Ne(ae.themeChange,"actionCenter",g=>{h.setActive(g)});let s=!1;const o=Cs({showBagde:!0,onHoding:()=>{s=!0},onChange:(g,C)=>{ri.setBrightness(g),C(Math.round(g))},onRelease:g=>{s=!1,xe.setState({brightness:Math.round(g)})}});o.update(y);const p=Cs({showBagde:!0,onRelease:g=>{xe.setState({volume:Math.round(g)})}});return p.update(E),Ne(ae.nightLightChange,"actionCenter",g=>{f.setActive(g)}),Ne(ae.brightnessChange,"actionCenter",g=>{s||o.update(g)}),Ne(ae.transparentChange,"actionCenter",g=>{i.setActive(g)}),Bt({className:"action-center"},[w("div",{className:"action-center-top"},[w("div",{className:"action-center-buttons"},[l.element,m.element,a.element,h.element,u.element,d.element,f.element,t.element,i.element]),w("div",{className:"action-center-sliders"},[w("div",{className:"action-center-slider w-full flex items-center"},[w("div",{className:"action-center-slider-icon",innerHTML:Lr}),o.element]),w("div",{className:"action-center-slider w-full flex items-center"},[w("div",{className:"action-center-slider-icon",innerHTML:qs}),p.element])])]),w("div",{className:"action-center-footer flex items-center"},[w("div",{className:"action-center-footer-item action-center-batery flex items-center"},[w("div",{className:"action-center-batery-icon flex items-center",innerHTML:Xs}),w("div",{className:"action-center-batery-text"},"100%")]),w("div",{title:"Open Settings",className:"action-center-footer-item action-center-config",innerHTML:es,onclick:()=>{Te(ae.closePopup),Fe("settings")}})])])}const ks=uo(),Be={Tab:"Tab",Enter:"Enter",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Escape:"Escape",Space:" ",BackSpace:"Backspace",Delete:"Delete",Home:"Home",End:"End",Insert:"Insert"};function on(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 15 12 9 18 15" />
</svg>`}function Li(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 9 12 15 18 9" />
</svg>`}function an(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>`}function ln(e,c,v){const b=typeof e.children<"u"&&e.children!==null&&e.children instanceof Array&&e.children.length>0;let y=w("div",{onBeforeRemove(){y=null}});y.className="menu-item",y.tabIndex=-1,e.disabled?y.classList.add("disabled"):(y.onclick=a,y.onkeydown=l),y.onfocus=m,y.onmouseenter=r;let E=document.createElement("div");E.className="menu-item-icon",e.checked?(y.classList.add("checked"),E.innerHTML=an()):e.icon&&(!e.iconType&&!(e.icon instanceof Node)||e.iconType==="svg"?E.innerHTML=e.icon:e.iconType==="image"?E.style.backgroundImage=`url("${e.icon}")`:(e.icon instanceof Node||e.iconType==="element")&&E.appendChild(e.icon)),e.emphasis&&y.classList.add("emphasis"),y.appendChild(E);let x=document.createElement("div");if(x.className="menu-item-text",x.textContent=e.text||"",y.appendChild(x),e.shortcut){let u=document.createElement("div");u.className="menu-item-shortcut",u.textContent=e.shortcut,y.appendChild(u)}if(b){let u=document.createElement("div");u.className="menu-item-arrow flex items-center",u.innerHTML=jt,y.appendChild(u)}function r(u){u.stopPropagation(),u.currentTarget.focus(),v.onHover(c)}function n(){b||v.onEnter(e),typeof e.onClick=="function"&&e.onClick()}function l(u){u.key===Be.Enter&&(u.stopPropagation(),n())}function m(u){u.stopPropagation(),v.onFocus(c)}function a(u){u.stopPropagation(),n()}function h(u){y.classList[u?"add":"remove"]("active")}return{element:y,setActive:h}}function yi(e,c){let v;e.addEventListener("mouseenter",b,!1);function b(){v=requestAnimationFrame(E),e.addEventListener("mouseleave",y,!1)}function y(){cancelAnimationFrame(v),setTimeout(()=>{cancelAnimationFrame(v)},50),e.removeEventListener("mouseleave",y,!1)}function E(){v=requestAnimationFrame(E),typeof c=="function"&&c()}}const Lt=6;function cn(e,c,v,b,y){const E=v.length;let x=0,r=[],n=-1,l,m={close:D},a=!1,h=document.createElement("div");h.className="sub-menu";let u=document.createElement("div");u.className="context-menu-scroll-button top",u.innerHTML=on(),h.appendChild(u);let d=document.createElement("div");d.className="context-menu-scroll-button bottom",d.innerHTML=Li(),h.appendChild(d);let f=document.createElement("div");f.tabIndex=-1,f.className="context-menu-inner",f.onkeydown=g,f.addEventListener("scroll",()=>{t()},!1);function t(){f.scrollTop<=10?u.classList.remove("show"):u.classList.add("show"),f.scrollTop+f.getBoundingClientRect().height>=f.scrollHeight-10?d.classList.remove("show"):d.classList.add("show")}function i(){f.scrollTop+=4}function s(){f.scrollTop-=4}yi(u,s),yi(d,i),h.appendChild(f),c.element.appendChild(h);for(let M=0;M<E;M++){const S=v[M];if(!a&&G(S.shortcut)&&(a=!0),S.divider){let B=document.createElement("div");B.className="menu-item-divider",f.appendChild(B)}else{let B=ln(S,x,{onEnter:b,onFocus:C,onHover:p});f.appendChild(B.element),typeof S.children<"u"&&S.children!==null&&S.children instanceof Array&&S.children.length>0&&!S.disabled&&cn(h,B,S.children,b,o),r.push(B),x+=1}}a&&h.classList.add("has-shortcut");function o(M){l=M}function p(){k()}c.element.addEventListener("keydown",M=>{(M.key===Be.ArrowRight||M.key===Be.Enter)&&(M.stopPropagation(),_(!0))},!1),c.element.addEventListener("mouseenter",M=>{M.stopPropagation(),_(!1)},!1);function g(M){if(M.key===Be.ArrowLeft&&(M.stopPropagation(),h.classList.remove("show"),c.setActive(!1),c.element.focus()),M.key===Be.ArrowRight)M.stopPropagation(),n===-1&&(n=0,r[n].element.focus());else if(M.key===Be.ArrowUp){if(M.stopPropagation(),M.preventDefault(),n===-1)n=r.length-1,r[n].element.focus();else{let S=r[n-1];S?S.element.focus():r[r.length-1].element.focus()}k()}else if(M.key===Be.ArrowDown){if(M.stopPropagation(),M.preventDefault(),n===-1)n=0,r[n].element.focus();else{let S=r[n+1];S?S.element.focus():r[0].element.focus()}k()}}function C(M){n=M}let T;function _(M){const S=window.innerWidth,B=window.innerHeight;c.setActive(!0),h.classList.add("show");const H=e.getBoundingClientRect(),F=c.element.getBoundingClientRect();let O=H.left+H.width-Lt,P=F.top+2,L=h.getBoundingClientRect();T||(T=L);let I=f.getBoundingClientRect();H.left+H.width+L.width>S&&(O=H.left-L.width+Lt),P+L.height>=B?P=B-L.height-Lt/2:P-=Lt,I.height>=B&&(P=Lt,h.style.height=B-20+"px"),I=f.getBoundingClientRect(),f.scrollHeight>I.height&&(h.style.width=T.width+"px",f.style.width=T.width+20+"px"),h.style.top=P+"px",h.style.left=O+"px",t(),M&&r[0].element.focus(),y(m)}function k(){l&&l.close()}function D(){c.setActive(!1),h.classList.remove("show"),k()}return m}function Vt(e,c,v=[],b=!1,y,E=!0,x){window.lastContextMenu&&window.lastContextMenu.close(),window.contextMenuDirectionLTR=!0;const r=window.innerWidth,n=window.innerHeight;let l=!1,m,a=[],h=-1,u,d=0;const f=v.length;function t(I){if(I.key===Be.ArrowRight)h===-1&&(h=0,a[h].element.focus());else if(I.key===Be.ArrowUp){if(I.preventDefault(),h===-1)h=a.length-1,a[h].element.focus();else{let A=a[h-1];A?A.element.focus():a[a.length-1].element.focus()}s()}else if(I.key===Be.ArrowDown){if(I.preventDefault(),h===-1)h=0,a[h].element.focus();else{let A=a[h+1];A?A.element.focus():a[0].element.focus()}s()}else I.key===Be.Escape&&P()}function i(I){h=I}function s(){u&&u.close()}function o(){s()}let p=w("div",{className:"context-menu-scroll-button top",innerHTML:on()}),g=w("div",{className:"context-menu-scroll-button bottom",innerHTML:Li()});m=w("div",{tabIndex:-1,className:"context-menu"+(G(x)?" "+x:"")},[p,g]);let C=w("div",{tabIndex:-1,className:"context-menu-inner",onkeydown:t,onscroll:()=>{T()}});function T(){C.scrollTop<=10?p.classList.remove("show"):p.classList.add("show");let I=C.getBoundingClientRect();C.scrollTop+I.height>=C.scrollHeight-10?g.classList.remove("show"):g.classList.add("show")}function _(){C.scrollTop+=4}function k(){C.scrollTop-=4}yi(p,k),yi(g,_),m.appendChild(C),document.body.appendChild(m),m.focus();for(let I=0;I<f;I++){const A=v[I];if(!l&&G(A.shortcut)&&(l=!0),A.divider){let N=w("div",{className:"menu-item-divider"});C.appendChild(N)}else{let N=ln(A,d,{onEnter:B,onFocus:i,onHover:o});C.appendChild(N.element),typeof A.children<"u"&&A.children!==null&&A.children instanceof Array&&A.children.length>0&&!A.disabled&&cn(m,N,A.children,B,L),a.push(N),d+=1}}l&&m.classList.add("has-shortcut"),setTimeout(()=>{b?a[0].element.focus():C.focus()},0);let D={top:e.top,left:e.left};const M=m.getBoundingClientRect();let S=C.getBoundingClientRect();D.left+M.width>r&&(D.left=D.left-M.width),D.top+M.height>n&&(D.top=n-M.height-Lt/2),S.height>n&&(D.top=Lt,m.style.height=n-20+"px"),S=C.getBoundingClientRect(),C.scrollHeight>S.height&&(m.style.width=M.width+"px",C.style.width=M.width+20+"px"),m.style.left=D.left+"px",m.style.top=D.top+"px",T();function B(){P()}function H(){P()}window.addEventListener("resize",H,!1),document.addEventListener("mousedown",F,!1),window.addEventListener("touchstart",O,!1);function F(I){m.contains(I.target)||P()}function O(I){m.contains(I.target)||P()}function P(){window.removeEventListener("scroll",H,!1),document.removeEventListener("mousedown",F,!1),window.removeEventListener("touchstart",O,!1),m.remove(),E&&c.focus(),window.lastContextMenu=null,y&&y()}function L(I){u=I}window.lastContextMenu={close:P}}const rt=is("env",{USER_NAME:"User 1",USER_HOME:"c:/Users/User 1",VERSION:"10.0.23711.1466"}),ht="imgs/icons/",Ae={thisPC:ht+"Computer.png",driverC:ht+"Drives/Hardrive%20Windows.png",user:ht+"User.png",desktop:ht+"Desktop.png",document:ht+"Folder%20Documents.png",download:ht+"Folder%20Downloads.png",pictures:ht+"Folder%20Pictures.png",music:ht+"Folder%20Music.png",videos:ht+"Folder%20Videos.png"},mt="imgs/icons/Folder.png",{USER_HOME:qt}=rt.getState("USER_HOME"),fo=[{text:"Documents",icon:"imgs/icons/Folder%20Documents.png",iconType:"image",onclick:()=>{Fe("explorer",`${qt}/Documents`)}},{text:"Downloads",icon:"imgs/icons/Folder%20Downloads.png",iconType:"image",onclick:()=>{Fe("explorer",`${qt}/Downloads`)}},{text:"Music",icon:"imgs/icons/Library%20Music.png",iconType:"image",onclick:()=>{Fe("explorer",`${qt}/Music`)}},{text:"Pictures",icon:"imgs/icons/Libray%20Pictures.png",iconType:"image",onclick:()=>{Fe("explorer",`${qt}/Pictures`)}},{text:"Videos",icon:"imgs/icons/Library%20Videos.png",iconType:"image",onclick:()=>{Fe("explorer",`${qt}/Videos`)}}],mo=[{text:"Accounts",icon:"imgs/user.gif",iconType:"image",onclick:()=>{ni({type:"app",...ie.settings,args:"accounts"})}},{text:"Settings",icon:es,onclick:()=>{Fe("settings")}},{text:"Power",icon:wr,preventClose:!0,onclick:e=>{Vt({top:e.y,left:e.x},e.currentTarget,[{text:"Sleep"},{text:"Restart"},{text:"Shutdown"}])}}];function po(e){return w("div",{className:"start-menu-column start-menu-actions h-full flex flex-col scrollable scroll-y"},[w("div",{className:"start-menu-action-list start-menu-actions-top"},fo.map(c=>{const v={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?v.style.backgroundImage=`url(${c.icon})`:v.innerHTML=c.icon,w("div",{className:"start-menu-action-item flex items-center",onclick:()=>{c.onclick(),G(e)&&e(c)}},[w("div",v),w("div",null,c.text)])})),w("div",{className:"start-menu-action-list start-menu-actions-bottom"},mo.map(c=>{const v={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?v.style.backgroundImage=`url(${c.icon})`:v.innerHTML=c.icon,w("div",{className:"start-menu-action-item flex items-center",onclick:b=>{c.onclick(b),G(e)&&e(c)}},[w("div",v),w("div",null,c.text)])}))])}function go(e){const c=rr();return w("div",{className:"start-menu-column  start-menu-apps-list-container w-full h-full flex flex-col flex-1"},[w("div",{className:"start-menu-apps-list w-full h-full scrollable scroll-y"},Object.keys(c).map((b,y)=>w("div",{key:"app-item"+y,className:"start-menu-apps-list-section"},[w("div",{className:"start-menu-apps-list-label flex items-center"},b),w("div",{className:"start-menu-apps-list-items"},c[b].map((E,x)=>w("div",{key:"app-item"+x,className:"start-menu-apps-list-item flex items-center",onclick:e.bind(null,E)},[w("div",{className:"start-menu-apps-list-item-icon flex-shrink-0",style:{backgroundImage:`url(${E.icon})`}}),w("div",{className:"start-menu-apps-list-item-name"},w("div",{className:"text-ellipsis"},E.productName))])))])))])}function vo(e){let c;function v(E){c.toggleShow(),Fe(E.name)}function b(){}function y(E){G(E)&&!E.preventClose&&c.toggleShow()}return c=Bt({noBorder:!0,width:524,height:(e==null?void 0:e.height)||540,className:"start-menu"},w("div",{className:"w-full h-full flex"},[po(y),go(v)]),{onHide:b}),c}const Es=vo();function _o(){let e=w("div",{className:"window-container",style:{position:"fixed",top:0,left:0}});document.body.appendChild(e);function c(E){e.appendChild(E)}function v(){e.style.display="none"}function b(){e.style.removeProperty("display")}function y(E){e.classList[E?"add":"remove"]("fullscreen")}return{addWindow:c,show:b,hide:v,toogleFullScreen:y}}const Si=_o();function wo(e){let c;function v(E){const x=E.target;c!=null&&c.contains(x)||(y(),e.onClose&&e.onClose())}function b(){Si.hide(),Ue.showDesktopIcons(!1);const E=To().toReversed();c=w("div",{className:"taskview flex flex-col",style:{transform:"scale(1.2)"},onclick(){y()}},[w("div",{className:"taskview-header flex-shrink-0 flex items-center",style:{paddingInline:"40px"}},[w("div",{className:"taskview-header-button flex items-center",onclick(x){x.stopPropagation()}},[w("div",{className:"taskview-header-button-icon flex items-center content-center",innerHTML:ts(),style:{width:"24px",height:"24px"}}),w("div",{className:"taskview-header-button-text",style:{marginLeft:"10px"}},"New windows group")])]),w("div",{className:"taskview-app-items flex-1"},E.map(x=>{const r=parseInt(x.element.style.width),n=parseInt(x.element.style.height),l=x.element.cloneNode(!0);l.classList.add("taskbar-app-item-window"),l.style.pointerEvents="none";const m=Array.from(x.element.getElementsByTagName("video")),a=Array.from(l.getElementsByTagName("video")),h=Array.from(l.getElementsByTagName("audio"));for(let i=0;i<a.length;i++){const s=a[i];s.muted=!0,s.pause(),s.controls=!1,s.currentTime=m[i].currentTime}for(let i of h)i.muted=!0,i.pause(),i.controls=!1;let u=160/n,d=!1;u*r>=400&&(d=!0,u=400/r);const f=Math.round(u*r);l.style.transform=`scale(${u})`;const t={width:f+"px"};return d&&(t.height=Math.round(u*n)+"px"),w("div",{className:"taskview-app-item",onclick(i){i.stopPropagation(),x.show(),x.focus(),y()}},[w("div",{className:"taskview-app-item-header flex",style:{marginBottom:"5px",width:f+"px"}},[w("div",{className:"taskview-app-item-icon flex-shrink-0",style:{width:"32px",height:"32px",backgroundImage:`url(${x.icon})`,backgroundRepeat:"no-repeat",backgroundSize:"24px",backgroundPosition:"center"}}),w("div",{className:"taskview-app-item-text flex items-center"},w("div",{title:x.title,className:"text-ellipsis line-clamp-1"},x.title)),w("div",{title:"Close",className:"taskview-app-item-close flex items-center content-center flex-shrink-0",style:{width:"32px",height:"32px",marginLeft:"auto"},innerHTML:Ys,onclick(i){i.stopPropagation(),x.close(),y()}})]),w("div",{className:"taskview-app-thumbnail",style:t},l)])}))]),document.body.appendChild(c),document.addEventListener("click",v,!1),setTimeout(()=>{c.style.transform="scale(1)"},0),e.onShow&&e.onShow()}function y(){document.removeEventListener("click",v,!1),G(c)&&ve(c,{transform:"scale(1.5)",opacity:"0"}),Si.show(),xe.getState("showDesktopIcons").showDesktopIcons&&Ue.showDesktopIcons(!0),setTimeout(()=>{c==null||c.remove(),c=null,e.onClose&&e.onClose()},150)}return{element:c,show:b,close:y}}function bo(){let e=!1,c=wo({onClose:v});function v(){e=!1}return{element:w("div",{title:"Task View",className:"taskbar-item h-full flex-shrink-0",onclick:y=>{y.stopPropagation(),at(),Te(ae.closePopup),e?(e=!1,c.close()):(e=!0,c.show())},onmousedown:y=>y.stopPropagation(),ontouchstart(y){y.stopPropagation()}},w("div",{className:"taskbar-item-button flex items-center content-center h-full",style:{width:"40px"},innerHTML:Ir(20)}))}}function hn(e){let c=e.inputMode||"text",v,b;const y={};e.width&&(y.width=Vi(e.width)?e.width+"px":e.width.toString());function E(h){h.preventDefault(),b.classList.add("focus"),pe(e.onFocus)&&e.onFocus()}function x(){b.classList.remove("focus"),pe(e.onBlur)&&e.onBlur()}b=w("div",{className:"textbox flex items-center",style:y},[v=w("input",{name:"search-input",autocomplete:"off",autofill:"none",autofocus:e.autofocus,inputMode:c,type:e.type||"text",className:"textbox-input",placeholder:e.placeholder,oninput:r,onfocus:E,onblur:x,onkeydown(h){h.key==="Enter"&&(h.preventDefault(),pe(e.onEnter)&&e.onEnter(v.value))}}),typeof e.optional=="function"?e.optional(e):e.optional]);function r(h){h.preventDefault(),typeof e.onChange=="function"&&e.onChange(v.value)}function n(h){v.value=h}function l(h){v.placeholder=h}function m(){v.focus()}function a(){v.value=""}return{element:b,setValue:n,setPlaceHolder:l,focus:m,clear:a}}function Ti(e){const c=hn({placeholder:e.placeholder,inputMode:"text",value:e.value,onChange:e.onChange,optional:()=>w("div",{className:"search-box-icon flex items-center content-center",innerHTML:Js}),...e});return{element:c.element,setPlaceHolder:c.setPlaceHolder,focus:c.focus,clear:c.clear}}function yo(){let e=Ti({placeholder:"Type here to search"});const c=[ie.settings,ie.notepad,ie.explorer,ie.photos,ie.calculator];function v(){e.focus()}function b(){e.clear()}let y=Bt({className:"search-popup"},w("div",{className:"search-container flex flex-col p-20"},[w("div",{className:"search-popup-top flex-1"},[w("div",{style:{fontWeight:"bold"}},"Top Apps"),w("div",{className:"search-popup-apps"},[c.map(E=>w("div",{className:"search-popup-app-item",onclick(){y.close(),ni({...E,type:"app"})}},[w("div",{className:"search-popup-app-item-icon",style:{backgroundImage:`url(${E.icon})`}}),w("div",{className:"search-popup-app-item-text"},E.productName)]))])]),w("div",{className:"search-popup-bottom"},[w("div",{className:"search-popup-filter flex"},[w("div",{className:"search-popup-filter-item selected"},"All"),w("div",{className:"search-popup-filter-item"},"Apps"),w("div",{className:"search-popup-filter-item"},"Settings"),w("div",{className:"search-popup-filter-item"},"Folders"),w("div",{className:"search-popup-filter-item"},"Documents"),w("div",{className:"search-popup-filter-item"},"Web"),w("div",{className:"search-popup-filter-item"},"Photos"),w("div",{className:"search-popup-filter-item"},"Music"),w("div",{className:"search-popup-filter-item"},"Videos")]),w("div",{className:"search-popup-input"},e.element)])]),{onShow:v,onHide:b});return y}function So(){let e=yo();const c=w("div",{title:"Search",className:"taskbar-item h-full flex-shrink-0",onclick:()=>{at(),Te(ae.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:v=>v.stopPropagation(),ontouchstart(v){v.stopPropagation()}},w("div",{className:"taskbar-item-button taskbar-item-button-search flex items-center content-center h-full",style:{width:"40px"},innerHTML:Js}));return{element:c}}function xo(){Te(ae.showDesktopHover)}function Co(){Te(ae.showDesktopOut)}function dn(){Te(ae.showDesktop)}function ko(){function e(){at(),Te(ae.closePopup,Es.id),Es.toggleShow()}function c(y){y.stopPropagation(),y.preventDefault(),Vt({top:y.y,left:y.x},y.currentTarget,[{text:"Apps and Features",onClick:()=>{Fe(ie.settings.name,"apps")}},{text:"Mobility Center"},{text:"Power Options"},{text:"Event Viewer"},{text:"System"},{text:"Device Manager"},{text:"Network Connection"},{text:"Disk Management"},{text:"Computer Management"},{text:"Command Prompt(Admin)",onClick:()=>{Fe(ie.terminal.name)}},{divider:!0},{text:"Task Manager"},{text:"Settings",onClick:()=>{Fe(ie.settings.name)}},{text:"File Explorer",onClick:()=>{Fe(ie.explorer.name)}},{text:"Search"},{text:"Run"},{divider:!0},{text:"Shutdown or signout",children:[{text:"Sign out"},{text:"Sleep"},{text:"Shut down"},{text:"Restart"}]},{text:"Desktop",onClick:()=>{dn()}}])}const b=[{name:"startMenu",item:Qr({isSystemApp:!0,name:"start-menu",productName:"Start",icon:vr,iconType:"svg"},{onclick:e,oncontextmenu:c})}].map(y=>y.item.element);return w("div",{className:"taskbar-app-items h-full flex flex-shrink-0 items-center content-center"},b)}function Eo(){let e=[],c=localStorage.getItem("taskbarItems");if(typeof c>"u"||c===null)e=[{name:"explorer",item:vt(ie.explorer,{onRemove:y}),pinned:!0},{name:"settings",item:vt(ie.settings,{onRemove:y}),pinned:!0},{name:"notepad",item:vt(ie.notepad,{onRemove:y}),pinned:!0},{name:"calculator",item:vt(ie.calculator,{onRemove:y}),pinned:!0},{name:"photos",item:vt(ie.photos,{onRemove:y}),pinned:!0},{name:"cmd",item:vt(ie.cmd,{onRemove:y}),pinned:!0}];else try{c&&(c=JSON.parse(c),c instanceof Array&&(e=c.map(d=>({name:d,item:vt(ie[d],{onRemove:y}),pinned:!0}))))}catch{}let v;const b=w("div",{className:"w-full h-full flex content-center"},[v=w("div",{className:"taskbar-app-items h-full flex items-center content-center"},e.map(d=>d.item.element))]);function y(){}function E(d){return e.find(f=>f.name===d)}function x(d,f){const t={name:d,item:f};return e.push(t),v.appendChild(f.element),t}function r(d){e=e.filter(f=>f.name!==d)}function n(d,f,t){d.item.addInstance&&d.item.addInstance(f,t)}function l(d,f,t){const i=E(d);if(i)n(i,f,t);else{let s=vt({name:t.name,productName:t.productName,icon:t.icon});const o=x(d,s);n(o,f,t),e.push({name:d,item:s})}}function m(d,f){const t=E(d);t&&(t.item.removeInstance(f),t.item.getInstances().length||(t.pinned?t.item.removeActive(f):(t.item.remove(),r(d))))}function a(d,f){const t=E(d);t&&t.item.setActive(f)}function h(d,f){const t=E(d);t&&t.item.removeActive(f)}function u(d){return E(d).item.element.getBoundingClientRect()}return{element:b,addInstance:l,removeAppItem:r,removeInstance:m,setActiveWindow:a,removeActiveWindow:h,getAppItemBounds:u}}function Lo(){const e=Eo(),c=w("div",{className:"taskbar fixed bottom w-full",style:{height:We+"px"}},w("div",{className:"taskbar-inner flex h-full",oncontextmenu:v},[w("div",{className:"taskbar-left h-full flex-1 flex-shrink-0 flex items-center"},[ko(),so().element,ro().element,bo().element,So().element]),w("div",{className:"taskbar-center flex-2 h-full"},e.element),w("div",{className:"taskbar-right h-full flex-1 flex-shrink-0 relative flex items-center content-end",style:{paddingRight:"6px"}},[w("div",{title:"Show hidden icons",className:"taskbar-item flex items-center content-center flex-shrink-0 taskbar-item-more",innerHTML:Zs}),w("div",{className:"taskbar-item flex items-center content-center flex-shrink-0",onmousedown:b=>b.stopPropagation(),ontouchstart(b){b.stopPropagation()},onclick:()=>{at(),Te(ae.closePopup,ks.id),ks.toggleShow()}},[w("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:qs}),w("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:Ks}),w("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:Xs})]),to().element,w("div",{className:"show-desktop flex-shrink-0",onmouseover:xo,onmouseout:Co,onclick:dn})])]));function v(b){Vt({top:b.y,left:b.x},b.currentTarget,[{text:"Taskbar Settings",onClick:()=>{Fe("settings","personalization/taskbar")}},{text:"Lock the taskbar",checked:!0,onClick:()=>{console.log("Lock taskbar")}}])}return nt(document.body,c),e}const Ot=Lo(),ze=[],st=[];let ti=[],gi=!1;function To(){return st}function Do(e){const c=ti.findIndex(v=>v.window.id===e);c>-1&&ti.splice(c,1)}function Mo(e){const c=st.findIndex(v=>v.id===e.id);c>-1&&st.splice(c,1),st.push(e)}function Io(e){const c=st.findIndex(v=>v.id===e);if(c>-1&&(st.splice(c,1),st.length>0)){const v=st[st.length-1];v.isVisible()&&v.focus()}}function ss(e){const c=ze.length;for(let v=0;v<c;v++)e(ze[v])}function ns(e){return ze.find(c=>c.appName===e)}function Bo(e,c,v){gi=!1;const b=ze.length;for(let y=0;y<b;y++){const E=ze[y];E.window.decrementZIndex(),E.window.blur()}ze.push({appName:e,id:c,window:v}),Ot.addInstance(e,c,v)}function Ro(e,c){const v=ze.findIndex(b=>b.id===c);v>-1&&(ze.splice(v,1),Ot.removeInstance(e,c)),Io(c),Do(c)}function Ao(e,c,v){v.restoreZIndex(),Mo(v);const b=ze.length;for(let y=0;y<b;y++){const E=ze[y];E.id!==c&&(E.window.decrementZIndex(),E.window.blur())}}function No(e){const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.id!==e?b.window.isVisible()&&b.window.makeTransparent():b.window.element.classList.add("top-view")}}function Po(e){if(e){const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.id!==e?b.window.isVisible()&&b.window.removeTransparent():b.window.element.classList.remove("top-view")}}else{const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.window.isVisible()&&b.window.removeTransparent()}}}function Ho(){ss(e=>{e.window.blur()})}function Oo(){const e=ze.some(c=>c.window.isFullScreen);Si.toogleFullScreen(e)}window.addEventListener("resize",()=>{const e=ze.length;for(let c=0;c<e;c++){const v=ze[c];v.window.isMaximized()&&v.window.maximize()}},!1);function Fo(){if(!gi)ti=ze.filter(e=>e.window.isVisible()),ti.forEach(e=>{e.window.removeTransparent(),e.window.hide()});else{ti.forEach(c=>{c.window.removeTransparent(),c.window.show()});const e=st[st.length-1];e&&e.isVisible()&&e.focus()}gi=!gi}Ne(ae.viewWindow,"window-manager",e=>{No(e.id)});Ne(ae.restoreView,"window-manager",e=>{Po(e.id)});Ne(ae.showDesktopHover,"window-manager",()=>{ss(e=>{e.window.isVisible()&&e.window.makeTransparent()})});Ne(ae.showDesktopOut,"window-manager",()=>{ss(e=>{e.window.isVisible()&&e.window.removeTransparent()})});Ne(ae.showDesktop,"window-manager",()=>{Fo()});Ne(ae.blurAllWindow,"window-manager",()=>{Ho()});function zo(){let e=0,c=0;function v(){e=window.innerWidth,c=window.innerHeight}return v(),window.addEventListener("resize",v,!1),{get width(){return e},get height(){return c}}}let ke=zo();const Ls=1e6,Ke=30;function lt(e){let c={...e};const v={};if(e.singleInstance){let K=ns(e.name);if(K)return K.window.executeListeners("secondInstance",e.args),K.window}let b,y=Ls;const E=Ii(32);let x,r=!1,n=!1,l=!1,m=!1,a=!1,h=!1,u="",d=!1,f=!1,t=!1,i,s=!1;function o(K,ce){v[K]||(v[K]=[]),v[K].push(ce)}function p(K,ce){const Ie=v[K];if(Ie)for(let Ze=0;Ze<Ie.length;Ze++)Ie[Ze](ce)}function g(K,ce){if(G(v[K])){const Ie=v[K].findIndex(Ze=>Ze.name===ce.name);Ie>-1&&v[K].splice(Ie,1)}}let C=e.title||"",T=mr({icon:e.icon,hideIcon:e.hideIcon,title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,maximized:e.maximized,autoHide:e.autoHideTitleBar,content:e.titlebarContent,stretchTitlebarContent:e.stretchTitlebarContent},{onMinimizeButtonClick:oe,onMaximizeButtonClick:hi,onCloseButtonClick:Vn,onVisible:()=>p("ontitlebarshow"),onHidden:()=>p("ontitlebarhide")}),_={top:0,left:0,width:0,height:0};const k={zIndex:y.toString()};let D=0,M=0,S=300,B=200,H=300,F=200,O=!1,P=0;e.keepAspectRatio&&(O=e.keepAspectRatio),e.minWidth&&(H=e.minWidth),e.minHeight&&(F=e.minHeight),e.top&&(D=Number(e.top)),e.left&&(M=Number(e.left)),e.width&&(S=Number(e.width),S<H&&(S=H)),e.height&&(B=Number(e.height),B<F&&(B=F)),e.center&&(D=Math.round((window.innerHeight-B-We)/2),M=Math.round((window.innerWidth-S)/2)),O&&(P=S/B),k.top=D+"px",k.left=M+"px",k.minWidth=H+"px",k.width=S+"px",k.height=B+"px",k.minHeight=F+"px",_={top:D,left:M,width:S,height:B};let L="";e.noBorder&&(L+=" no-border"),e.className&&(L+=" "+e.className);let I="window-content";e.fluidContent&&(I+=" fluid"),e.transprencyContent||(I+=" theme-background");let A,N,z,j,V,q,Z,R,$,X,U,Y,W,te={top:!1,left:!1,right:!1,topLeft:!1,topRight:!1,bottomLeft:!1,bottomRight:!1},_e=!0;const Q=()=>{let ce=[{text:"Restore",icon:w("i",{className:"window-titlebar-context-icon",innerHTML:Wi}),disabled:!n,onClick:()=>{At()},emphasis:n},{text:"Move",disabled:!0},{text:"Size",disabled:!0},{text:"Minimize",icon:w("i",{className:"window-titlebar-context-icon",innerHTML:Us}),onClick:()=>{di()}},{text:"Maximize",icon:w("i",{className:"window-titlebar-context-icon",innerHTML:$i}),onClick:()=>{At()},disabled:e.disableMaximize||n},{divider:!0},{text:"Close",icon:w("i",{className:"window-titlebar-context-icon",innerHTML:js}),onClick:()=>{Pi()},shortcut:"Alt+X"}];return G(e.extendContextMenu)&&(ce=ce.concat(e.extendContextMenu)),ce},re=e.disableResize?" disabled":"";W=w("div",{tabIndex:-1,className:"window"+L,style:k,id:E},[w("div",{className:"window-background absolute w-full h-full"}),w("div",{className:"window-inner relative w-full h-full"},[T.element,x=w("div",{className:I})]),A=w("div",{"data-resize":"t",className:"window-resize-handle window-resize-horizontal window-resize-top"+re}),z=w("div",{"data-resize":"b",className:"window-resize-handle window-resize-horizontal window-resize-bottom"+re}),N=w("div",{"data-resize":"l",className:"window-resize-handle window-resize-vertical window-resize-left"+re}),j=w("div",{"data-resize":"r",className:"window-resize-handle window-resize-vertical window-resize-right"+re}),V=w("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-v"+re}),q=w("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-h"+re}),$=w("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-v"+re}),X=w("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-h"+re}),Z=w("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-v"+re}),R=w("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-h"+re}),U=w("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-v"+re}),Y=w("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-h"+re})]),W.addEventListener("customdrop",K=>{p("customdrop",K.detail)},!1),typeof e.titlebarHeight=="number"&&e.titlebarHeight>0&&ee(e.titlebarHeight);function ee(K){W.style.setProperty("--titlebar-height",K+"px")}Si.addWindow(W);let he=!1;W.addEventListener("animationend",()=>{he||(p("ready"),he=!0),p("animationend")});let we=new ResizeObserver(K=>{if(!s&&!f){if(n||h){const ce=K[0].contentRect;D=ce.top,M=ce.left,S=ce.width,B=ce.height}l||p("passiveResize")}});we.observe(W);let ye;e.autoHideTitleBar&&(W.addEventListener("mouseover",J,!1),W.addEventListener("mouseout",se,!1),W.addEventListener("mousemove",le,!1)),W.addEventListener("mousedown",Le,!1),W.addEventListener("touchstart",Le,{passive:!1});function J(){ye&&clearTimeout(ye),T.setAutoHide(!1),t&&T.setAutoHide(!0)}function le(){ye&&clearTimeout(ye),T.setAutoHide(!1),ye=setTimeout(()=>{t&&T.setAutoHide(!0)},100)}function se(){ye&&clearTimeout(ye),t&&T.setAutoHide(!0)}function Ce(K){t=K,T.setAutoHide(K)}function de(K){ot(x),nt(x,K),Bi()}function Pe(K,ce){let Ie=[Je(K,A,O,P,ce),Je(K,z,O,P,ce),Je(K,N,O,P,ce),Je(K,j,O,P,ce),Je(K,V,O,P,ce),Je(K,q,O,P,ce),Je(K,Z,O,P,ce),Je(K,R,O,P,ce),Je(K,$,O,P,ce),Je(K,X,O,P,ce),Je(K,U,O,P,ce),Je(K,Y,O,P,ce)];function Ze(Oi){for(let kt=0;kt<Ie.length;kt++)Ie[kt].setAspectRatio(Oi)}function Hi(Oi){for(let kt=0;kt<Ie.length;kt++)Ie[kt].setKeepAspectRatio(Oi)}return{setAspectRatio:Ze,setKeepAspectRatio:Hi}}function be(){s=!1,_=Ct(),p("resizeend"),fs()}e.disableResize||(i=Pe(W,{onResizeStart:()=>p("resizestart"),onResize:K=>{s=!0,D=K.top,M=K.left,S=K.width,B=K.height,p("resize",{width:S,height:B})},onResizeEnd:be})),document.addEventListener("mousedown",ge,!1),window.addEventListener("touchstart",ue,!1);function ne(K){W.contains(K)||_s()}function ge(K){ne(K.target)}function ue(K){ne(K.target)}function Le(){Kt()}function oe(){di()}function fe(){p("minimize")}function Se(){p("maximize")}function St(){W.offsetWidth,n||W.classList.remove("window-maximized"),p("restore")}function hi(){At()}function Bi(){Array.from(W.querySelectorAll("[drag-region=drag]")).forEach(ce=>{ce.oncontextmenu=On,ce.ondblclick=ps,Vs(W,ce,{onDragStart:()=>p("dragstart"),onDrag:Rn,onDragEnd:fs,onTouch:Qo(ps)})})}Bi();function xt(K,ce){te[K]||(te[K]=!0,W.classList.add("max-z-index"),Object.keys(te).forEach(Ie=>{Ie!==K&&(te[Ie]=!1)}),_e=!1,ce())}function Bn(K){_e||(_e=!0,W.classList.remove("max-z-index"),Object.keys(te).forEach(ce=>{te[ce]=!1}),K())}function Rn(K,ce){D=ce.top,M=ce.left,us(K),p("drag",K)}function us(K){setTimeout(()=>{if(n||d){const ce=Ct(),Ie=Math.round((K.x-ce.left)/ce.width*_.width),Ze=K.x-Ie;let Hi=K.y-ce.top;tt({..._,top:n?0:K.y-Hi,left:Ze}),d&&(d=!1,Pn()),n&&(n=!1,T.setMaximize(n),W.classList.remove("window-maximized"),p("unmaximize"))}},0),e.disableResize||(K.y<=0&&K.x<=Ke||K.x<=0&&K.y<=Ke?xt(Ee.topLeft,()=>{u=Ee.topLeft,Ue.showShape(Ee.topLeft,_)}):K.y<=0&&K.x>=ke.width-Ke||K.x>=ke.width-1&&K.y<=Ke?xt(Ee.topRight,()=>{u=Ee.topRight,Ue.showShape(Ee.topRight,_)}):K.y>=ke.height-We&&K.x<=Ke||K.x<=0&&K.y>=ke.height-We-Ke?xt(Ee.bottomLeft,()=>{u=Ee.bottomLeft,Ue.showShape(Ee.bottomLeft,_)}):K.y>=ke.height-We&&K.x>=ke.width-Ke||K.x>=ke.width-1&&K.y>=ke.height-We-Ke?xt(Ee.bottomRight,()=>{u=Ee.bottomRight,Ue.showShape(Ee.bottomRight,_)}):K.y<=0&&K.x>Ke&&K.x<ke.width-Ke?xt(Ee.top,()=>{u=Ee.top,Ue.showShape(Ee.top,_)}):K.x<=0&&K.y>Ke&&K.y<ke.height-We-Ke?xt(Ee.left,()=>{u=Ee.left,Ue.showShape(Ee.left,_)}):K.x>=ke.width-1&&K.y>Ke&&K.y<ke.height-We-Ke?xt(Ee.right,()=>{u=Ee.right,Ue.showShape(Ee.right,_)}):Bn(()=>{u="",Ue.removeShape()}))}function An(){W.classList.add("window-restore-down"),setTimeout(()=>{W.classList.remove("window-restore-down")},100),p("unmaximize")}function Nn(){W.offsetTop<0&&(W.style.top=0+"px"),window.innerHeight-W.offsetTop<We+Mt&&(W.style.top=window.innerHeight-(We+Mt)+"px"),W.offsetLeft+W.offsetWidth<30&&(W.style.left=-100+"px"),window.innerWidth-W.offsetLeft<30&&(W.style.left=window.innerWidth-100+"px")}function Rt(){W.classList.add("win-snap")}function Pn(){W.classList.remove("win-snap"),p("unSnap")}function fs(){ms(),p("dragend",_)}function ms(){if(!n&&!c.disableMaximize&&!c.disableResize){if(u!==""&&!e.disableMaximize){d=!0;let K=Math.floor(ke.width/2),ce=ke.height-We,Ie=Math.floor(ce/2),Ze=ce-Ie;K=Math.max(K,H),Ie=Math.max(Ie,F),u===Ee.top?At(!0):u===Ee.left?(tt({top:0,left:0,width:K,height:ce}),Rt()):u===Ee.right?(tt({top:0,left:ke.width-K,width:K,height:ce}),Rt()):u===Ee.topLeft?(tt({top:0,left:0,width:K,height:Ie}),Rt()):u===Ee.bottomLeft?(tt({top:Ie,left:0,width:K,height:Ze}),Rt()):u===Ee.bottomRight?(tt({top:Ie,left:ke.width-K,width:K,height:Ze}),Rt()):u===Ee.topRight&&(tt({top:0,left:ke.width-K,width:K,height:Ie}),Rt()),p("snap")}else _=Ct(),Nn();for(let K in te)if(te[K]){Ue.removeShape();break}}}function Ri(){u="",n=!0,e.disableMaximize||(tt({top:0,left:0,width:window.innerWidth,height:window.innerHeight-We}),W.classList.add("window-maximized"),Se())}function Hn(){n=!1,e.disableMaximize||(tt(_),W.classList.remove("window-maximized"),An())}function At(K){e.disableMaximize||(n=!n,n?(!K&&!d&&(_=Ct()),_.top<0&&(_.top=0),Ri()):Hn(),T.setMaximize(n),W.focus())}function ps(){At()}function On(K){K.preventDefault(),Kt(),Vt({top:K.y,left:K.x},K.currentTarget,Q(),!1,()=>{setTimeout(()=>{W&&!l&&Kt()},10)},!1)}function tt(K){G(K.top)&&(D=K.top,W.style.top=K.top+"px"),G(K.left)&&(M=K.left,W.style.left=K.left+"px"),G(K.width)&&(S=K.width,W.style.width=K.width+"px"),G(K.height)&&(B=K.height,W.style.height=K.height+"px"),e.disableResize||i.setAspectRatio(S/B)}function Ct(){const K=W.getBoundingClientRect();return{top:K.top,left:K.left,width:K.width,height:K.height}}function Fn(K){S=K.width,B=K.height,W.style.width=K.width+"px",W.style.height=K.height+"px",e.disableResize||i.setAspectRatio(S/B)}function gs(){W.style.zIndex=y.toString()}function zn(){y-=1,gs()}function vs(){y=Ls,gs()}function Ai(){W.classList.remove("top-view")}function Kt(){m||(W.focus(),W.classList.add("focus"),Ai(),Ao(b.name,E,b),Ot.setActiveWindow(b.name,E),m=!0),setTimeout(()=>{p("focus",m)},0)}function _s(){m=!1,W.classList.remove("focus"),Ot.removeActiveWindow(b.name,E),p("blur")}function ws(){W.classList.add("transparent"),r=!0}function bs(){W.classList.remove("transparent"),r=!1}function Wn(){r?bs():ws()}function $n(){h=!h,h?(!n&&!d&&(_=Ct()),W.classList.add("fullscreen"),T.setVisible(!1)):(n||tt(_),T.setVisible(!0),W.classList.remove("fullscreen")),Oo(),p("fullscreen",h)}function Un(){return n}function ys(){f=!1,W.classList.remove("show"),W.removeEventListener("animationend",ys,!1)}function Ni(){W.classList.remove("minimized"),Ai(),l?(W.classList.add("window-restored"),W.style.transform="translate3d(0px,0px,0px)",setTimeout(()=>{St(),W.classList.remove("window-restored"),W.style.removeProperty("transform")},300)):a||(f=!0,W.classList.add("show"),W.addEventListener("animationend",ys,!1)),a=!0,l=!1,vs(),n&&Ri()}function di(){Ai();const K=Ot.getAppItemBounds(e.name);W.classList.remove("window-restored"),W.classList.remove("show"),W.classList.remove("focus"),W.classList.add("minimized");const ce=Ct();setTimeout(()=>{W.style.transform=`translate3d(${K.left-ce.left}px, ${K.top}px, 0) scale(0.2)`},0),a=!1,m=!1,l=!0,e.name,Ot.removeActiveWindow(e.name,E),fe()}function jn(){a?di():Ni()}function Vn(){Pi()}function Pi(){we.disconnect(),document.removeEventListener("mousedown",ge,!1),window.removeEventListener("touchstart",ue,!1),G(W)&&(W.className="window closing",p("close"),f=!0,W.addEventListener("animationend",()=>{f=!1,T.element.remove(),W.remove(),W=void 0,Ro(e.name,E)}))}function Kn(){return a}function qn(){return m}function Xn(K){c.icon=K,T.setIcon(K)}function Gn(K){C=K,T.setTitle(K)}function Yn(){return C}function Zn(K){W.style.top=K.top+"px",W.style.left=K.left+"px"}function Jn(){let K=Math.round((window.innerHeight-B-We)/2),ce=Math.round((window.innerWidth-S)/2);Zn({top:K,left:ce})}function Qn(K){x.classList[K?"add":"remove"]("fluid")}return b={id:E,get icon(){return c.icon},get name(){return c.name},get productName(){return c.productName},get title(){return C},get isFullScreen(){return h},element:W,setContent:de,show:Ni,hide:di,titlebar:T,setAutoHideTitleBar:Ce,setIcon:Xn,setTitle:Gn,getTitle:Yn,setMaximize:T.setMaximize,toggleMaximize:At,maximize:Ri,decrementZIndex:zn,restoreZIndex:vs,focus:Kt,blur:_s,makeTransparent:ws,removeTransparent:bs,toggleTransprent:Wn,toggleFullscreen:$n,isMaximized:Un,close:Pi,toggleShow:jn,isVisible:Kn,isFocused:qn,getBounds:Ct,setBounds:tt,setSize:Fn,makeCenter:Jn,addEventListener:o,executeListeners:p,removeListeners:g,updateDragHandle:Bi,setTitlebarHeight:ee,checkWindowSnap:us,setWindowSnap:ms,setFluidContent:Qn},pe(e.content)&&de(e.content(b)),Bo(e.name,E,b),Ni(),setTimeout(()=>{Kt()},0),b}function rs(e){let c;const v=or({maxValue:e.maxValue,color:"#00b521"}),b=lt({name:"explorer-transfer",title:"Copying...",icon:ie.explorer.icon,width:500,height:120,minHeight:100,center:!0,disableMaximize:!0,disableResize:!0,content:()=>w("div",{className:"p-20 w-full h-full"},[c=w("div",{style:{marginBottom:"10px"},innerHTML:e.description}),w("div",{className:"w-full"},v.element)])});function y(n){v.setValue(n)}function E(n){b.setTitle(n)}function x(n){c.innerHTML=n}function r(){b.close()}return{setTitle:E,setDescription:x,setValue:y,close:r}}function os(e){let c,v,b,y,E,x=!0;function r(){const i={maxWidth:e.width+"px",maxHeight:e.height+"px",width:"100%",height:"100%"};if(G(e.parent)){const s=e.parent.getBoundingClientRect();i.top=Math.round((s.height-e.height)/2)+"px",i.left=Math.round((s.width-e.width)/2)+"px"}else i.top=Math.round((ke.height-Mt)/2-Math.round(e.height/2))+"px",i.left=ke.width/2-Math.round(e.width/2)+"px";c=w("div",{className:"dialog-content zoom-in focus relative flex flex-col",style:i},[w("div",{className:"dialog-titlebar flex"},[E=w("div",{className:"dialog-titlebar-text w-full flex items-center"},w("div",{className:"text-ellipsis line-clamp-1"},e.title)),w("div",{className:"dialog-titlebar-buttons flex-shrink-0 flex items-center",style:{marginLeft:"auto"}},[w("div",{title:"Close",className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:Gs,onclick:d})])]),w("div",{className:"w-full flex-1"},e.content),e.hideButtons?null:w("div",{className:"dialog-footer flex"},[v=w("button",{className:"dialog-footer-button button",onclick(){pe(e.onOK)&&e.onOK(),t()}},"OK"),b=w("button",{className:"dialog-footer-button button",onclick:()=>{t()}},"Cancel")])]),y={ok:v,cancel:b},nt(G(e.parent)?e.parent:document.body,c),Vs(c,E),document.addEventListener("mousedown",l,!1),window.addEventListener("touchstart",m,!1)}r();function n(i){c.contains(i)?x||(x=!0,a()):h()}function l(i){n(i.target)}function m(i){n(i.target)}function a(){c.classList.add("focus")}function h(){x=!1,c.classList.remove("focus")}function u(i){e.hideButtons||y[i].focus()}function d(){t()}function f(){c.remove()}function t(){c.classList.add("closing"),document.removeEventListener("mousedown",l,!1),x=!1,c.addEventListener("animationend",f,!1)}return{element:c,focusToButton:u,close:t}}function Wo(e){return os({title:e.title,width:e.width||300,height:e.height||160,content:e.content,onOK:e.onOK})}function ji(e){let c=e.getDate().toString();return e.getDate()<10&&(c="0"+c),`${Qi[e.getDay()]}, ${pr[e.getMonth()]} ${c}, ${e.getFullYear()}`}function It(e,c=!1){let v=e.getHours(),b=e.getMinutes(),y=e.getSeconds(),E=v>=12?"PM":"AM";return v=v%12,v=v||12,b=b<10?"0"+b:b,y=y<10?"0"+y:y,v+":"+b+(c?":"+y:"")+" "+E}function at(){window.lastContextMenu&&window.lastContextMenu.close()}function $o(e,c){const v=w("img");v.onload=()=>{const b=v.naturalWidth,y=v.naturalHeight,E=b/y;c({width:b,height:y,ratio:E})},v.onerror=()=>{c()},Xe(e)?v.mySrc=e:v.src=e}function Di(e){switch(e){case".jpg":case".png":case".webp":case".jfif":case".jpeg":return!0;default:return!1}}function Uo(e){switch(e){case".mp3":case".aac":case".m4a":case".ogg":case".flac":case".wav":case".opus":return!0;default:return!1}}function Mi(e){switch(e){case".mp4":case".mkv":case".webm":case".ogv":return!0;default:return!1}}function as(e,c,v=200){const b=document.createElement("canvas"),y=b.getContext("2d"),E=new Image,x=v;E.height=x,E.src=e,E.onload=()=>{const r=E.naturalWidth/E.naturalHeight,n=Math.round(x*r);b.width=n,b.height=x,y.drawImage(E,0,0,n,x);const l=b.toDataURL("image/png");fetch(l).then(m=>m.blob()).then(m=>{const a=URL.createObjectURL(m);c(a,m,l,r)})}}function jo(e,c,v=200){let b=w("video");b.onloadedmetadata=function(){b.currentTime=b.duration*.2},b.onseeked=()=>{const y=b.videoWidth,E=b.videoHeight,x=E>0&&y>0?y/E:16/9,r=Math.round(v*x),n=document.createElement("canvas");n.width=r,n.height=v,n.getContext("2d").drawImage(b,0,0,r,v);const m=n.toDataURL("image/jpeg");fetch(m).then(a=>a.blob()).then(a=>{const h=URL.createObjectURL(a);c(h,a,m,x)}),b=void 0},b.onerror=()=>{c(null,null,null,null),b=void 0},b.src=e}function ls(e,c=!0){document.documentElement.classList[e?"add":"remove"]("dark"),c&&pt({dark:e}),Te(ae.themeChange,e)}function cs(e,c=!0){document.documentElement.classList[e?"add":"remove"]("glass"),c&&pt({transparency:e}),Te(ae.transparentChange,e)}function G(e){return e!=null}function Vi(e){return typeof e=="number"}function pe(e){return typeof e=="function"}function Ki(e,c){switch(e.style.backgroundColor="var(--theme-background)",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center",c){case"fill":e.style.backgroundSize="cover";break;case"fit":e.style.backgroundSize="contain";break;case"stretch":e.style.backgroundSize="100% 100%";break;case"center":e.style.backgroundSize="cover";break;case"tile":e.style.backgroundSize="contain",e.style.backgroundRepeat="repeat";break;case"span":e.style.backgroundSize="cover",e.style.backgroundPosition="left top";break;default:e.style.backgroundSize="cover";break}}function un(e){const c=document.querySelector('meta[name="viewport"]');c==null||c.setAttribute("content",`width=device-width, initial-scale=${e}, user-scalable=no`)}function qi(e){document.documentElement.classList.toggle("no-border-radius",!e),document.documentElement.classList.toggle("rounded-corner",e)}function Wt(e,c){document.documentElement.classList.toggle(e,c)}function fn(e){document.documentElement.classList.toggle("use-border",e)}function vi(e,c){e.addEventListener("mousedown",n,!1);let v,b,y=0,E=0,x={x:0,y:0},r=!1;function n(a){a.button===0&&(document.addEventListener("mousemove",l,!1),document.addEventListener("mouseup",m,!1),x.x=a.x,x.y=a.y)}function l(a){if(document.documentElement.style.cursor=a.ctrlKey?"copy":"default",(Math.abs(a.x-x.x)>1||Math.abs(a.y-x.y)>1)&&!r){r=!0;const u=e.getBoundingClientRect();y=a.x-u.left,E=a.y-u.top,v=e.cloneNode(!0),v.classList.add("drag-item"),ve(v,{width:u.width+"px",height:u.height+"px"}),document.body.appendChild(v),e.dispatchEvent(new CustomEvent("customdragstart",{bubbles:!0,detail:c}))}G(v)&&ve(v,{top:a.y-E+"px",left:a.x-y+"px"});const h=document.elementFromPoint(a.x,a.y);h instanceof Element&&(b!==h?(b=h,b.dispatchEvent(new CustomEvent("customdragover",{bubbles:!0,detail:c}))):b.dispatchEvent(new CustomEvent("customdrag",{bubbles:!0,detail:c})))}function m(a){document.documentElement.style.cursor="default",r&&(b.dispatchEvent(new CustomEvent("customdrop",{bubbles:!0,detail:c})),document.body.removeChild(v),r=!1),document.removeEventListener("mousemove",l,!1),document.removeEventListener("mouseup",m,!1)}}function ui(e,c){c.parentNode.insertBefore(e,c.nextSibling)}function mn(e,c=!0){document.documentElement.style.setProperty("--accent-color",`hsl(${e.h}, ${e.s}%, ${e.l}%)`),document.documentElement.style.setProperty("--accent-color-value",e.h.toString()),c&&pt({accentColor:e})}function Xe(e){let v=/[a-z]:[\\/](?:[^\\/:*?"<>|\r\n]+[\\/])*[^\\/:*?"<>|\r\n]*/.exec(e);return G(v)&&v[0]===v.input}function bt(e){const v=/^[a-zA-Z]:[\\/]?/.exec(e);return G(v)&&v[0]===v.input}function Xt(e){const v=/(?:[\\/]?[^\\/:*?"<>|\r\n]+[\\/]?)*/.exec(e);return G(v)&&v[0]===v.input}function Ts(e,c){return e.reduce((v,b)=>((v[c(b)]=v[c(b)]||[]).push(b),v),{})}function Vo(e,c){var v=5,b={r:0,g:0,b:0},y=document.createElement("canvas"),E=y.getContext("2d"),x,r,n=-4,l,m={r:0,g:0,b:0},a=0;const h=new Image;h.height=200,h.src=e,h.onload=()=>{const u=h.naturalWidth/h.naturalHeight;r=Math.round(200*u),E.drawImage(h,0,0,r,200);try{x=E.getImageData(0,0,r,200)}catch{c(b)}for(l=x.data.length;(n+=v*4)<l;)++a,m.r+=x.data[n],m.g+=x.data[n+1],m.b+=x.data[n+2];m.r=Math.floor(m.r/a),m.g=Math.floor(m.g/a),m.b=Math.floor(m.b/a),E.clearRect(0,0,r,200),c(m)}}function Ko({r:e,g:c,b:v}){return e*.299+c*.587+v*.114>140?"#000":"#fff"}function Ds(e){Vo(e,c=>{const v=Ko(c);document.documentElement.style.setProperty("--contrast-text-color",v)})}function pn(e){Xe(e)?hs(e,(c,v)=>{if(!c)try{const b=URL.createObjectURL(v);Ds(b)}catch{}}):Ds(e)}function gn(e){Wt("use-titlebar-accent-color",e.useTitleBarAccentColor),Wt("use-startmenu-and-taskbar-accent-color",e.useTaskbarAndStartMenuAccentColor),Wt("use-window-border-accent-color",e.useWindowBorderAccentColor),mn(e.accentColor,!1),ls(e.dark,!1),cs(e.transparency,!1),Ue.setBackgroundImage(e.background,!1),Ue.setBackgroundStyle(e.backgroundImageStyle)}function pt(e){let{themes:c,themeIndex:v,customTheme:b}=xe.getState(["themes","themeIndex","customTheme"]);v>-1?b={...c[v],...e}:b={...b,...e},xe.setState({customTheme:b,themeIndex:-1}),Te(ae.customThemeChange)}function qo(e){const c=xe.getState("recentImages").recentImages;if(G(c)){const v=c.find(b=>b.path===e.path);v?(c.splice(c.indexOf(v),1),c.unshift(e),xe.setState({recentImages:c})):(c.pop(),c.unshift(e)),xe.setState({recentImages:c})}}function fi(){window.location.reload()}function Xo(){Wo({title:"Reset This PC",text:"Reset",content:w("div",{},[w("div",{style:{paddingInline:"10px",fontWeight:"bold"}},"Reseting will:"),w("ul",{},[w("li",null,"Change settings back to their defaults"),w("li",null,"Remove personal files")])]),onOK(){xe.reset();const e=indexedDB.deleteDatabase("Local Disk C");e.onsuccess=()=>{fi()},e.onerror=()=>{fi()},e.onblocked=()=>{fi()},e.onupgradeneeded=()=>{fi()}}}).focusToButton("cancel")}function Go(e){Fe("cmd",e)}function Jt(e,c=0,v,b,y=[],E){const x=e.length-1,r=e[c];if(E=E||"",c>x){b(y);return}if(r.isFile)r.file(n=>{y.push({type:"file",path:v+E+"/"+n.name,file:n}),Jt(e,c+1,v,b,y,E)});else if(r.isDirectory){let n=function(){m.readEntries(function(h){h.length>0?(a=a.concat(h),n()):a.length===0?Jt(e,c+1,v,b,y,E):Jt(a,0,v,u=>{const d=u.length;for(let f=0;f<d;f++)y.push(u[f]);Jt(e,c+1,v,b,y,E)},[],l)})},l=E;l+="/"+r.name,y.push({type:"dir",path:v+l});let m=r.createReader(),a=[];n()}}function _i(e,c){const v=Array.from(c).map(b=>b.webkitGetAsEntry());Jt(v,0,e,b=>{const y=b.length;let E=0;for(let l=0;l<y;l++)b[l].type==="file"&&(E+=b[l].file.size);let x=0;const r=rs({maxValue:E,title:"Copying...",description:`Copying ${v.length} items from <span style="color: var(--blue-color)">Local machine</span> to <span style="color: var(--blue-color)">${et(e)}</span>`});function n(l=0){if(l>=y){setTimeout(()=>{r.close()},1e3);return}const m=b[l];m.type==="file"?(x+=m.file.size,me.writeFile(m.path,m.file,a=>{a&&console.log(a),r.setValue(x),n(l+1)})):m.type==="dir"&&me.createFolder(m.path,a=>{n(l+1)})}n()})}function Yo(e,c){let v=0,b=0;const y=c.length;for(let r of c)v+=r.size;const E=rs({maxValue:v,title:"Copying...",description:`Copying ${y} items from <span style="color: var(--blue-color)">Local machine</span> to <span style="color: var(--blue-color)">${et(e)}</span>`});function x(r=0){if(r>=y){setTimeout(()=>{E.close()},1e3);return}const n=c[r];b+=n.size,me.writeFile(e+"/"+n.name,n,l=>{l&&console.log(l),E.setValue(b),x(r+1)})}x()}function Zo(e,c){v((b,y)=>{if(!b){let E=function(m=0){if(m>=x){setTimeout(()=>{l.close()},1e3);return}const a=y[m];me.unlink(a.location,h=>{h&&console.log(h),a.type==="file"&&(n+=a.size,l.setValue(n)),E(m+1)})};const x=y.length;let r=0;for(let m=0;m<x;m++)y[m].type==="file"&&(r+=y[m].size);if(r<10485760&&x<10){e.forEach(m=>{me.unlink(m.location,a=>{a&&console.log(a)})});return}let n=0;const l=rs({maxValue:r,title:"Removing...",description:`Removing ${x} items from <span style="color: var(--blue-color)">${et(c)}</span>`});E()}});function v(b){let y=0,E=[];x();function x(){if(y===e.length){const n=E.concat(e);b(null,n);return}const r=e[y];r.type==="folder"?me.readFolderRecursive(r.location,(n,l)=>{if(n){b(n);return}const m=l.map(a=>{const h={type:a.type,location:a.location};return a.type==="file"&&(h.size=a.size),h}).toReversed();E=E.concat(m),y++,x()}):(y++,x())}}}function Jo(e){Bt({width:300,height:400,className:"openWith-popup"},w("div",{className:"w-full h-full p-20"},"How do you want to open this file?")).show()}function Qo(e){let c;return function v(){let b=v;const y=arguments;G(c)?(Date.now()-c<650&&e.apply(b,y),c=void 0):(c=Date.now(),setTimeout(()=>{G(c)&&(c=void 0)},650))}}function Ms(e,c){return Math.floor(Math.random()*(c-e+1)+e)}function Ii(e=8){for(var c="",v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=0;b<e;b++)c+=v.charAt(Math.floor(Math.random()*v.length));return c}const ea=/webkit/.test(navigator.userAgent.toLowerCase()),vn=()=>[/Android/i,/webOS/i,/iPhone/i,/iPad/i].some(c=>navigator.userAgent.match(c));function ta(e){return e.lastIndexOf(".")>-1?e.substring(e.lastIndexOf("."),e.length):null}function Xi(e,c){Xe(e)?me.readFile(e,(v,b)=>{v?c(v):G(b)?b.text().then(y=>{c(null,y)}):c(new Error("File not exists"))}):fetch(e).then(v=>v.text()).then(v=>c(null,v)).catch(v=>c(v))}function et(e){return e.substring(e.lastIndexOf("/")+1,e.length)}function gt(e){const c=e.lastIndexOf(".");return c>-1?e.substring(c,e.length):""}function hs(e,c){const v=indexedDB.open("Local Disk C");v.onsuccess=()=>{const E=v.result.transaction("files","readwrite").objectStore("files").get(e);E.onsuccess=()=>{G(E.result)?c(null,E.result):c(new Error("Item has removed!"))},E.onerror=()=>{c(new Error("Invalid path"))}},v.onerror=()=>{c(new Error("Can not access"))}}function ia(e,c){let v;return function b(){const y=b,E=arguments;clearTimeout(v),v=setTimeout(()=>e.apply(y,E),c)}}function Ye(e,c=100){let v,b;return function y(){const E=y,x=arguments;b?(clearTimeout(v),v=setTimeout(function(){Date.now()-b>=c&&(e.apply(E,x),b=Date.now())},c-(Date.now()-b))):(e.apply(E,x),b=Date.now())}}function $t(e,c){let v,b,y,E,x=c.limit||100,r=c.debounceDelay||200;return function n(){const l=n,m=arguments;pe(c.onFrame)&&(cancelAnimationFrame(E),E=requestAnimationFrame(()=>{c.onFrame.apply(l,m)})),pe(c.onDebounce)&&(clearTimeout(y),y=setTimeout(()=>{c.onDebounce.apply(l,m)},r)),pe(c.onFunction)&&c.onFunction.apply(l,m),b?(clearTimeout(v),v=setTimeout(function(){Date.now()-b>=x&&(e.apply(l,m),b=Date.now())},x-(Date.now()-b))):(e.apply(l,m),b=Date.now())}}function Ft(e,c=0){return Number(Math.round(parseFloat(e+"e"+c))+"e-"+c)}function _n(e,c){if(typeof e=="object")for(let v in c)typeof e[v]!=typeof c[v]?e[v]=c[v]:typeof e[v]=="object"&&_n(e[v],c[v]);return e}function Qt(e){return e>=1099511627776?{value:Ft(e/1099511627776,1),unit:"TB"}:e>=1073741824?{value:Ft(e/1073741824,1),unit:"GB"}:e>=1048576?{value:Ft(e/1048576,1),unit:"MB"}:e>=1024?{value:Ft(e/1024),unit:"KB"}:e>0?{value:1,unit:"KB"}:{value:0,unit:"B"}}const Is=new Date(2023,0,1).getTime(),Pt={type:"mediumIcons",sortBy:"text",orderBy:"asc"};function Me(e){const c={...e,name:e.name,type:e.type||"folder",children:e.children||[],cdate:Is,mdate:Is};return G(e.text)&&(c.text=e.text),G(e.type)&&(e.type==="file"||e.type==="shortcut")&&(c.size=0),G(e.icon)&&(c.icon=e.icon),c}const{USER_NAME:sa,USER_HOME:Gt}=rt.getState(["USER_NAME","USER_HOME"]),wn=Me({name:"c:",text:"Local Disk C",icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[Me({name:"windows",children:[Me({name:"system32",children:[]}),Me({name:"Program Data",children:[Me({name:"Explorer",children:[]})]})]}),Me({name:"Code",children:[Me({name:"App1"}),Me({name:"App2"}),Me({name:"App3"}),Me({name:"App4"})],view:{type:"mediumIcons",sortBy:"text",orderBy:"asc"}}),Me({name:"Users",children:[Me({name:sa,icon:Ae.user,children:[Me({name:"Desktop",icon:Ae.desktop}),Me({name:"Documents",icon:Ae.document,children:[Me({name:"Google"}),Me({name:"Microsoft"})]}),Me({name:"Downloads",icon:Ae.download}),Me({name:"Pictures",icon:Ae.pictures,children:[Me({name:"Natures",view:Pt}),Me({name:"Screenshots",view:Pt}),Me({name:"Art",view:Pt}),Me({name:"Abstract",view:Pt}),Me({name:"Wallpapers",view:Pt})],view:Pt}),Me({name:"Music",icon:Ae.music}),Me({name:"Videos",icon:Ae.videos})]})]})]});function na(e){const c=e.transaction("tree","readwrite").objectStore("tree");let v=[];function b(y,E="",x=0){const r=y[x];let n=E===""?r.name:E+"/"+r.name;if(r.type==="folder"){const l={...r},m=r.children.map(a=>{const h={...a};return delete h.children,h});l.children=m,v.push({location:n,data:l})}r.children.length&&b(r.children,n),x<y.length-1&&b(y,E,x+1)}b([wn]);for(let y of v)c.put(y.data,y.location)}window.createDefaultFolderTree=na;function ra(){let e,c,v,b={};const y=indexedDB.open("Local Disk C");let E=wn,x,r,n=!1,l=!1,m=0,a=0;y.onupgradeneeded=function(){e=y.result,e.createObjectStore("tree").put(E,"c"),e.createObjectStore("files",{autoIncrement:!0});const M=indexedDB.open("Local Disk C");M.onsuccess=()=>{e=M.result;for(let S=1;S<=5;S++)fetch(`imgs/Pictures/IMG ${S}.jpg`).then(B=>B.blob()).then(B=>{s(`${Gt}/Pictures/Wallpapers/IMG ${S}.jpg`,B)});fetch("videos/VID 1.mp4").then(S=>S.blob()).then(S=>{s(`${Gt}/Videos/VID 1.mp4`,S),s(`${Gt}/Desktop/VID 1.mp4`,S)}),fetch("videos/VID 2.mp4").then(S=>S.blob()).then(S=>{s(`${Gt}/Videos/VID 2.mp4`,S),s(`${Gt}/Desktop/VID 2.mp4`,S)}),setTimeout(()=>{_("ready",e)},1e3)}},y.onsuccess=function(){e=y.result,window.db=e,h(),u();const M=c.get("c");M.onsuccess=function(){M.result&&(E=M.result)},_("ready",e)},y.onerror=function(M){_("error",M)};function h(){c=e.transaction("tree","readwrite").objectStore("tree")}function u(){v=e.transaction("files","readwrite").objectStore("files")}function d(M,S,B){const H=M.replace(/\\+/g,"/");h(),u();const F=H.split("/").filter(N=>N!=="");if(F.length===1){B(new Error("Invalid Path"));return}const O=Date.now(),P=F.length-1;let L=1,I=E;A();function A(){let N=I.children.findIndex(j=>j.name===F[L]),z;if(N===-1){const j=I.children.push({name:F[L],type:S.type,children:[],cdate:O,mdate:O})-1;if(z=I.children[j],L<P&&(z.type="folder"),L===P){c.put(E,"c"),S.type==="file"||S.type==="shortcut"?(z.type,S.type,delete z.children,v.put(null,H)):z.type,B(),_("added",H);return}else I=z,L+=1,A()}else if(z=I.children[N],L===P){B(new Error(S.type+" already exists"));return}else z.type==="folder"&&!G(z.children)&&(z.children=[]),I=z,L+=1,A()}}function f(M,S){d(M,{type:"folder"},S)}function t(M,S){const B=M.replace(/\\+/g,"/");h();const H=c.get("c");H.onsuccess=()=>{let F=H.result;const O=B.split("/").filter(P=>P!=="");if(O.length===0)S(new Error("Invalid path"));else if(O.length===1){if(bt(O[0])){const P=F.children.map(L=>(delete L.children,L));S(null,P);return}S(new Error("Invalid path"))}else{O.shift();let P;for(let I of O){const A=F.children.findIndex(N=>N.name===I);if(A>-1)F=F.children[A];else{P=new Error("Path is no longer exists");break}}if(F.type!=="folder"&&(P=new Error("Path is no longer exists")),P){S(P);return}const L=F.children.map(I=>(delete I.children,I));S(null,L)}}}function i(M,S){const B=M.replace(/\\+/g,"/").replace(/\/+/g,"/");u();const H=v.get(B);H.onsuccess=()=>{S(null,H.result)},H.onerror=()=>{S(H.error)}}function s(M,S,B){const H=M.replace(/\\+/g,"/"),F=H.split("/").filter(z=>z!=="");if(F.length===1){pe(B)&&B(new Error("Invalid Path"));return}const O=F.length-1;let P=1,L=E;const I=Date.now();A();function A(){let z=L.children.findIndex(V=>V.name===F[P]),j;if(z===-1){const V=L.children.push({name:F[P],type:"folder",children:[],cdate:I,mdate:I})-1;if(j=L.children[V],P===O){j.type="file",delete j.children,j.size=S.size,u();const q=new File([S],et(H)),Z=v.put(q,H);Z.onsuccess=()=>{pe(B)&&B(),N(),_("added",H)},Z.onerror=()=>{B(Z.error)};return}else L=j,P+=1,A()}else if(j=L.children[z],P===O){delete j.children,j.type="file",j.size=S.size,j.mdate=Date.now(),u();const V=v.put(S,H);V.onsuccess=()=>{pe(B)&&B(),N(),_("modified",H)},V.onerror=()=>{B(V.error)};return}else L=j,P+=1,A()}function N(){m+=1,n||(n=!0,h(),c.put(E,"c")),x&&clearTimeout(x),x=setTimeout(()=>{if(m>1){h();const z=c.put(E,"c");z.onerror=()=>{B(z.error)}}m=0,n=!1},200)}}function o(M,S){const B=M.replace(/\\+/g,"/");h();const H=c.get("c");H.onsuccess=()=>{let F=H.result,O;const P=B.split("/").filter(I=>I!=="");if(P.length===0){S(new Error("Invalid path",{cause:1}));return}if(P.length===1){const I=P[0],A=I.split(":")[0];bt(I)&&A==="c"?(delete F.children,S(null,F)):S(new Error("Invalid path",{cause:1}));return}P.shift();let L;for(let I of P){const A=F.children.findIndex(N=>N.name===I);if(A>-1)O=F.children[A],F=O;else{L=new Error("Path is no longer exists",{cause:2});break}}G(O)&&delete O.children,S(L,O)},H.onerror=()=>{S(new Error("Unknown error",{cause:0}))}}function p(M,S){const B=M.replace(/\\+/g,"/"),H=B.split("/").filter(I=>I!=="");if(H.length===1){S(new Error("Invalid Path"));return}const F=H.length-1;let O=1,P=E;L();function L(){const I=P.children.findIndex(N=>N.name===H[O]);if(I===-1){S(new Error("Item not exsist"));return}else if(O===F){const N=P.children[I];if(N.type==="file"||N.type==="shortcut"){P.children.splice(I,1),u();const z=v.delete(B);z.onsuccess=()=>{S(),A(),_("removed",B)},z.onerror=()=>S(z.error)}else N.type==="folder"?g(B,(z,j)=>{if(G(z))S(z);else{const V=j.filter(R=>R.type==="file"),q=V.length;u();for(let R=0;R<q;R++){const $=V[R];v.delete($.location),_("removed",$.location)}const Z=P.children.findIndex(R=>R.name===N.name);Z>-1?(P.children.splice(Z,1),A(),S(),_("removed",B)):S(new Error("Invalid Path"))}}):S(new Error("Unknown error"))}else P=P.children[I],O+=1,L();function A(){a+=1,l||(l=!0,h(),c.put(E,"c")),r&&clearTimeout(r),r=setTimeout(()=>{if(a>1){h();const N=c.put(E,"c");N.onerror=()=>{S(N.error)}}a=0,l=!1},200)}}}function g(M,S,B=[]){t(M,(H,F)=>{if(H)return S(H,B);let O=0;(function P(){var L=F[O++];if(!L)return S(null,B);let I=M+"/"+L.name;L.location=I,B.push(L),L.type==="folder"?g(I,(A,N)=>{if(H)return S(H,B);B=B.concat(N),P()}):P()})()})}function C(M,S,B){const H=M.replace(/\\+/g,"/");h();const F=H.split("/").filter(A=>A!=="");if(F.length===1){bt(F[0])?(E.view=S,c.put(E,"c"),pe(B)&&B()):pe(B)&&B(new Error("InValid Path"));return}const O=F.length-1;let P=1,L=E;I();function I(){let A=L.children.findIndex(z=>z.name===F[P]),N;if(A>-1)if(N=L.children[A],P===O){N.view=S,c.put(E,"c"),pe(B)&&B();return}else L=N,P+=1,I()}}function T(M,S,B){b[M]||(b[M]=Object.create(null)),b[M][S]=B}function _(M,S){if(!(typeof b[M]>"u"))for(let B in b[M])b[M][B](S)}function k(M,S){delete b[M][S]}function D(){return E}return{addEventListener:T,removeListeners:k,createItem:d,createFolder:f,readFolder:t,readFolderRecursive:g,readFile:i,writeFile:s,unlink:p,stats:o,check:D,setView:C}}const me=ra();function oa(){const c="c:/Program Data/Explorer/"+"thumbnails";let v=[],b=0;const y=[];me.addEventListener("ready","explorer-thumbnails",()=>{E()});function E(){Xi(c,(u,d)=>{if(u)r();else try{v=JSON.parse(d)}catch(f){console.error(f)}})}let x;function r(){x&&clearTimeout(x),x=setTimeout(()=>{me.writeFile(c,new Blob([JSON.stringify(v)],{type:"text/plain"}))},1e3)}function n(){const u=y.shift();G(u)&&l(u.location,u.fileExt,u.cb)}function l(u,d,f){b+=1,b<3&&n(),me.readFile(u,(t,i)=>{if(t||!G(i)){f("");return}const s=URL.createObjectURL(i);Di(d)&&as(s,(o,p,g,C)=>{f(o,C),v.push({location:u,data:g,ratio:C}),r(),b-=1,n()},160),Mi(d)&&jo(s,(o,p,g,C)=>{f(o,C),v.push({location:u,data:g,ratio:C}),r(),b-=1,n()},160)})}function m(u,d,f){const t=v.find(i=>i.location===u);if(G(t))fetch(t.data).then(i=>i.blob()).then(i=>{const s=URL.createObjectURL(i);f(s,t.ratio)});else{if(b>2){const i=y.findIndex(s=>s.location===u);if(i===-1)y.push({location:u,fileExt:d,cb:f});else{const s=y[i];s.cb=f}return}l(u,d,f)}}let a;function h(u){const d=v.findIndex(f=>f.location===u);d>-1&&(v.splice(d,1),a&&clearTimeout(a),a=setTimeout(()=>{r()},100))}return{getThumbnail:m,removeThumbnail:h}}const oi=oa();function it(e){return`imgs/icons/${encodeURIComponent(e)}`}const $e={blank:it("Blank.png"),image:it("Pictures file.png"),videos:it("Videos file.png"),audio:it("Audio file.png")},aa={"":{icon:$e.blank,appName:"",description:"File"},".jpg":{icon:$e.image,appName:"photoViewer",description:"Picture file"},".png":{icon:$e.image,appName:"photoViewer",description:"Picture file"},".jfif":{icon:$e.image,appName:"photoViewer",description:"Picture file"},".webp":{icon:$e.image,appName:"photoViewer",description:"Picture file"},".jpeg":{icon:$e.image,appName:"photoViewer",description:"Picture file"},".mp3":{icon:$e.audio,appName:"mediaPlayer",description:"Audio file"},".aac":{icon:$e.audio,appName:"mediaPlayer",description:"Audio file"},".ogg":{icon:$e.audio,appName:"mediaPlayer",description:"Audio file"},".m4a":{icon:$e.audio,appName:"mediaPlayer",description:"Audio file"},".flac":{icon:$e.audio,appName:"mediaPlayer",description:"Audio file"},".wav":{icon:$e.audio,appName:"mediaPlayer",description:"Audio file"},".opus":{icon:$e.audio,appName:"mediaPlayer",description:"Audio file"},".mp4":{icon:$e.videos,appName:"mediaPlayer",description:"Video file"},".mkv":{icon:$e.videos,appName:"mediaPlayer",description:"Video file"},".webm":{icon:$e.videos,appName:"mediaPlayer",description:"Video file"},".txt":{icon:it("Notes.png"),appName:"notepad",description:"Text Document File"},".exe":{icon:it("Notes.png"),appName:"",description:"Application"},".html":{icon:it("Notes.png"),appName:"notepad",description:"HTML Document"},".js":{icon:it("Notes.png"),appName:"notepad",description:"Javascript Source File"},".json":{icon:it("Notes.png"),appName:"notepad",description:"JSON File"},".css":{icon:it("Notes.png"),appName:"notepad",description:"CSS Source File"},".md":{icon:it("Notes.png"),appName:"notepad",description:"Markdown File"}},Ut=e=>{let c=aa[e];return G(c)||(c={appName:"",description:e.substring(1,e.length).toUpperCase()+" file",icon:$e.blank,iconType:"image"}),c};function la(e){const{showDesktopIcons:c}=xe.getState("showDesktopIcons");return[{text:"View",children:[{text:"Large Icons",value:"large-icons"},{text:"Medium Icons",value:"medium-icons",checked:!0},{text:"Small Icons",value:"small-icons"},{divider:!0},{text:"Auto arrange icons"},{text:"Align icons to grid",checked:!0},{divider:!0},{text:"Show desktop icons",checked:c,onClick:e.onShowDesktopIconsClick}]},{text:"Sort by",children:[{text:"Name"},{text:"Size"},{text:"Item type"},{text:"Date Modified"}]},{text:"Refresh"},{divider:!0},{text:"Paste",disabled:!0},{text:"Paste shortcut",disabled:!0},{text:"Open command window here",icon:"imgs/icons/Apps/terminal.png",iconType:"image",onClick(){Go(rt.getState("USER_HOME").USER_HOME+"/Desktop")}},{divider:!0},{text:"New",children:[{text:"Folder",icon:"imgs/icons/Folder.png",iconType:"image"},{text:"Shortcut",iconType:"image",icon:"imgs/icons/Emblems/1010.png"},{divider:!0},{text:"Bitmap Image"},{text:"Rich Text Document"},{text:"Text Document",icon:"imgs/icons/Notes.png",iconType:"image",onClick:()=>{Fe(ie.notepad.name)}}],emphasis:!0},{divider:!0},{icon:"imgs/icons/Desktop.png",iconType:"image",text:"Display settings",onClick:()=>{ni({...ie.settings,type:"app",args:"system/display"})}},{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalize",onClick:()=>{ni({...ie.settings,type:"app",args:"personalization"})}}]}const Et=rt.getState("USER_HOME").USER_HOME+"/Desktop";function ca(){let e=[],c=[],v=!1;const b=[{icon:"imgs/icons/Trash Empty.png",name:"explorer",productName:"Recycle Bin",args:"Recycle Bin",type:"app"},{...ie.settings,type:"app"},{...ie.notepad,type:"app"},{...ie.explorer,type:"app"},{...ie.photos,type:"app"},{...ie.github,type:"link",args:"https://github.com/chrishtu/windows11"}];function y(i){d(),ni(i)}const E=w("div",{className:"desktop-app-items absolute top flex flex-col flex-wrap"});x();function x(){for(let i of b)E.appendChild(a(i))}function r(){ot(E),x(),me.readFolder(Et,(i,s)=>{i||s.forEach(o=>{const p={type:o.type,args:Et+"/"+o.name,name:o.name,productName:o.name,icon:o.icon||(o.type==="folder"?mt:null),iconType:"image"},g=a(p);E.appendChild(g)})})}function n(i){return i.substring(Et.length+1,i.length).split("/")}me.addEventListener("ready","desktop",()=>{r()});function l(){v&&(r(),v=!1)}me.addEventListener("added","desktop",$t(()=>{l()},{limit:1e3,onFunction(i){i.includes(Et)&&n(i).length===1&&(v||(v=!0))}})),me.addEventListener("modified","desktop",$t(()=>{l()},{limit:1e3,onFunction(i){i.includes(Et)&&n(i).length===1&&(v||(v=!0))}})),me.addEventListener("removed","desktop",$t(()=>{l()},{limit:1e3,onFunction(i){i.includes(Et)&&n(i).length===1&&(v||(v=!0))}}));function m(i){let s=w("div",{className:"app-association"}),o=w("div",{className:"pannel-item-icon-bg"},s);const p=w("div",{className:"desktop-app-item-icon flex items-center content-center",style:{backgroundImage:`url(${i.icon})`}},o);function g(C,T){const _=T||1;p.style.backgroundImage="none",o.style.aspectRatio=_.toString(),_>=1?o.style.width="100%":o.style.height="100%",o.style.backgroundImage=`url(${C})`,s.style.backgroundImage=`url(${wt.mediaPlayer.icon})`}if(i.icon&&(i.iconType==="svg"?p.innerHTML=i.icon:p.style.backgroundImage=`url("${i.icon}")`),i.type==="file"){const C=gt(i.args),T=Ut(C);T.icon?T.iconType==="svg"?p.innerHTML=T.icon:p.style.backgroundImage=`url("${T.icon}")`:p.style.backgroundImage='url("imgs/icons/Blank.png")',Xe(i.args)&&(Di(C)||Mi(C))&&oi.getThumbnail(i.args,C,g)}return p}function a(i){let s=i.productName;i.type==="file"&&(s=et(i.args));const o=w("div",{className:"desktop-app-item",ondblclick:y.bind(null,i),onclick:p=>{const g=p.currentTarget;p.shiftKey||d(),g.classList.add("desktop-app-item-selected"),e.push(g)}},[w("div",{className:"flex items-center content-center",style:{padding:"3px 0"}},m(i)),w("div",{title:s,className:"desktop-app-item-label"},w("div",{className:"text-ellipsis line-clamp-2"},s))]);return vi(o,i),o}function h(i,s=!1){Array.from(E.children).forEach(p=>{const g=p.getBoundingClientRect();g.left+g.width<i.x1||g.left>i.x2||g.top+g.height<i.y1||g.top>i.y2?s||p.classList.remove("desktop-app-item-selected"):p.classList.add("desktop-app-item-selected")})}function u(){const i=Array.from(E.children);return e=i.filter(s=>s.classList.contains("desktop-app-item-selected")),c=i.filter(s=>!s.classList.contains("desktop-app-item-selected")),{items:i,selectedItems:e,notSelectedItems:c}}function d(){e.forEach(i=>{i.classList.remove("desktop-app-item-selected")}),e=[]}function f(i){E.classList.toggle("hidden",!i)}function t(){const{showDesktopIcons:i}=xe.getState("showDesktopIcons");f(!i),xe.setState({showDesktopIcons:!i})}return{element:E,selectItems:h,getItems:u,removeSelection:d,setShowDesktopIcons:f,toggleDesktopIcons:t}}function ha(){const{backgroundImageStyle:e,showDesktopIcons:c}=xe.getState(["backgroundImageStyle","showDesktopIcons"]),v=ca();function b(o){o.preventDefault(),Vt({top:o.y,left:o.x},o.currentTarget,la({onShowDesktopIconsClick:v.toggleDesktopIcons}),!1,null,!1,"desktop-context-menu")}function y(o){o.preventDefault(),_i(Et,o.dataTransfer.items)}let E=w("div",{className:"desktop-shape-presentation"}),x=w("div",{className:"desktop-selection-presentation"}),r=w("div",{className:"desktop fade-in",ondrop:y},[w("div",{className:"desktop-selection-handler",onmousedown:m,oncontextmenu:b}),x]),n=!1,l=null;function m(o){xe.getState("showDesktopIcons").showDesktopIcons&&(o.shiftKey||v.removeSelection(),o.button===0&&(n=!0,l={x:o.x,y:o.y},document.onmousemove=a,document.onmouseup=h))}function a(o){if(!n||Math.abs(o.x-l.x)<2&&Math.abs(o.y-l.y)<2)return;let p=0,g=0,C=0,T=0;o.x>l.x?(g=l.x,C=o.x-l.x):(g=o.x,C=l.x-o.x),o.y>l.y?(p=l.y,T=o.y-l.y):(p=o.y,T=l.y-o.y),ve(x,{visibility:"visible",top:p+"px",left:g+"px",width:C+"px",height:T+"px"}),v.selectItems({x1:g,x2:g+C,y1:p,y2:p+T},o.shiftKey)}function h(){n=!1,ve(x,{visibility:"hidden",width:"0px",height:"0px"}),v.getItems()}let u,d=!1;s(e),nt(document.body,r),nt(document.body,E),setTimeout(()=>{nt(r,v.element),v.setShowDesktopIcons(c)},500);function f(o,p=!0){r.style.myBackgroundImage=o.path,p&&(pt({background:o}),qo(o)),Te(ae.backgroundImageChange,o)}function t(o,p){u&&clearTimeout(u);const g=Math.floor(ke.width/2),C=ke.height-We,T=Math.floor(C/2);d||(o==="top"?ve(E,{top:"10px",left:g+"px"}):o==="left"?ve(E,{top:T+"px",left:"10px"}):o==="right"?ve(E,{top:T+"px",left:ke.width+"px"}):o==="topLeft"?ve(E,{top:"10px",left:"10px"}):o==="topRight"?ve(E,{top:"10px",left:ke.width+"px"}):o==="bottomLeft"?ve(E,{top:C+"px",left:"10px"}):o==="bottomRight"&&ve(E,{top:C+"px",left:ke.width+"px"}),d=!0),u=setTimeout(()=>{o==="top"?ve(E,{top:"10px",left:"10px",height:C-20+"px",width:ke.width-20+"px",transformOrigin:"top"}):o==="left"?ve(E,{top:"10px",left:"10px",height:C-20+"px",width:g-10+"px",transformOrigin:"left"}):o==="right"?ve(E,{top:"10px",left:g+"px",height:C-20+"px",width:g-10+"px",transformOrigin:"center right"}):o==="topLeft"?ve(E,{top:"10px",left:"10px",height:T-10+"px",width:g-10+"px",transformOrigin:"left top"}):o==="topRight"?ve(E,{top:"10px",left:g+"px",height:T-10+"px",width:g-10+"px",transformOrigin:"right top"}):o==="bottomLeft"?ve(E,{top:T+"px",left:"10px",height:T-10+"px",width:g-10+"px",transformOrigin:"left bottom"}):o==="bottomRight"&&ve(E,{top:T+"px",left:g+"px",height:T-10+"px",width:g-10+"px",transformOrigin:"right bottom"}),E.classList.add("show")},150)}function i(){d=!1,u&&clearTimeout(u),E.classList.remove("show"),E.style.top="0",E.style.left="0",E.style.width="0",E.style.height="0"}function s(o){Ki(r,o)}return{element:r,setBackgroundImage:f,setBackgroundStyle:s,showShape:t,removeShape:i,showDesktopIcons:v.setShowDesktopIcons}}const Ue=ha();function da(e,c,v){let b,y,E,x=Ii(32);const r={...e},n=20;G(r.id)?x=e.id:r.id=x;const l={};G(r.icon)&&(l.backgroundImage=`url(${r.icon})`);function m(){F(!0),c.onTabChange(r),c.onDragOver(r)}const a={};G(v)&&(a.position="absolute",a.left=v+"px"),b=w("div",{className:"tab",style:a},[w("div",{className:"tab-inner w-full h-full flex items-center",onmousedown:D,oncontextmenu:c.onContextMenu},[y=w("div",{className:"tab-icon h-full flex-shrink-0 background-icon",style:l}),w("div",{className:"tab-text h-full flex-1"},E=w("div",{className:"w-full h-full flex items-center"},r.text))]),w("div",{className:"tab-close-button h-full flex-shrink-0 flex items-center content center",innerHTML:Ys,onclick:()=>{L()}})]),b.addEventListener("customdragover",m,!1);let h,u,d,f=0,t=0,i=0,s=0,o=0,p=0,g=!1,C=!1,T=!1,_=0,k=!1;function D(I){I.button===0&&(pe(c.onTabChange)&&c.onTabChange(r),h=b.getBoundingClientRect(),d=b.parentElement.parentElement.getBoundingClientRect(),o=h.x,p=h.y,f=I.x-d.x,i=I.x,t=I.y-d.y,s=I.y,c.getTabCount()===1&&(k=!0),document.addEventListener("mousemove",M,!1),document.addEventListener("mouseup",S,!1))}function M(I){if(!g&&(Math.abs(I.x-i)>10||Math.abs(I.y-s)>10))k?(c.moveWindow({...r,element:b},{left:h.left,top:h.top,dl:I.x-h.left,width:h.width,height:h.height,deltaLeft:I.x-d.x,deltaTop:I.y-h.top+8}),S()):(g=!0,b.style.position="relative",b.style.removeProperty("left"),u=b.cloneNode(!0),u.classList.add("active"),u.classList.add("tab-clone"),ve(u,{position:"absolute",top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(u),b.style.visibility="hidden",pe(c.onDragStart)&&c.onDragStart());else if(!k){if(g){let A=T?I.x-_:I.x-d.left-f+o;if(A<d.left&&(A=d.left),A+h.width>d.left+d.width&&(A=d.left+d.width-h.width),u.style.left=A+"px",A>=0){let N=document.elementFromPoint(I.x,I.y);if(G(N)){let z=N.closest(".tab");G(z)&&(I.x-i>0?ui(b,z):I.x-i<0&&ui(z,b)),i=I.x}}}if(I.x<d.left-n||I.x>d.left+d.width+n||I.y<d.top-n||I.y>d.top+d.height+n){let A=I.y-d.top-t+p;if(u.style.top=A+"px",!C){C=!0;const N=u.getBoundingClientRect();c.onDragOut({...r,element:b},{left:N.left,top:N.top,dl:I.x-N.left,width:h.width,height:h.height,deltaLeft:I.x-d.x,deltaTop:I.y-N.top+8}),S(),L(C)}}}}function S(){G(u)&&u.remove(),b.style.removeProperty("visibility"),document.removeEventListener("mousemove",M,!1),document.removeEventListener("mouseup",S,!1),pe(c.onDragEnd)&&c.onDragEnd(r,T),k=!1,T=!1,g=!1}function B(I){r.text=I,E.innerText=I}function H(I){r.icon=I,y.style.backgroundImage=`url(${I})`}function F(I){var A;b.classList[I?"add":"remove"]("active"),(A=b.previousElementSibling)==null||A.classList[I?"add":"remove"]("no-divider")}function O(I){T=!0,h=b.getBoundingClientRect(),d=b.parentElement.parentElement.getBoundingClientRect(),o=h.x,p=h.y,f=I.detail.x-d.x,i=I.detail.x,t=I.detail.y-d.y,s=I.detail.y;let A=I.detail.x-I.detail.dx;if(_=I.detail.dx,g=!0,u=b.cloneNode(!0),u.classList.add("active"),u.classList.add("tab-clone"),ve(u,{position:"fixed",top:h.top+"px",left:A+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(u),b.style.visibility="hidden",pe(c.onDragStart)&&c.onDragStart(),A>=0){let N=document.elementFromPoint(I.detail.x,I.detail.y);if(G(N)){let z=N.closest(".tab");G(z)&&(I.detail.x-i>0?ui(b,z):I.detail.x-i<0&&ui(z,b)),i=I.detail.x}}document.addEventListener("mousemove",M,!1),document.addEventListener("mouseup",S,!1)}function P(I){r.content=I}function L(I){pe(c.onClose)&&c.onClose(r,I),b.remove()}return{id:r.id,element:b,setTitle:B,setIcon:H,setActive:F,triggerMouseMove:O,setContent:P,close:L}}function bn(e){let c,v;const b=[];function y(u){b.forEach(f=>f.setActive(!1));const d=b.find(f=>f.id===u);G(d)&&d.setActive(!0)}function E(u){return b.find(f=>f.id===u)}function x(u){return y(u.id),e.onTabChange(u),b.length}function r(u){const d=da(u,{onTabChange:x,onClose:e.onTabClose,onContextMenu:e.onContextMenu,updateDragHandle:e.updateDragHandle,onDrag:e.onDrag,onDragStart:e.onTabDragStart,onDragOver:e.onDragOver,onDragOut:e.onDragOut,onDragEnd:e.onDragEnd,getTabCount:e.getTabCount,moveWindow:e.moveWindow});return b.push(d),c.insertBefore(d.element,v),v.scrollIntoView(),y(d.id),d}function n(u){b.splice(b.findIndex(d=>d.id===u),1)}c=w("div",{className:"tabs w-full h-full flex"},[v=w("div",{className:"tabs-action-new flex items-center content-center"},w("div",{title:"New Tab",className:"tabs-action-new-button flex items-center content-center",onclick:e.onNewTabActionClick,innerHTML:ts(18,2)})),w("div",{["drag-region"]:"drag",className:"h-full flex-1"})]);function l(){v.style.visibility="hidden"}function m(){v.style.visibility="visible"}function a(){c.classList.remove("no-scrollbar")}function h(){c.classList.add("no-scrollbar")}return{element:c,add:r,remove:n,getTab:E,setActiveTab:y,showNewButton:m,hideNewButton:l,enabledScrollbar:a,disabledScrollbar:h}}function Bs(e,c){let v,b=[];v=w("div",{className:"tree-view"+(c.className?" "+c.className:"")});function E(n,l,m=0,a=0,h=""){const u=l[m];let d,f;function t(s,o,p){var g;(g=p.children)!=null&&g.length?s.isShow===!1&&(E(d,p.children,0,a+10,h+=p.text+"/"),s.isShow=!0):typeof c.requestChildren=="function"&&c.requestChildren(p.location,C=>{p.children=C,E(d,C,0,a+10,h+=p.text+"/"),s.isShow=!0}),s.classList.toggle("show"),o.classList.toggle("show")}function i(s){c==null||c.onChange(s)}if(G(u)){const s={backgroundImage:`url(${u.icon})`};d=w("div",{isShow:!1,className:"tree-node"},w("div",{className:"tree-node-inner",style:{paddingLeft:a+"px"}},[w("div",{className:"tree-display flex items-center",ondblclick:o=>{o.stopPropagation(),!u.noToggle&&G(u.children)&&u.children.length>0&&t(d,f,u)},onclick:i.bind(null,u)},[u.noToggle?w("div",{className:"tree-node-action flex-shrink-0 flex items-center"}):f=w("div",{className:"tree-node-action flex-shrink-0 flex items-center",innerHTML:jt,onclick:o=>{o.stopPropagation(),t(d,f,u)}}),w("div",{className:"tree-node-icon",style:s}),w("div",{className:"tree-node-text"},u.text)])])),n.appendChild(d),E(n,l,m+1,a,h),b.push({path:h+u.text,target:d,actionElement:f,currentData:u,toggleShow:t})}}E(v,[e]);function x(n){E(v,[n])}function r(n){return b.find(l=>l.path===n)}return{element:v,appendChild:x,getItem:r}}function ua(e){let c;const{USER_HOME:v}=rt.getState("USER_HOME");let b;function y(r){e==null||e.onChange({location:r.location,text:r.text,icon:r.icon,children:r.children,type:r.type})}function E(r,n){me.readFolder(r,(l,m)=>{const a=m.filter(h=>h.type==="folder").map(h=>({text:h.name,icon:h.icon||mt,location:r+"/"+h.name,properties:h,type:"folder"}));n(a)})}const x=Bs({text:"Favourites",icon:"imgs/icons/Quick%20Access.png",location:"",type:"root",children:[{icon:"imgs/icons/Folder%20Documents.png",text:"Documents",location:v+"/Documents",children:[],type:"folder",noToggle:!0},{icon:"imgs/icons/Folder%20Downloads.png",text:"Downloads",location:v+"/Downloads",children:[],type:"folder",noToggle:!0}]},{onChange:y,className:"explorer-sidebar-item",requestChildren:E});return c=w("div",{tabIndex:-1,className:"explorer-sidebar scrollable flex-shrink-0"},x.element),indexedDB.databases().then(r=>{b=Bs({text:"This PC",icon:"imgs/icons/Computer.png",location:"",type:"root",children:[{text:"Code",icon:mt,location:"c:/Code",children:[],type:"folder"},{text:"Desktop",icon:Ae.desktop,location:v+"/Desktop",children:[],type:"folder"},{icon:Ae.document,text:"Documents",location:v+"/Documents",children:[],type:"folder"},{icon:Ae.download,text:"Downloads",location:v+"/Downloads",children:[],type:"folder"},{icon:Ae.pictures,text:"Pictures",location:v+"/Pictures",children:[],type:"folder"},{icon:Ae.music,text:"Music",location:v+"/Music",children:[],type:"folder"},{icon:Ae.videos,text:"Videos",location:v+"/Videos",children:[],type:"folder"}].concat(r.map(l=>{const m=l.name.split(" ");let a=m[m.length-1].toLowerCase()+":";return{text:l.name,location:a,icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[],type:"driver"}}))},{className:"explorer-sidebar-item",onChange:y,requestChildren:E});const n=b.getItem("This PC");G(n)&&n.toggleShow(n.target,n.actionElement,n.currentData),c.appendChild(b.element),setTimeout(()=>{c.focus()},200)}),{element:c}}function fa(e){let c="",v=hn({placeholder:e.placholder,type:"text",value:e.text,onChange:y,onEnter:E}),b=os({title:e.title,width:e.width||300,height:e.height||160,parent:e.parent,content:w("div",{className:"text-dialog flex items-center content-center h-full"},v.element),onOK:E});v.focus();function y(x){c=x}function E(){pe(e.onSubmit)&&e.onSubmit(c),b.close()}return b}function ma(e){let c;const v=e.options.map(l=>{let m={style:{}};return G(l.icon)&&(l.iconType==="svg"?m.innerHTML=l.icon:m.style.backgroundImage=`url(${l.icon})`),w("div",{className:"dropdown-option"+(l.disabled?" disabled":""),onclick:l.disabled?null:l.onClick},[w("div",{className:"dropdown-option-icon image-icon",...m}),w("div",{className:"dropdown-option-label"},l.text)])}),{offsetLeft:b,offsetTop:y,offsetHeight:E}=e.triggerElement;c=w("div",{className:"dropdown",style:{top:y+E+"px",left:b+"px"},onclick:l=>l.stopPropagation()},v),e.triggerElement.appendChild(c);function x(l){const m=l.target;c.contains(m)||n()}function r(l){c.contains(l.target)||n()}setTimeout(()=>{document.onmousedown=x,window.ontouchstart=r,document.onkeydown=l=>{l.key===Be.Escape&&n()}},10);function n(){c.remove(),document.onmousedown=null,window.ontouchstart=null,G(e.triggerElement)&&e.triggerElement.focus()}return{element:c,close:n}}function pa(e){let c=w("div",{style:{width:"100%",height:"100%",backgroundImage:`url(${e.url})`,backgroundSize:e.imageSize||"100% 100%",backgroundPosition:"center center",backgroundRepeat:"no-repeat"}});function v(b){c.style.backgroundImage=`url(${b})`}return{element:c,setImage:v}}function Gi(){const{USER_HOME:e}=rt.getState("USER_HOME"),c=[{name:"Code",icon:mt,path:"This PC/Code",location:"c:/Code",type:"folder"},{name:"Desktop",icon:Ae.desktop,path:"Desktop",location:e+"/Desktop",type:"folder"},{name:"Documents",icon:Ae.document,path:"Documents",location:e+"/Documents",type:"folder"},{name:"Downloads",icon:Ae.download,path:"Downloads",location:e+"/Downloads",type:"folder"},{name:"Pictures",icon:Ae.pictures,path:"Pictures",location:e+"/Pictures",type:"folder"},{name:"Music",icon:Ae.music,path:"Music",location:e+"/Music",type:"folder"},{name:"Videos",icon:Ae.videos,path:"Videos",location:e+"/Videos",type:"folder"},{name:"Local Disk (C:)",icon:Ae.driverC,path:"c:/",location:"c:",type:"driver"}],{USER_NAME:v}=rt.getState("USER_HOME");return[...[{name:"Favourites",icon:"imgs/icons/Quick%20Access.png",path:"Favourites",location:"Favourites",type:"root",children:[c[2],c[3]],view:"mediumIcons",sortBy:"text",orderBy:"asc"},{name:"Recycle Bin",icon:"imgs/icons/Trash Empty.png",path:"Recycle Bin",location:"Recycle Bin",type:"root",children:[]},{name:"This PC",icon:Ae.thisPC,path:"This PC",location:"This PC",type:"root",children:c,group:{by:"type",orderBy:"desc"},view:"tiles",sortBy:"text",orderBy:"asc"},{name:v,icon:Ae.user,path:v,location:e,type:"folder"}],...c]}function zt(e){return e==="This PC"||e==="Favourites"||e==="Recycle Bin"}function ga(e){let c,v=a(e.actionEvents),b=n(e.history),y,E;c=w("div",{className:"explorer-toolbar flex-shrink-0"},[w("div",{className:"explorer-toolbar-drag w-full h-full",["drag-region"]:"drag"}),v.element,b.element]);let x=new ResizeObserver(()=>{b.toolbarPath.checkOverflow(),v.checkOverflow()});v.disableButtons(["undo","redo","paste"]),x.observe(c);function r(){let d,f,t,i,s,o=!1;function p(){o||(o=!0,d.value=i.path,d.select(),d.focus(),f.style.borderColor="var(--blue-color)",t.style.display="none")}function g(S=!1){o=!1,d.value="",f.style.borderColor="var(--border-color)",t.style.display="flex",S&&_.focus()}function C(S){if(S.key===Be.Enter){S.preventDefault();const B=T(d.value);e.onItemClick({text:B,location:B}),g(!0)}}function T(S){return S.charAt(S.length-1)==="/"?S.substring(0,S.length-1):S}s=pa({url:mt,imageSize:"18px 18px"});let _=w("div",{className:"explorer-toolbar-path w-full flex",style:{height:"28px"},tabIndex:-1},[f=w("div",{className:"explorer-toolbar-path-box w-full h-full flex",style:{border:"1px solid var(--border-color)"}},[w("div",{className:"explorer-toolbar-path-icon h-full",style:{width:"32px"}},s.element),w("div",{className:"relative w-full h-full"},[w("div",{className:"absolute w-full h-full flex"},[d=w("input",{name:"path-input",autocomplete:"off",inputMode:"text",className:"explorer-toolbar-path-input w-full h-full",style:{left:0,top:0,border:0,outline:0,background:"none",color:"var(--primary-text-color)",font:"inherit"},onblur:()=>{g()},onkeydown:C}),w("div",{className:"explorer-toolbar-path-history flex-shrink-0 h-full flex items-center content-center",style:{width:"28px"},innerHTML:Li()})]),t=w("div",{className:"explorer-toolbar-path-items w-full h-full absolute flex items-center",onclick:p,style:{left:0,top:0,zIndex:1,overflowX:"auto"}})])]),w("div",{className:"explorer-toolbar-path-refresh flex-shrink-0 flex items-center content-center",style:{width:"28px",border:"1px solid var(--border-color)",borderLeft:0},innerHTML:Fr(14,2)})]);function k(S){return w("div",{className:"explorer-toolbar-path-item flex h-full flex-shrink-0",onclick:H=>{H.stopPropagation()}},[w("div",{className:"explorer-toolbar-path-item-text flex items-center",onclick:()=>{const H=T(S.location);e.onItemClick({text:H,location:H})},title:S.text},w("div",{className:"text-ellipsis"},S.text)),w("div",{className:"explorer-toolbar-path-item-icon flex items-center content-center",innerHTML:jt})])}function D(S){if(i=S,G(S.icon)&&s.setImage(S.icon),Xe(S.path)||bt(S.path)){let B="";const H=Gi(),F=S.path.replace(/\\+/g,"/").split("/").filter(O=>O!=="").map((O,P)=>{B+=O+"/";let L=O;if(P===0){const I=H.findIndex(A=>A.path===B);I>-1&&(L=H[I].name)}return{text:L,location:B}}).map(O=>k(O));F.unshift(k({text:"This PC",location:"This PC"})),ot(t),Dt(t,F)}else{const B=Gi(),H=S.path.replace(/\\/,"/").split("/").filter(F=>F!=="").map((F,O)=>{let P=F,L=F;const I=B.findIndex(A=>A.path===(O===0?F+"/":F));return I>-1&&(P=B[I].name,L=B[I].location),{text:P,location:L}}).map(F=>k(F));ot(t),Dt(t,H)}M()}function M(){const S=t.offsetWidth;t.scrollWidth>S&&(t.scrollLeft=S+t.scrollWidth)}return{element:_,setPath:D,checkOverflow:M}}function n(d){let f,t,i,s,o=Ti({placeholder:"Search "}),p=r(),g="";f=w("div",{className:"explorer-toolbar-top flex items-center"},[w("div",{className:"explorer-toolbar-top-col explorer-toolbar-actions flex items-center"},[t=w("div",{className:"explorer-toolbar-actions-button",innerHTML:Rr(),onclick:d.onBackward}),i=w("div",{className:"explorer-toolbar-actions-button",innerHTML:Ar(),onclick:d.onForward}),s=w("div",{className:"explorer-toolbar-actions-button",innerHTML:Nr(),onclick:()=>{d.onGoUp(g)}})]),w("div",{className:"explorer-toolbar-top-col explorer-toolbar-path"},[p.element]),w("div",{className:"explorer-toolbar-top-col explorer-toolbar-search"},o.element)]);function C(_){o.setPlaceHolder(`Search ${_}`)}function T(_,k,D){const M=_.length;t.classList[k>0?"remove":"add"]("disabled"),i.classList[k>=M-1?"add":"remove"]("disabled");const S=D.split("/").filter(B=>B!=="");if(S.length>1){let B=[...S];B.pop(),g=B.join("/")}s.classList[S.length<=1?"add":"remove"]("disabled")}return{element:f,toolbarPath:p,setPlaceHolder:C,checkHistoryButtons:T}}function l(){fa({title:y,placholder:"Enter folder name",parent:e.getContainer(),onSubmit(d){me.createFolder(y+"/"+d,f=>{f&&os({title:"",width:300,height:150,parent:e.getContainer(),content:w("div",{className:"w-full h-full flex items-center content-center"},w("div",{className:"text-ellipsis line-clamp-1"},f.message))}).focusToButton("ok")})}}),E.close()}function m(d){const f=d.currentTarget,t=[{icon:"imgs/icons/Folder.png",iconType:"image",text:"Folder",onClick:()=>{l()},disabled:!G(y)||y===""||y==="This PC"||y==="Favourites"}];E=ma({triggerElement:f,options:t})}function a(d){let f,t,i,s,o,p=!1,g=!1,C={new:{onclick:m},undo:{onclick:d.onUndo},redo:{onclick:d.onRedo},copy:{onclick:d.onCopy},cut:{onclick:d.onCut},paste:{onclick:d.onPaste},open:{onclick:d.onOpen},delete:{onclick:d.onDelete},rename:{onclick:d.onRename}};f=w("div",{className:"explorer-toolbar-bottom flex items-center"},[t=w("div",{className:"explorer-toolbar-bottom-items h-full flex items-center"},[w("div",{className:"explorer-toolbar-group"},[C.new.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:m},[w("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:ts(20,1.5)}),w("div",{className:"explorer-toolbar-bottom-item-text"},"New")])]),w("div",{className:"explorer-toolbar-group"},[C.undo.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.undo.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Undo.png)"}}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Undo")]),C.redo.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.redo.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Redo.png)"}}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Redo")])]),w("div",{className:"explorer-toolbar-group"},[C.copy.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.copy.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/copy.png)"}}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Copy")]),C.cut.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.cut.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/scissors.png)"}}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Cut")]),C.paste.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.paste.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/clipboard.png)"}}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Paste")])]),w("div",{className:"explorer-toolbar-group"},[C.open.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.open.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:_r}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Open")])]),w("div",{className:"explorer-toolbar-group"},[C.delete.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.delete.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Emblems/170.png)"}}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Delete")]),C.rename.elem=w("div",{className:"explorer-toolbar-bottom-item",onclick:C.rename.onclick},[w("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Rename.png)"}}),w("div",{className:"explorer-toolbar-bottom-item-text"},"Rename")])])]),s=w("div",{className:"explorer-overflow-action-more",style:{width:"30px",height:"30px",display:"none",marginInline:"10px"},innerHTML:Qs()},i=w("div",{className:"explorer-overflow-actions flex flex-col"})),w("div",{["drag-region"]:"drag",className:"h-full flex-1"}),o=w("label",{title:'Import files from "Local Device" to this site',className:"explorer-toolbar-bottom-item explorer-import-file-button h-full",style:{marginLeft:"auto",marginRight:"5px",padding:"0 5px"}},[w("input",{name:"file-chooser",type:"file",accept:"*",style:{display:"none"},multiple:!0,onchange:e.onImportFiles}),"Import"])]);function T(){const B=t.offsetWidth,H=[];if(t.scrollWidth>B){const F=Array.from(t.children);for(let O of F)O.offsetLeft+O.offsetWidth>B?(H.push(O.cloneNode(!0)),O.style.visibility="hidden"):O.style.visibility="visible";ot(i),H.forEach(O=>{O.style.visibility="visible",i.appendChild(O)}),p||(p=!0,g=!1,s.style.display="block")}else if(!g){g=!0,p=!1;const F=Array.from(t.children);for(let O of F)O.style.visibility="visible";s.style.display="none"}}function _(B){var H,F;for(let O of B)(F=(H=C[O])==null?void 0:H.elem)==null||F.classList.remove("disabled")}function k(B){var H,F;for(let O of B)(F=(H=C[O])==null?void 0:H.elem)==null||F.classList.add("disabled")}function D(){const B=Object.keys(C);for(let H of B)C[H].elem.classList.add("disabled")}function M(){o.classList.remove("disabled")}function S(){o.classList.add("disabled")}return{element:f,checkOverflow:T,enableButtons:_,disableButtons:k,disableAllButtons:D,enableImportButton:M,disableImportButton:S}}function h(d){y=d,zt(y)?v.disableImportButton():v.enableImportButton()}function u(d,f){if(zt(f))v.disableButtons(["new","copy","cut","paste","open","delete","rename"]);else{const t=d.length;t===0?(v.enableButtons(["new"]),v.disableButtons(["copy","cut","open","delete","rename"])):t===1?v.enableButtons(["new","copy","cut","open","delete","rename"]):t>1&&(v.disableButtons(["rename"]),v.enableButtons(["new","copy","cut","open","delete"]))}}return{element:c,toolbarActions:v,toolbarNavigation:b,setLocation:h,setSelectedItems:u}}const va=e=>({"":"",folder:"File Folder",file:e.type==="file"?Ut(gt(e.text)).description:"File Folder",driver:"Local Disk"})[e.type];function _a(e,c){let v,b,y,E,x=0,r=0,n={...e},l=[],m=w("div",{className:"pannel-selection",style:{display:"none",pointerEvents:"none"}}),a=!1,h,u;v=w("div",{className:"pannel w-full h-full scrollable"},[m,b=w("div",{className:"pannel-selector-handler w-full h-full",onmousedown:B}),E=f(n.view)]);function d(N){c.onChange(N)}function f(N="details"){switch(N){case"extraLargeIcons":case"largeIcons":case"mediumIcons":case"smallIcons":return t(N);case"list":return C();case"details":return g();case"tiles":return T();default:return g()}}function t(N){if(G(n.group)){let j=Ts(e.items,Z=>Z[n.group.by]);const V=Object.keys(j).map(Z=>Z).sort((Z,R)=>n.group.orderBy==="asc"?Z.localeCompare(R):R.localeCompare(Z));y=w("div",{className:"pannel-items-group-container"});const q=V.length;for(let Z=0;Z<q;Z++){const R=V[Z];let $=j[R];G(n.sortBy)&&($=$.sort((U,Y)=>n.orderBy==="asc"?U[n.sortBy].localeCompare(Y[n.sortBy]):Y[n.sortBy].localeCompare(U[n.sortBy])));const X=o(R.toFirstUpperCase()+` (${$.length})`,s($,N));y.appendChild(X)}return y}let z=n.items.sort((j,V)=>{const q=V.type.localeCompare(j.type),Z=j.text.localeCompare(V.text);return q||Z});return G(n.sortBy)&&(z=z.sort((j,V)=>n.orderBy==="asc"?j[n.sortBy].localeCompare(V[n.sortBy]):V[n.sortBy].localeCompare(j[n.sortBy]))),y=s(z,N)}function i(N){let z=w("div",{className:"pannel-item-icon-bg"});const j=w("div",{className:"pannel-item-icon flex items-end content-center",style:{backgroundImage:`url(${N.icon})`}},z);function V(q,Z){const R=Z||1;j.style.backgroundImage="none",z.style.aspectRatio=R.toString(),R>=1?z.style.width="100%":z.style.height="100%",z.style.backgroundImage=`url(${q})`}if(N.type==="file"){const q=gt(N.name||N.text);if(Xe(N.location)){if(Di(q))oi.getThumbnail(N.location,q,V);else if(Mi(q)){const Z=w("div",{className:"app-association",style:{backgroundImage:`url(${wt.mediaPlayer.icon})`}});z.appendChild(Z),oi.getThumbnail(N.location,q,V)}}}return j}function s(N,z){let j=N.sort((V,q)=>{const Z=q.type.localeCompare(V.type),R=V.text.localeCompare(q.text);return Z||R});return w("div",{className:"pannel-items pannel-items-thumbnail "+z},j.map(V=>{let q,Z;return q=w("div",{className:"w-full h-full"},Z=w("div",{className:"pannel-item flex flex-col items-center content-center",info:V,ondblclick:d.bind(null,V),onmousedown:p,ondragover(R){c.onPannelItemDragover(R,V),q.classList.add("pannel-item-selected")},ondragleave(){q.classList.remove("pannel-item-selected")},ondrop(R){q.classList.remove("pannel-item-selected"),c.onPannelItemDrop(R,V)}},[i(V),w("div",{title:V.text,className:"pannel-item-text text-center"},V.text)])),vi(Z,V),q}))}function o(N,z){return w("div",{className:"pannel-items-group"},[w("div",{className:"pannel-items-group-header flex items-center",style:{padding:"3px 5px"}},[w("div",{className:"pannel-items-group-header-icon flex-shrink-0 flex items-center content-center",innerHTML:Li(18)}),w("div",{className:"pannel-items-group-header-label flex-shrink-0"},N),w("div",{className:"pannel-items-group-header-line w-full",style:{height:"1px",backgroundColor:"var(--border-color)",marginLeft:"5px"}})]),w("div",{className:"pannel-items-group-body"},z)])}function p(N){if(N.button!==0)return;c.onItemMouseDown();const z=N.currentTarget;if(!N.shiftKey)if(N.ctrlKey)if(z.classList.contains("pannel-item-selected")){z.classList.remove("pannel-item-selected");const j=l.findIndex(V=>V.info.location===z.info.location);j>-1&&l.splice(j,1)}else z.classList.add("pannel-item-selected"),l.push(z);else P(),z.classList.add("pannel-item-selected"),l.push(z);pe(c.onSelect)&&c.onSelect(l)}function g(){let N=n.items.sort((z,j)=>{const V=j.type.localeCompare(z.type),q=z.text.localeCompare(j.text);return V||q});return w("div",{className:"pannel-detail w-full"},w("table",{},[w("thead",{},w("tr",{className:"pannel-detail-header"},[w("td",{className:"pannel-detail-header-col pannel-detail-name",colSpan:2},"Name"),w("td",{className:"pannel-detail-header-col pannel-detail-date"},"Date modified"),w("td",{className:"pannel-detail-header-col pannel-detail-type"},"Type"),w("td",{className:"pannel-detail-header-col pannel-detail-size"},"Size")])),y=w("tbody",{className:"pannel-items pannel-items-details"},N.map(z=>{let j,V="";if(z.size){const q=Qt(parseInt(z.size));V=q.value+" "+q.unit}return j=w("tr",{className:"pannel-item",info:z,ondblclick:d.bind(null,z),onmousedown:p,ondragover(q){c.onPannelItemDragover(q,z),j.classList.add("pannel-item-selected")},ondragleave(){j.classList.remove("pannel-item-selected")},ondrop(q){j.classList.remove("pannel-item-selected"),c.onPannelItemDrop(q,z)}},[w("td",{className:"pannel-item-icon",style:{backgroundImage:`url(${z.icon})`}}),w("td",{className:"pannel-item-col"},w("div",{className:"text-ellipsis line-clamp-1"},z.text)),w("td",{className:"pannel-item-col pannel-item-mdate pannel-detail-date"},w("div",{className:"text-ellipsis line-clamp-1"},z.properties.mdate?S(z.properties.mdate):"")),w("td",{className:"pannel-item-col pannel-item-type pannel-detail-type"},w("div",{className:"text-ellipsis line-clamp-1"},va(z))),w("td",{className:"pannel-item-col pannel-item-size pannel-detail-size"},V)]),vi(j,z),j}))]))}function C(){return w("div")}function T(){if(G(n.group)){let N=Ts(e.items,V=>V.type);const z=Object.keys(N).map(V=>V).sort((V,q)=>n.group.orderBy==="asc"?V.localeCompare(q):q.localeCompare(V));y=w("div",{className:"pannel-items-group-container"});const j=z.length;for(let V=0;V<j;V++){const q=z[V];let Z=N[q];G(n.sortBy)&&(Z=Z.sort(($,X)=>n.orderBy==="asc"?$[n.sortBy].localeCompare(X[n.sortBy]):X[n.sortBy].localeCompare($[n.sortBy])));const R=o(q.toFirstUpperCase()+` (${Z.length})`,_(Z));y.appendChild(R)}return y}return y=_(e.items)}function _(N){return w("div",{className:"pannel-items pannel-items-tiles"},N.map(z=>{let j,V;return j=w("div",{className:"w-full h-full flex items-center content-center"},V=w("div",{className:"pannel-item flex items-center",info:z,ondblclick:d.bind(null,z),onmousedown:p,ondragover(q){c.onPannelItemDragover(q,z),j.classList.add("pannel-item-selected")},ondragleave(){j.classList.remove("pannel-item-selected")},ondrop(q){j.classList.remove("pannel-item-selected"),c.onPannelItemDrop(q,z)}},[w("div",{className:"pannel-item-icon",style:{backgroundImage:`url(${z.icon})`}}),w("div",{className:"pannel-item-info w-full"},[w("div",{className:"pannel-item-text"},z.text),w("div",{className:"pannel-item-desc"},z.type==="driver"?w("div",{className:"progress w-full"},D()):""),w("div",{className:"pannel-item-size"},z.type==="driver"?M():"")])])),vi(V,z),j}))}function k(N){G(navigator.storage)?navigator.storage.estimate().then(({quota:z,usage:j})=>{let V=j/z*100,q=Qt(z),Z=Qt(z-j);z>2e10&&(V=(j+2e10)/z*100,Z=Qt(z-2e10-j)),N({available:q,free:Z,percent:V})}):N({available:{value:0,unit:"B"},free:{value:0,unit:"B"},percent:0})}function D(){const N=w("div",{className:"progress-value",style:{width:"80%"}});return k(({percent:z})=>{N.style.width=z+"%"}),N}function M(){const N=w("div",{},"4 GB free of 20 GB");return k(({available:z,free:j})=>{N.textContent=`${j.value} ${j.unit} free of ${z.value} ${z.unit}`}),N}function S(N){const z=new Date(N),j=z.getDate();return Qi[z.getDay()]+", "+(j<10?"0"+j:j)+"-"+Ui[z.getMonth()]+"-"+z.getFullYear()+" "+It(z)}function B(N){N.button===0&&(N.shiftKey||P(),a=!0,h={x:N.x+v.scrollLeft,y:N.y+v.scrollTop},u=v.getBoundingClientRect(),document.addEventListener("mousemove",H,!1),document.addEventListener("mouseup",F,!1))}function H(N){const z={top:v.scrollTop,left:v.scrollLeft};if(x=Math.abs(N.x+z.left-h.x),r=Math.abs(N.y+z.top-h.y),!a||x<2&&r<2)return;let j=0,V=0,q=x,Z=r;N.x+z.left>h.x?V=h.x-u.left:V=N.x-u.left+z.left,N.y+z.top>h.y?j=h.y-u.top:j=N.y-u.top+z.top,ve(m,{display:"initial",top:j+"px",left:V+"px",width:q+"px",height:Z+"px"}),(V+q>u.width+z.left||V<z.left)&&v.scrollTo({top:N.y-u.top,left:N.x-u.left}),O({x1:V,x2:V+q,y1:j,y2:j+Z},N.shiftKey)}function F(){a=!1,document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",F,!1),ve(m,{display:"none",top:0,left:0,width:0,height:0}),l=Array.from(y.getElementsByClassName("pannel-item-selected")),pe(c.onSelected)&&c.onSelected(l)}function O(N,z){const j=Array.from(y.getElementsByClassName("pannel-item")).map(q=>q),V=[];for(let q of j){let Z=q.offsetLeft,R=q.offsetTop,$=q.offsetWidth,X=q.offsetHeight;Z+$<N.x1||Z>N.x2||R+X<N.y1||R>N.y2?z||q.classList.remove("pannel-item-selected"):(V.push(q),q.classList.add("pannel-item-selected"))}pe(c.onSelect)&&c.onSelect(V)}function P(){for(let N of l)N.classList.remove("pannel-item-selected");l=[],pe(c.onSelect)&&c.onSelect([])}function L(N){G(E)&&E.remove(),E=f(N),v.appendChild(E),A()}function I(){b.style.height="0px"}function A(){I(),b.style.height=v.scrollHeight+"px"}return{element:v,setView:L,updateSelectionHandler:A}}function wa(e){let c,v,b,y,E,x;c=w("div",{className:"explorer-status-bar flex items-center flex-shrink-0"},[v=w("div",{className:"explorer-status-bar-item"},"0 items"),b=w("div",{className:"explorer-status-bar-item"}),y=w("div",{className:"explorer-status-bar-item"}),w("div",{className:"explorer-status-bar-item",style:{marginLeft:"auto",marginRight:"10px"}},[E=w("div",{className:"explorer-status-bar-view button-presentation",innerHTML:Wr(16),onclick:r.bind(null,"details")}),x=w("div",{className:"explorer-status-bar-view button-presentation",innerHTML:en(16),onclick:r.bind(null,"mediumIcons")})])]);function r(h){e.onViewChange(h)}function n(h){E.classList.remove("selected"),x.classList.remove("selected"),h==="details"?E.classList.add("selected"):h==="mediumIcons"&&x.classList.add("selected")}function l(h=0){v.textContent=h+" items"}function m(h=0){b.textContent=h>0?h+" items selected":""}function a(h){y.textContent=h}return{element:c,setItemCount:l,setSelectedItem:m,setView:n,setSize:a}}const yn=(e,c,v=!1)=>{let b;const y=[];let E,x=[],r;const n=Gi(),l=bn({onTabChange:u,onTabClose:f,onNewTabActionClick:k,onDragOut:o,onDragOver:()=>{},onDragEnd(D,M){M&&(E.content.setCurrentWindow(b),l.showNewButton())},getTabCount:h,moveWindow:a}),m=w("div",{className:"window-tabs-container explorer-tabs-container w-full"},[w("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]);m.addEventListener("tabdragover",s,!1);function a(D,M){ve(b.element,{pointerEvents:"none"}),document.addEventListener("mousemove",B,!1),document.addEventListener("mouseup",H,!1);let S;function B(F){b.checkWindowSnap({x:F.x,y:F.y}),b.setBounds({top:F.y-M.deltaTop,left:F.x-M.deltaLeft});const O=document.elementFromPoint(F.x,F.y);if(O instanceof Element){const P=O.closest(".explorer-tabs-container");G(P)&&S!==P&&(S=P,H(),b.close(),P.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:F.x,dx:M.dl,y:F.y,tabId:D.id,windowId:D.windowId,icon:D.icon,text:D.text,content:E.content}})))}}function H(){b.setWindowSnap(),ve(b.element,{pointerEvents:"initial"}),document.removeEventListener("mousemove",B,!1),document.removeEventListener("mouseup",H,!1)}}function h(){return y.length}function u(D){if(r===D.id)return;r=D.id,E=d(D.id);const M=x.findLastIndex(S=>S===D.id);M>-1&&x.splice(M,1),x.unshift(D.id),l.setActiveTab(D.id),b.setContent(E.content.element),E.content.updateSelectionHandler(),i(E.id,E.text,E.icon)}function d(D){return y.find(M=>M.id===D)}function f(D,M){const S=y.findIndex(H=>H.id===D.id);l.remove(D.id),S>-1&&(M||y[S].content.dispose(),y.splice(S,1));const B=x.findIndex(H=>H===D.id);B>-1&&x.splice(B,1),y.length===0?b.close():(E=d(x[0]),l.setActiveTab(E.id),i(E.id,E.text,E.icon),b.setContent(E.content.element))}function t(D){let M=b,S,B="wtct"+Ii(),H;const F=[];let O=0,P="",L=[],I;const A=J=>{I=J},N=ga({onItemClick:J=>{let le=!(Xe(J.location)||bt(J.location));V(J,!0,le)},onImportFiles(J){const le=J.target;zt(P)||Yo(P,Array.from(le.files))},history:{onBackward:Z,onForward:R,onGoUp:$},getContainer:()=>b.element,getCurrentLocation:()=>P,actionEvents:{onDelete(){const J=L.map(le=>{const se={type:le.info.type,location:le.info.location};return le.info.type==="file"&&(se.size=le.info.properties.size),se});Zo(J,P)}}}),z=ua({onChange:J=>{V(J,!0,!0)}}),j=wa({onViewChange:J=>{S.setView(J),j.setView(J),me.setView(P,{type:J,sortBy:"name",orderBy:"asc"})}});function V(J,le=!0,se=!1){var de;if(j.setSelectedItem(0),N.setLocation(J.location),le&&(F.splice(O+1,F.length),((de=F[F.length-1])==null?void 0:de.text)!==J.text&&(O=F.push(J)-1)),se){const Pe=n.findIndex(ne=>ne.name===J.text||ne.path===J.text),be=n[Pe];if(Pe>-1)if(P=be.location,N.setLocation(P),X(),be.type==="root"){const ne=be.children.filter(ue=>ue.type==="folder").map(ue=>new Promise((Le,oe)=>{me.stats(ue.location,(fe,Se)=>{fe?oe(fe):Le({...Se,location:ue.location})})})),ge=be.children.filter(ue=>ue.type!=="folder");Promise.all(ne).then(ue=>{const oe=ge.concat(ue).map(fe=>({icon:fe.icon||(fe.type==="file"?Ut(gt(fe.name)).icon:mt),text:fe.name,properties:{...fe},type:fe.type,location:fe.location}));te(oe,{view:be.view,group:be.group,sortBy:be.sortBy,orderBy:be.orderBy})}),N.toolbarNavigation.toolbarPath.setPath({text:be.name,icon:be.icon,path:be.path,location:be.location}),N.toolbarNavigation.setPlaceHolder(be.name),pe(I)&&I(D,be.name,be.icon)}else(be.type==="folder"||be.type==="driver")&&Ce(be.location,be.path,{view:be.view,group:be.group,sortBy:be.sortBy,orderBy:be.orderBy});else Ce(J.location)}else Ce(J.location);function Ce(Pe,be,ne){me.readFolder(Pe,(ge,ue)=>{if(ge)console.log(ge);else{P=Pe,N.setLocation(P),X();const Le=ue.map(oe=>{var fe;return{icon:oe.icon||(oe.type==="file"?Ut(gt(oe.name)).icon:mt),text:oe.name,properties:{...oe},type:oe.type,location:Pe+"/"+oe.name,name:oe.name,cdate:oe.cdate.toString(),size:(fe=oe.size)==null?void 0:fe.toString()}});me.stats(Pe,(oe,fe)=>{if(oe)console.log(oe);else{N.toolbarNavigation.toolbarPath.setPath({text:fe.text||fe.name,icon:fe.icon||mt,path:G(be)?be:Pe,location:Pe}),pe(I)&&I(D,fe.text||fe.name,fe.icon||mt),N.toolbarNavigation.setPlaceHolder(fe.text||fe.name);let Se={};G(fe.view)?Object.assign(Se,{...fe.view,view:fe.view.type}):G(ne)&&(Se=ne),te(Le,Se)}})}})}}function q(){let J=!1,le=P;function se(){J&&le===P&&(V({location:P,text:P},!1),J=!1)}function Ce(de){return de.substring(P.length+1,de.length).split("/")}me.addEventListener("added",B,$t(()=>{se()},{limit:1e3,onFunction(de){de.includes(P)&&Ce(de).length===1&&(J||(J=!0),le=P)}})),me.addEventListener("modified",B,$t(()=>{se()},{limit:1e3,onFunction(de){de.includes(P)&&Ce(de).length===1&&(J||(J=!0),le=P)}})),me.addEventListener("removed",B,$t(()=>{se()},{limit:1e3,onFunction(de){de.includes(P)&&Ce(de).length===1&&(J||(J=!0),le=P)}}))}q();function Z(){O-=1,V(F[O],!1,!0)}function R(){O+=1,V(F[O],!1,!0)}function $(J){V({text:J,location:J})}function X(){N.toolbarNavigation.checkHistoryButtons(F,O,P)}function U(J){J.preventDefault(),zt(P)||_i(P,J.dataTransfer.items)}function Y(J){J.preventDefault(),J.stopPropagation(),J.dataTransfer.dropEffect="copy"}function W(J,le){J.preventDefault(),J.stopPropagation(),le.type==="folder"||le.type==="driver"?_i(le.location,J.dataTransfer.items):zt(P)||_i(P,J.dataTransfer.items)}function te(J,le){setTimeout(()=>{ot(H),N.setSelectedItems([],P),j.setItemCount(J.length),j.setView(le.view),!G(J)||(J==null?void 0:J.length)===0?H.appendChild(w("div",{style:{textAlign:"center",padding:"20px 0"}},"This folder is empty")):(S=_a({selectable:!0,items:J,...le},{onItemMouseDown(){},onChange:se=>{if(se.type==="folder"||se.type==="driver")V({text:se.location,location:se.location},!0);else{const Ce=gt(se.text),de=Ut(Ce);Fe(de.appName,se.location)}},onSelect(se){if(L=se,N.setSelectedItems(se,P),j.setSelectedItem(se.length),se.length>0&&se.every(de=>de.info.type==="file")){const de=Qt(ee(se));j.setSize(de.value+" "+de.unit)}else j.setSize("")},onPannelItemDragover:Y,onPannelItemDrop:W}),H.appendChild(S.element),S.updateSelectionHandler())},50)}function _e(){M.addEventListener("resize",Ye(()=>{S.updateSelectionHandler()})),M.addEventListener("passiveResize",Ye(()=>{S.updateSelectionHandler()})),M.addEventListener("maximize",Ye(()=>{S.updateSelectionHandler()})),M.addEventListener("unmaximize",Ye(()=>{S.updateSelectionHandler()})),M.addEventListener("unSnap",Ye(()=>{S.updateSelectionHandler()})),M.addEventListener("restore",Ye(()=>{S.updateSelectionHandler()}))}function Q(){M.removeListeners("resize",Ye(()=>{})),M.removeListeners("passiveResize",Ye(()=>{})),M.removeListeners("maximize",Ye(()=>{})),M.removeListeners("unmaximize",Ye(()=>{})),M.removeListeners("unSnap",Ye(()=>{})),M.removeListeners("restore",Ye(()=>{}))}function re(){_e()}re();function ee(J){let le=0,se=J.length;for(let Ce=0;Ce<se;Ce++){const de=J[Ce];de.info.type==="file"&&(le+=de.info.properties.size)}return le}const he=w("div",{className:"explorer-container w-full h-full relative"},[N.element,w("div",{className:"explorer-body flex flex-col w-full h-full"},[w("div",{className:"w-full flex",style:{height:"calc(100% - 25px)"}},[z.element,H=w("div",{className:"explorer-content h-full flex-1",ondragover(J){zt(P)&&(J.dataTransfer.dropEffect="none")},ondrop:U})]),j.element])]);function we(J){M=J,re()}function ye(){me.removeListeners("added",B),me.removeListeners("modified",B),me.removeListeners("removed",B)}return{element:he,toolbar:N,listenEvent:A,routeTo:V,listenFileChange:q,setCurrentWindow:we,updateSelectionHandler(){S==null||S.updateSelectionHandler()},addWindowEvents:_e,removeWindowEvents:Q,dispose:ye}}function i(D,M,S){b.setTitle(M),G(S)&&b.setIcon(S);const B=l.getTab(D);G(B)&&(B.setTitle(M),G(S)&&B.setIcon(S));const H=d(D);G(H)&&(H.text=M,H.icon=S)}function s(D){l.hideNewButton(),b.focus();const M=D,S={icon:M.detail.icon,text:M.detail.text,content:M.detail.content},B=l.add(S);B.triggerMouseMove(M),E={id:B.id,text:S.text,icon:S.icon,content:S.content},E.content.listenEvent((H,F,O)=>{i(B.id,F,O)}),E.content.listenFileChange(),x.unshift(B.id),y.push(E),b.setContent(S.content.element)}function o(D,M){const S=b.getBounds(),B={top:M.top-M.deltaTop,left:M.left-M.deltaLeft,width:S.width,height:S.height},H=d(D.id);H.content.listenEvent(null),H.content.removeWindowEvents(),D.content=H.content;const F=yn(null,B,!0);F.addTabAndMoveWindow(D,{...M,windowBounds:B},F.window)}function p(D,M,S){const B=l.add(D);l.disabledScrollbar(),ve(B.element,{position:"absolute",left:M.deltaLeft-M.dl+"px"}),E={id:B.id,text:D.text,icon:D.icon,content:D.content},E.content.setCurrentWindow(S),E.content.addWindowEvents(),x.unshift(B.id),r=B.id,E.content.listenEvent((H,F,O)=>{i(E.id,F,O)}),E.content.listenFileChange(),y.push(E),b.setContent(E.content.element),i(E.id,E.text,E.icon),g(D,M,B),l.hideNewButton()}function g(D,M,S){ve(b.element,{pointerEvents:"none"}),document.addEventListener("mousemove",H,!1),document.addEventListener("mouseup",F,!1);let B;function H(O){b.checkWindowSnap({x:O.x,y:O.y}),b.setBounds({top:O.y-M.deltaTop,left:O.x-M.deltaLeft});const P=document.elementFromPoint(O.x,O.y);if(P instanceof Element){const L=P.closest(".explorer-tabs-container");G(L)&&B!==L&&(B=L,F(),b.close(),L.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:O.x,dx:M.dl,y:O.y,tabId:D.id,windowId:D.windowId,icon:D.icon,text:D.text,content:E.content}})))}}function F(){l.enabledScrollbar(),b.setWindowSnap(),l.showNewButton(),ve(b.element,{pointerEvents:"initial"}),S.element.style.removeProperty("position"),S.element.style.removeProperty("left"),document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",F,!1)}}function C(D){const M={text:D,icon:"imgs/icons/Folder.png"},S=l.add(M),B=t(S.id);B.listenEvent((H,F,O)=>{i(H,F,O)}),B.routeTo({text:D,location:D},!0,!0),E={id:S.id,text:M.text,icon:M.icon,content:B},x.unshift(S.id),y.push(E),b.setContent(B.element),i(M.id,M.text,M.icon)}function T(D){const M=l.add({...D,windowId:b.id});let S=t(M.id);S.listenEvent(i),E={id:M.id,text:D.text,icon:D.icon,content:S},x.unshift(M.id),r=M.id,y.push(E),b.setContent(S.element),S.routeTo({text:D.text},!0,!0),i(D.id,D.text,D.icon)}function _(){T({text:"This PC",windowId:b.id,icon:"imgs/icons/Computer.png"})}function k(){_()}return b=lt({args:e,icon:ie.explorer.icon,hideIcon:!0,name:ie.explorer.name,title:ie.explorer.productName,hideTitle:!0,titlebarHeight:_t,titlebarContent:m,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||50,width:(c==null?void 0:c.width)||800,height:(c==null?void 0:c.height)||520,className:"explorer-app-window",transprencyContent:!0}),v||(G(e)?C(e):_()),b.addEventListener("close",()=>{for(let D=0;D<y.length;D++)y[D].content.dispose()}),b.addEventListener("secondInstance",D=>{b.isVisible()||b.show(),b.focus(),G(D)?C(D):_()}),b.addEventListener("restore",function(){b.isMaximized()||b.setTitlebarHeight(_t)}),b.addEventListener("unmaximize",function(){b.isMaximized()||b.setTitlebarHeight(_t)}),b.addEventListener("unSnap",function(){b.isMaximized()||b.setTitlebarHeight(_t)}),b.addEventListener("maximize",function(){b.setTitlebarHeight(Mt)}),{addTabAndMoveWindow:p,tabs:l,window:b}};function ba(e){let c=ns(ie.explorer.name);G(c)?c.window.executeListeners("secondInstance",e):yn(e)}function qe(e,c){const v=Ms(50,200),b=Ms(50,200);lt({icon:e.icon,name:e.name,title:e.productName,top:v,left:b,width:450,height:300,content:()=>w("div",{className:"w-full h-full flex content-center items-center"},w("h3",{},"In Progress"))})}function ya(e,c){let v;v=w("div",{tabIndex:0,className:"menu-strip flex items-center",onfocus:c.onfocus,onblur:c.onblur});for(let E=0;E<e.length;E++){const x=e[E],r=w("div",{className:"menu-strip-item flex-shrink-0"},w("div",{className:"h-full flex items-center"},x.text));b(r,x.children),v.appendChild(r)}function b(E,x){if(G(x)){const r=w("div",{className:"context-menu"});x.forEach(n=>[y(r,n)]),E.appendChild(r)}}function y(E,x){if(x.divider){let l=w("div",{className:"menu-item-divider"});E.appendChild(l);return}const r=G(x.children)&&x.children.length>0,n=w("div",{className:"menu-item"+(x.disabled?" disabled":"")+(x.emphasis?" emphasis":"")+(x.checked?" checked":""),onclick:()=>{!x.disabled&&!r&&pe(c.onItemClick)&&c.onItemClick(x)}},[w("div",{className:"menu-item-icon",innerHTML:x.checked?an():"",style:{pointerEvents:"none"}}),w("div",{className:"menu-item-text",style:{pointerEvents:"none"}},x.text||"")]);if(x.shortcut){let l=w("div",{className:"menu-item-shortcut",style:{pointerEvents:"none"}},x.shortcut);n.appendChild(l)}if(r){let l=w("div",{className:"menu-item-arrow flex items-center",innerHTML:jt});n.appendChild(l)}E.appendChild(n),b(n,x.children)}return v}function Sn(e,c,v=!1){let b,y;const E=[];let x,r=[],n;const l=bn({onTabChange:h,onTabClose:d,onNewTabActionClick:f,onDragOver:()=>{},onDragOut:g,onDragEnd(k,D){D&&l.showNewButton()},getTabCount:a,moveWindow:m});function m(k,D){ve(y.element,{pointerEvents:"none"}),document.addEventListener("mousemove",S,!1),document.addEventListener("mouseup",B,!1);let M;function S(H){y.checkWindowSnap({x:H.x,y:H.y}),y.setBounds({top:H.y-D.deltaTop,left:H.x-D.deltaLeft});const F=document.elementFromPoint(H.x,H.y);if(F instanceof Element){const O=F.closest(".notepad-tabs-container");G(O)&&M!==O&&(M=O,B(),y.close(),O.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:H.x,dx:D.dl,y:H.y,tabId:k.id,windowId:k.windowId,icon:k.icon,text:k.text,content:x.element}})))}}function B(){y.setWindowSnap(),ve(y.element,{pointerEvents:"initial"}),setTimeout(()=>{x.element.input.focus()},10),document.removeEventListener("mousemove",S,!1),document.removeEventListener("mouseup",B,!1)}}function a(){return E.length}function h(k){if(n===k.id)return;n=k.id,x=u(k.id);const D=r.findLastIndex(M=>M===k.id);D>-1&&r.splice(D,1),r.unshift(k.id),l.setActiveTab(k.id),y.setContent(x.element.element),setTimeout(()=>{x.element.input.focus()},10),o(k.id,k.text,k.icon)}function u(k){return E.find(D=>D.id===k)}function d(k){const D=E.findIndex(S=>S.id===k.id);D>-1&&E.splice(D,1);const M=r.findIndex(S=>S===k.id);M>-1&&r.splice(M,1),E.length===0?y.close():(x=u(r[0]),l.setActiveTab(x.id),o(x.id,x.text),y.setContent(x.element.element))}function f(){t()}function t(){i({text:"Untitled - Notepad",icon:"imgs/icons/Apps/notepad.png"})}function i(k,D){const M=l.add({...k,windowId:y.id});let S;G(D)?S=D:S=s(),x={id:M.id,text:k.text,element:S},r.unshift(M.id),E.push(x),y.setContent(S.element),setTimeout(()=>{S.input.focus()},10),o(k.id,k.text)}function s(){let k,D,M,S;k=w("div",{className:"w-full h-full flex flex-col"},[ya([{text:"File",children:[{text:"New",shortcut:"Ctrl+N"},{text:"Open",shortcut:"Ctrl+O"},{text:"Save",shortcut:"Ctrl+S"},{text:"SaveAs",shortcut:"Ctrl+Shift+S"},{divider:!0},{text:"Close",shortcut:"Alt+W"}]},{text:"Edit",children:[{text:"Undo",disabled:!0,shortcut:"Ctrl+Z"},{divider:!0},{text:"Cut",disabled:!0,shortcut:"Ctrl+X"},{text:"Copy",disabled:!0,shortcut:"Ctrl+C"},{text:"Paste",disabled:!0,shortcut:"Ctrl+V"},{text:"Delete",disabled:!0,shortcut:"Del"},{divider:!0},{text:"Find",shortcut:"Ctrl+F"},{text:"Replace...",shortcut:"Ctrl+H"},{divider:!0},{text:"Select All",shortcut:"Ctrl+A"}]},{text:"Format",children:[{text:"Wordwrap",checked:!0},{text:"Font..."}]},{text:"View",children:[{text:"Zoom",children:[{text:"Zoom In",shortcut:"Ctrl+Plus"},{text:"Zoom Out",shortcut:"Ctrl+Minus"},{text:"Restore Default Zoom",shortcut:"Ctrl+0"}]},{text:"Status Bar",checked:!0}]},{text:"Help",children:[{text:"View Help"},{text:"Send Feedback"},{divider:!0},{text:"About Notepad"}]}],{onItemClick(){D.focus()}}),D=w("textarea",{tabIndex:0,name:"notepad-input",className:"w-full h-full scrollable scroll-y",style:{display:"block",border:0,borderTop:"1px solid var(--border-color)",outline:0,padding:"5px",color:"var(--primary-text-color)",backgroundColor:"transparent",font:"400 14px Consolas",cursor:"default",resize:"none"},onselect(O){O.preventDefault()},onkeydown:()=>{H(),document.onkeyup=F},onmousedown:()=>{H(),F(),document.onmousemove=()=>{H(),F()},document.onmouseup=F}}),w("div",{className:"note-pad-status-bar w-full flex items-center flex-shrink-0",style:{borderTop:"1px solid var(--border-color)",minHeight:"25px",paddingInline:"10px"}},[w("div",{className:"note-pad-status-left h-full"}),w("div",{className:"note-pad-status-right flex h-full",style:{marginLeft:"auto"}},[M=w("div",{className:"note-pad-status-bar-item"}),S=w("div",{className:"note-pad-status-bar-item"}),w("div",{className:"note-pad-status-bar-item"},"100%"),w("div",{className:"note-pad-status-bar-item"},"Windows (CRLF)"),w("div",{className:"note-pad-status-bar-item"},"UTF-8")])])]),H(),F();function H(){setTimeout(()=>{const O=D.value.substring(0,D.selectionStart).split(`
`),P=O.length,L=O[O.length-1].length;S.textContent=`Ln ${P}, Col ${L}`},150)}function F(){setTimeout(()=>{const O=D.value.substring(D.selectionStart,D.selectionEnd);M.textContent=(O.length>0?O.length:0)+" selected"},100)}return{element:k,input:D}}function o(k,D,M){y.setTitle(D);const S=l.getTab(k);G(S)&&(S.setIcon(M||"imgs/icons/Apps/notepad.png"),S.setTitle(D))}function p(k){l.hideNewButton(),y.focus();const D=k,M={icon:D.detail.icon,text:D.detail.text,content:D.detail.content},S=l.add(M);S.triggerMouseMove(D),x={id:S.id,text:M.text,element:M.content},r.unshift(S.id),E.push(x),y.setContent(M.content.element),setTimeout(()=>{x.element.input.focus()},10),o(S.id,x.text)}function g(k,D){const M=y.getBounds(),S={top:D.top-D.deltaTop,left:D.left-D.deltaLeft,width:M.width,height:M.height},B=u(k.id);k.content=B.element,Sn(null,S,!0).addTabAndMoveWindow(k,{...D,windowBounds:S})}function C(k,D){const M=l.add(k);ve(M.element,{position:"absolute",left:D.deltaLeft-D.dl+"px"}),x={id:M.id,text:k.text,element:k.content},r.unshift(M.id),E.push(x),y.setContent(x.element.element),setTimeout(()=>{x.element.input.focus()},10),o(M.id,k.text,k.icon),T(k,D,M),l.hideNewButton()}function T(k,D,M){ve(y.element,{pointerEvents:"none"}),document.addEventListener("mousemove",B,!1),document.addEventListener("mouseup",H,!1);let S;function B(F){y.checkWindowSnap({x:F.x,y:F.y}),y.setBounds({top:F.y-D.deltaTop,left:F.x-D.deltaLeft,width:D.windowBounds.width,height:D.windowBounds.height});const O=document.elementFromPoint(F.x,F.y);if(O instanceof Element){const P=O.closest(".notepad-tabs-container");G(P)&&S!==P&&(S=P,H(),y.close(),P.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:F.x,dx:D.dl,y:F.y,tabId:k.id,windowId:k.windowId,icon:k.icon,text:k.text,content:x.element}})))}}function H(){y.setWindowSnap(),l.showNewButton(),ve(y.element,{pointerEvents:"initial"}),M.element.style.removeProperty("position"),M.element.style.removeProperty("left"),setTimeout(()=>{x.element.input.focus()},10),document.removeEventListener("mousemove",B,!1),document.removeEventListener("mouseup",H,!1)}}function _(k){Xi(k,(D,M)=>{if(D)return;const S=et(k)+" - Notepad";y.setTitle(S);const B={text:S,icon:"imgs/icons/Apps/notepad.png"},H=l.add({...B,windowId:y.id}),F=s();F.input.value=M,x={id:H.id,text:S,element:F},r.unshift(H.id),E.push(x),y.setContent(F.element),F.input.focus(),o(H.id,B.text,B.icon)})}return b=w("div",{className:"window-tabs-container notepad-tabs-container w-full"},[w("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]),b.addEventListener("tabdragover",p,!1),y=lt({args:e,icon:ie.notepad.icon,hideIcon:!0,name:ie.notepad.name,title:ie.notepad.productName,hideTitle:!0,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||100,width:(c==null?void 0:c.width)||700,height:(c==null?void 0:c.height)||450,titlebarHeight:_t,titlebarContent:b,className:"notepad-app-window",transprencyContent:!0}),v||(G(e)?_(e):t()),y.addEventListener("customdrop",k=>{k!=null&&k.type&&k.type==="file"&&gt(k.args)===".txt"&&Xi(k.args,(D,M)=>{D||(x.element.input.value=M,y.focus(),o(x.id,et(k.args)+" - NotePad"))})}),y.addEventListener("secondInstance",k=>{y.isVisible()||y.show(),G(k)?_(k):t(),y.focus()}),y.addEventListener("restore",()=>{y.isMaximized()||y.setTitlebarHeight(_t)}),y.addEventListener("unmaximize",()=>{y.isMaximized()||y.setTitlebarHeight(_t)}),y.addEventListener("unSnap",()=>{y.isMaximized()||y.setTitlebarHeight(_t)}),y.addEventListener("maximize",()=>{y.setTitlebarHeight(Mt)}),{addTabAndMoveWindow:C,tabs:l,window:y}}const Sa=e=>{let c=ns(ie.notepad.name);G(c)?c.window.executeListeners("secondInstance",e):Sn(e)};const xi=1.7777777777777777,ii=120,dt=140,Ci=160,ut=8,yt=48,Rs=200,xa=200,As=40,Yi=yt,Ca=60,Ns=45,Yt=4,ka="#bbb",Ea=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="9" x2="12" y2="5" />
  <line x1="8" y1="9" x2="12" y2="5" />
</svg>`,La=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="15" x2="12" y2="19" />
  <line x1="8" y1="15" x2="12" y2="19" />
</svg>
`;function Ps(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?xn(e,c):e.appendChild(document.createTextNode(c.toString())))}function xn(e,c){c instanceof Array?c.forEach(v=>{Ps(e,v)}):Ps(e,c)}function Ta(e,c){for(let v in c)v.indexOf("-")>-1?e.style.setProperty(v,c[v]):e.style[v]=c[v]}function He(e,c,v){let b=document.createElement(e);if(c){const y=c;for(let E in y)if(E==="style"){const x=y[E];Ta(b,x)}else if(E.indexOf("-")>-1||E.indexOf(":")>-1){const x=y[E];b.setAttribute(E,x)}else b[E]=y[E]}return v&&xn(b,v),b}function Hs(e){let c=e.firstChild;for(;c;)e.removeChild(c),c=e.firstChild}function Cn(e=0,c=[],v=4){const b=c.length;let y=[0],E=!1,x=0;function r(h=[],u=0,d=0,f=0,t){const i=c[d];if(!i)return h;const s=d+1-u,o=s>1?(s-1)*v:0;f+=i.ratio;const p=f*dt,g=(e-o)/f,C=g<=Ci+x&&g>=ii,T=e-p<=0?g/Ci:g/ii,_=Math.pow(Math.abs(T),3)*100,k=f;if(C)h.push({edge:d,badness:_,rowHeight:g,flag:1,itemCount:s,boxSpacing:v,ratio:k}),x=0,E=!1;else{if(p+o>e)return E?(x=0,h.length===0&&(g<ii||!t?h.push({edge:d,badness:_,rowHeight:g,flag:s>1?-1:0,ratio:k,itemCount:s,boxSpacing:v}):t&&h.push(t)),h):(E=!0,x=20,r(h,u,d,f-i.ratio,t));if(d===(b>1?b-1:0))return h.push({edge:d,badness:_,flag:0,rowHeight:dt,ratio:k,itemCount:s,boxSpacing:v}),h;t={edge:d,badness:_,rowHeight:g,flag:s>1?1:0,ratio:k,itemCount:s,boxSpacing:v}}return r(h,u,d+1,f,t)}let n=[];function l(){let h=y.shift();if(typeof h>"u"||h===null||!c[h])return;let u=r([],h,h),d;d=u[0];for(let t=1;t<u.length;t++){const i=u[t];i.badness<d.badness&&(d=i)}const f={flag:d.flag,row:[h,d.edge],ratio:d.ratio||xi,itemCount:d.itemCount,boxSpacing:d.boxSpacing,rowHeight:d.rowHeight||dt};n.push(f),d.edge+1<=b&&y.push(d.edge+1)}for(;y.length>0;)l();let m=n.length,a=n[m-1];return m>1&&a.flag===0&&(a.rowHeight=n[m-2].rowHeight),{paths:n,rowCount:n.length}}function Da(e=0,c=[],v=48){const b=c.length;let y=[0];function E(n=[],l=0,m=0,a=0,h=0,u){const d=c[m];if(!d)return n;h+=d.itemCount>1?(d.itemCount-1)*ut:0;const f=m+1-l,t=(f>1?(f-1)*v:0)+h;a+=d.ratio;const i=a*dt,s=(e-t)/a,o=s<=Ci&&s>=ii,p=e-i<=0?s/Ci:s/ii,g=Math.pow(Math.abs(p),3)*100;if(o)n.push({edge:m,badness:g,rowHeight:s,flag:1,itemCount:f,boxSpacing:v,ratio:a});else{if(i+t>e)return n.length===0&&(u?n.push(u):n.push({edge:m,badness:g,rowHeight:s,flag:1,itemCount:f,boxSpacing:v,ratio:a})),n;if(m===(b>1?b-1:0))return n.push({edge:m,badness:g,flag:0,rowHeight:dt,ratio:a,itemCount:f,boxSpacing:v}),n;u={edge:m,badness:g,rowHeight:dt,flag:0,itemCount:f,boxSpacing:v,ratio:a}}return E(n,l,m+1,a,h,u)}let x=[];function r(){let n=y.shift();if(typeof n>"u"||n===null||!c[n])return;const l=c[n];let m=c[n+1];if(l.rowCount>1||typeof m<"u"&&m.rowCount>1)x.push({flag:1,row:[n,n],boxSpacing:v,rowHeight:dt,ratio:l.ratio||xi}),n+1<=b&&y.push(n+1);else{let a=E([],n,n,0,0),h=a[0];for(let d=1;d<a.length;d++){const f=a[d];f.badness<h.badness&&(h=f)}const u={flag:h.flag,row:[n,h.edge],rowHeight:h.rowHeight||dt,boxSpacing:h.boxSpacing,ratio:h.ratio||xi};x.push(u),h.edge+1<=b&&y.push(h.edge+1)}}for(;y.length>0;)r();return{paths:x,rowCount:x.length}}function Os(e=300,c){const v=c.segments.map(l=>{const{paths:m,rowCount:a}=Cn(e,l.items),h=m[0];return{rows:m,rowCount:a,ratio:h.ratio||xi,itemCount:a===1?h.row[1]+1-h.row[0]:0}}),b=v.map(({rowCount:l,ratio:m,itemCount:a})=>({rowCount:l,ratio:m,itemCount:a})),y=Da(e,b,yt),E={index:c.index,name:c.name,loaded:!0,left:0,width:e,height:0,segments:[],segmentInfo:[]};let x=0,r=0;for(let l=0;l<y.paths.length;l++){const m=y.paths[l],a=m.flag,h=m.row[1]+1-m.row[0];let u=0;for(let d=m.row[0];d<=m.row[1];d++){const f=v[d];var n=c.segments[d];const t={index:n.index,name:n.name,top:x,left:u,width:0,height:0,items:[],flag:a};let i=0,s=0;for(let o=0;o<f.rows.length;o++){const p=f.rows[o],g=m.rowHeight||p.rowHeight||dt,C=Math.floor(g);let T=0;for(let _=p.row[0];_<=p.row[1];_++){const k=n.items[_],D=Math.round(k.ratio*g);let M={...k,top:i+yt,left:T,width:a===0?D:h>1?d===m.row[1]&&_===p.row[1]?e-(u+T):D:p.flag===0?D:_===p.row[1]&&p.itemCount>1?e-T:D,height:C};t.items.push(M),T+=M.width+ut}s=T-ut,i+=C+ut,u+=T-ut+yt}t.width=f.rowCount===1?s:e,r=i-ut+Yi,t.height=r,d===m.row[1]&&(x+=r),E.segments.push(t),E.segmentInfo.push({index:t.index,top:t.top,height:t.height})}}return E.height=x,E}function Fs(e=300,c){const v={index:c.index,name:c.name,left:0,width:e,height:0,segments:[],segmentInfo:[],loaded:!0},b=c.segments;let y=0;for(let E=0;E<b.length;E++){const x=b[E],{paths:r,rowCount:n}=Cn(e,x.items),l={index:x.index,name:x.name,top:y,left:0,width:e,height:0,items:[]};let m=0;for(let a=0;a<n;a++){const h=r[a],u=h.rowHeight,d=Math.floor(u);let f=0;for(let t=h.row[0];t<=h.row[1];t++){const i=x.items[t],s=Math.round(i.ratio*u);let o={...i,top:m+yt,left:f,width:h.flag===0?s:t===h.row[1]&&h.itemCount>1?e-f:s,height:d+Yi};l.items.push(o),f+=o.width+ut}m+=d+ut+yt}l.height=m-ut+Yi,y+=l.height,v.segments.push(l),v.segmentInfo.push({index:l.index,top:l.top,height:l.height})}return v.height=y,v}function kn(e,c,v,b){let y=0;return e+c<b-Rs&&(y=-1),e>b+v+Rs&&(y=-1),y===0}function Ma(e=0,c=[],v,b){const y=[];for(let E=0;E<c.length;E++){const x=c[E];kn(e+x.top,x.height,v,b)&&y.push(x.index)}return y}function mi(e,c,v,b=10,y){let E,x,r,n;return function(){const l=this,m=arguments;window.cancelAnimationFrame(n),n=window.requestAnimationFrame(()=>{typeof y=="function"&&y.apply(l,m,n)}),window.clearTimeout(r),r=window.setTimeout(()=>{typeof v=="function"&&v.apply(l,m)},b),x?(window.clearTimeout(E),E=window.setTimeout(function(){Date.now()-x>=c&&(e.apply(l,m),x=Date.now())},c-(Date.now()-x))):(e.apply(l,m),x=Date.now())}}function Ia(e=[],c,v,b={},y){var E;let x=e.length,r={position:"absolute",top:"0",bottom:"0",right:"0",width:Ca+"px",height:"100%",margin:"auto",background:"none",fontFamily:"inherit",cursor:"ns-resize"};b.style&&(r={...r,...b.style});let n=[],l=48,m=(l-2)/2,a=c,h,u,d,f,t,i,s,o,p,g,C;const T=y.getBounds();let _={width:T.width,height:T.height},k=!1,D=!1,M=!1,S=!1,B=0,H=0,F=!1,O,P=!1,L=!1,I=!1;d=He("div",{className:"grid-scrollbar",style:r},f=He("div",{className:"scrollbar-wrapper w-full h-full"},[t=He("div",{className:"grid-scrollbar-inner w-full",style:{top:m+(b.hideButton?0:Ns)+"px",bottom:m+(b.hideButton?0:Ns)+2+"px",cursor:r.cursor},onmouseover:j,onmouseleave:V},[He("div",{className:"w-full h-full",onmousemove:Y,onmousedown:N},[i=He("div",{className:"grid-scrollbar-thumb-primary"}),s=He("div",{className:"grid-scrollbar-thumb-secondary",tabIndex:0,style:{top:-(l/2-1)+"px",height:l+"px",cursor:r.cursor},onmouseover:j,onmouseleave:V,onkeydown:q,onclick:Z},He("div",{className:"grid-scrollbar-thumb-secondary-inner"},[p=He("div",{className:"grid-scrollbar-thumb-text"}),He("div",{className:"grid-scrollbar-thumb-line",style:{top:m+"px"}})]))]),o=He("div",{className:"grid-scrollbar-parts"})]),b.hideButton?null:g=He("button",{className:"grid-scrollbar-button grid-scrollbar-button-up disabled",innerHTML:Ea}),b.hideButton?null:C=He("button",{className:"grid-scrollbar-button grid-scrollbar-button-down",innerHTML:La})])),(E=v.parentElement)==null||E.appendChild(d),A();function A(){v.scrollHeight/v.getBoundingClientRect().height<=1?d.style.display="none":d.style.display="initial"}if(te(),W(),Q(),J(0),le(0),y.addEventListener("passiveResize",mi($,100),!1),y.addEventListener("resize",mi($,100),!1),b.autoHide){let ne=function(){S=!0,f.classList.add("mouse-over"),f.classList.remove("fade-out"),f.classList.add("fade-in")},ge=function(){S=!1,!D&&!P&&(f.classList.remove("fade-in"),f.classList.add("fade-out"),f.classList.remove("mouse-over"))};f.classList.add("auto-hide"),f.addEventListener("mouseover",ne,!1),f.addEventListener("mouseleave",ge,!1),setTimeout(()=>{v.addEventListener("scroll",R,!1)},50)}b.hideButton||(we(g,L,()=>{de()}),we(C,I,()=>{Ce()}));function N(){i.style.visibility="hidden",D=!0,document.addEventListener("mousemove",Y,!1),document.addEventListener("mouseup",z,!1)}function z(){i.style.visibility="visible",D=!1,document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",z,!1)}function j(){k=!0}function V(){k=!1}function q(ne){ne.key==="ArrowUp"?de():ne.key==="ArrowDown"&&Ce()}function Z(ne){let ge=ne.y-h.top;se(ge),he()}function R(){P||(setTimeout(()=>{F||(S||(f.classList.remove("fade-out"),f.classList.add("fade-in")),f.classList.add("scrolling"))},1e3),P=!0),O&&clearTimeout(O),O=setTimeout(()=>{f.classList.remove("scrolling"),S||(f.classList.add("fade-out"),f.classList.remove("fade-in"),f.classList.remove("mouse-over")),F=!1,P=!1},2e3)}function $(){const ne=y.getBounds();_.height!==ne.height&&(_={width:ne.width,height:ne.height},te(),W(),Q(),X(!0),he(),A())}function X(ne){const ge=v.scrollTop/(v.scrollHeight-u.height)*h.height;J(ge),(ne||!k)&&le(ge),he()}function U(ne=0,ge=0){B=ne,H=ge;const ue=B/(H-u.height)*h.height;J(ue),k||le(ue),he()}function Y(ne){ne.stopPropagation();let ge=ne.y-h.top;D?(se(ge),le(ge)):k&&le(ge)}function W(){u=v.getBoundingClientRect()}function te(){h=t.getBoundingClientRect()}function _e(ne,ge){e=ne,x=ne.length,a=ge,Q();const ue=B/(H-u.height)*h.height;J(ue),k||le(ue),A(),he()}function Q(){re(),ee()}function re(){let ne=0,ge=[];function ue(fe){const Se=ge[fe+1];return Se?Se.isMileStone?Se:ue(fe+1):null}for(let fe=0;fe<x;fe++){const Se=e[fe];let St=Se.height/a*h.height;ge.push({index:Se.index,name:Se.name,top:ne,height:St,isMileStone:Se.isMileStone,year:Se.year}),ne+=St}let Le=-20,oe=0;for(let fe=0;fe<x;fe++){const Se=ge[fe];if(Se.isMileStone)Se.top+Se.height-oe>=20&&(Se.visible=!1,Se.displayMileStone=!0,oe=Se.top),Le=Se.top;else{const St=ue(fe),hi=Se.top-Le>=10;St?hi&&St.top-Se.top>=10&&(Se.visible=!0,Le=Se.top):hi&&(Se.visible=!0,Le=Se.top)}}n=ge}function ee(){o.innerHTML="";let ne=n.length;for(let ge=0;ge<ne;ge++){const ue=n[ge];(ue.visible||ue.isMileStone)&&o.appendChild(He("div",{style:{position:"absolute",top:ue.top+ue.height-Yt+"px",right:"10px",width:Yt+"px",height:Yt+"px",display:"flex",alignItem:"center",justifyContent:"flex-end",boxSizing:"border-box"}},[ue.displayMileStone?He("div",{className:"grid-scrollbar-point-text",style:{position:"absolute",top:"-5px",right:"-2px"}},ue.year):null,ue.visible?He("div",{style:{width:Yt+"px",height:Yt+"px",borderRadius:"100%",background:ka,boxSizing:"border-box"}}):null]))}}function he(){b.hideButton||(B===0?(L=!0,I=!1,g.classList.add("disabled"),C.classList.remove("disabled")):B+u.height===H?(L=!1,I=!0,C.classList.add("disabled"),g.classList.remove("disabled")):(L=!1,I=!1,M||(g.classList.remove("disabled"),C.classList.remove("disabled"))))}function we(ne,ge=!1,ue){if(ge)return;let Le;ne.addEventListener("mousedown",oe,!1);function oe(){M=!0,Le=requestAnimationFrame(Se),document.addEventListener("mouseup",fe,!1)}function fe(){cancelAnimationFrame(Le),setTimeout(()=>{cancelAnimationFrame(Le),M=!1,he()},50),document.removeEventListener("mouseup",fe,!1)}function Se(){Le=requestAnimationFrame(Se),typeof ue=="function"&&ue()}}function ye(ne){p.textContent=ne}function J(ne=0){i.style.transform=`translate3d(0px, ${ne}px, 0px)`}function le(ne=0){if(ne>=0&&ne<=h.height){s.style.transform=`translate3d(0px, ${ne}px, 0px)`;let ge,ue=n.length;for(let Le=0;Le<ue;Le++){const oe=n[Le];ne>=oe.top&&ne<oe.top+oe.height&&(ge=oe)}ge&&ye(ge.name)}}function se(ne=0){v.scroll({top:ne/h.height*(v.scrollHeight-u.height)})}function Ce(){v.scrollTop+=As}function de(){v.scrollTop-=As}function Pe(){y.removeEventListener("resize",mi($,100),!1),y.removeEventListener("passiveResize",mi($,100),!1)}function be(){s.focus()}return{element:d,getContainerInfo:te,update:_e,updateScroll:U,focus:be,destroy:Pe}}function Ba(e,c,v,b,y,E,x,r,n){let l=0,m=[],a=[],h=0,u=0,d=b.padding||120,f=[],t=c,i,s,o,p,g=!1,C,T=0,_=0;const k=He("div",{className:"justified-layout w-full"},o=He("div",{tabIndex:-1,className:"grid-scroll-panel w-full h-full scrollable scroll-y"+(b.useNativeScrollbar?" use-native-scrollbar":""),style:{position:"relative"},onkeydown:Q=>{Q.altKey&&Q.key==="s"&&(b.useNativeScrollbar||s.focus())},onscroll:A}));e.appendChild(k),t.length===0?(n instanceof HTMLElement&&(Hs(o),o.appendChild(n)),B()):(o.appendChild(D()),M(),v!==null?(O(),B(),setTimeout(()=>{o.scrollTop=v.scrollTop,T=v.scrollTop,T===0&&Z(f)},10)):S()),b.resizeSmooth?(y.addEventListener("passiveResize",P,!1),y.addEventListener("resize",P,!1)):(y.addEventListener("passiveResize",L,!1),y.addEventListener("resize",L,!1));function D(){return p=He("div",{className:"grid-layout-container",style:{position:"relative",marginBottom:yt+"px"}},i=He("div",{className:"layout"}))}function M(){const Q=o.getBoundingClientRect();u=Q.height;let re=Math.round(Q.width)-d;y.getBounds().width<600&&(re=re-re*.2+d),h=re-re%2,R(h)}function S(){H(),B(),V(),Z(f),z()}function B(){b.useNativeScrollbar||(s=Ia(a,l,o,b.scrollbar,y))}function H(){const Q=[],re=[];let ee=0;for(let he=0;he<t.length;he++){const we=t[he],ye=b.useNavieLayout?Fs(h,we):Os(h,we);re.push({index:we.index,name:we.name,top:ee,width:h,height:ye.height,loaded:!0,isMileStone:we.isMileStone,year:we.year}),Q.push(ye),ee+=ye.height}m=Q,a=re,l=ee,$(ee)}function F(){typeof r=="function"&&r({layoutHeight:l,scrollTop:T,loadedSections:m,sectionBounds:a,lastSectionInViewport:f})}function O(){l=v.layoutHeight,m=v.loadedSections,a=v.sectionBounds,f=v.lastSectionInViewport,$(l)}function P(){t.length!==0&&(C&&cancelAnimationFrame(C),C=requestAnimationFrame(()=>{I()}))}function L(){t.length!==0&&(C&&clearTimeout(C),C=setTimeout(()=>{I()},50))}function I(){X(),M(),H(),b.useNativeScrollbar||s.update(a,l),V(),Z(f),z()}function A(){g||(requestAnimationFrame(()=>{T=o.scrollTop,_=o.scrollHeight,N(),b.useNativeScrollbar||s.updateScroll(T,_),g=!1,setTimeout(()=>{z()},xa)}),g=!0)}function N(){V(),Z(f)}function z(){F(),j()}function j(){const Q=V(!0),re=Q.map(he=>he.index).toString(),ee=f.map(he=>he.index).toString();re!==ee&&(f=Q,z())}function V(Q){const re=[];let ee=a.length;for(let he=0;he<ee;he++){const we=a[he];kn(we.top,we.height,u,T)&&re.push(we)}return Q||(f=re),re}function q(Q){let re=i.querySelector(`.grid-section[data-index="${Q.index}"]`);if(re||(re=He("div",{className:"grid-section",sectionIndex:Q.index,"data-index":Q.index,style:{top:Q.top+"px",height:Q.height+"px"}}),i.appendChild(re)),Q.loaded){const ee=m[Q.index],he=Ma(Q.top,ee.segmentInfo,u,T),we=[...re.getElementsByClassName("grid-segment")];for(let ye=0;ye<we.length;ye++){const J=we[ye];let le=!1;for(let se=0;se<he.length;se++){const Ce=he[se];if(parseInt(J.dataset.index||"")===Ce){le=!0;break}}le||J.remove()}for(let ye=0;ye<he.length;ye++){const J=he[ye],le=ee.segments[J];if(!re.querySelector(`.grid-segment[data-index="${J}"]`)){const se=He("div",{className:"grid-segment",segmentIndex:J,"data-index":J,style:{top:le.top+"px",left:le.left+"px",width:le.width+"px",height:le.height+"px"}},x(le)),Ce=le.items.length;for(let de=0;de<Ce;de++){const Pe=le.items[de];let be=E(Pe);se.appendChild(be)}re.appendChild(se)}}}}function Z(Q=[]){const re=[...i.getElementsByClassName("grid-section")];for(let ee=0;ee<re.length;ee++){const he=re[ee];let we=!1;for(let ye=0;ye<Q.length;ye++){const J=Q[ye];if(parseInt(he.dataset.index||"")===J.index){we=!0;break}}we||he.remove()}for(let ee=0;ee<Q.length;ee++){const he=Q[ee];q(he)}}function R(Q=0){p.style.width=Q+"px"}function $(Q=0){i.style.height=Q+"px"}function X(){i.innerHTML=""}function U(){t=[],m=[],a=[],b.useNativeScrollbar||s.update(a,0)}function Y(Q){Q.length>0?(Hs(o),o.appendChild(D()),t=Q,I(),b.useNativeScrollbar||(s.getContainerInfo(),s.update(a,l)),o.scrollTop=T):(U(),o.innerHTML="",n instanceof HTMLElement&&o.appendChild(n),$(u-yt),b.useNativeScrollbar||s.update([],0))}function W(Q){const{sectionName:re,sections:ee}=Q;t=ee;const he=a.find(se=>se.name===re);if(!he)return;let we;b.useNavieLayout?we=Fs(h,t[he.index]):we=Os(h,t[he.index]);let ye=he.height-we.height;a[he.index].height=we.height,m[he.index]=we;let J=a.length;for(let se=he.index+1;se<J;se++)a[se].top-=ye;l-=ye,$(l),V();let le=f.length;for(let se=0;se<le;se++){const Ce=f[se];let de=i.querySelector(`.grid-section[data-index="${Ce.index}"]`);de instanceof HTMLElement&&de.remove()}Z(f),b.useNativeScrollbar||(s.getContainerInfo(),s.update(a,l))}function te(){b.useNativeScrollbar||s.destroy(),b.resizeSmooth?y.removeEventListener("resize",P,!1):y.removeEventListener("resize",L,!1)}function _e(){b.useNativeScrollbar||s.getContainerInfo()}return{element:k,update:Y,updateItem:W,recalculateLayout:I,updateScrollbar:_e,destroy:te}}function ai(e){let c,v,b,y=!1,E=e.options.find(t=>t.value===e.value),x=[];function r(t){E=t,c.textContent=t.text,e.onChange&&e.onChange(t),u(),m()}const n=e.value&&G(E)?E.text:"Select",l=e.options.map(t=>{const i=t.value===e.value,s=w("div",{className:"select-option"+(i?" selected":""),onclick:r.bind(null,t)},[w("div",{className:"select-option-decorator"}),w("div",{className:"select-option-label"},t.text)]);return x.push({id:t.value,element:s}),s});v=w("div",{className:"select-options"},l);function m(){v.classList.remove("show"),y=!1,b.classList.remove("show"),document.removeEventListener("click",a,!1),window.removeEventListener("touchstart",h,!1)}function a(t){t.target!==b&&!b.contains(t.target)&&m()}function h(t){t.target!==b&&!b.contains(t.target)&&m()}function u(){x.forEach(t=>{t.element.classList.remove("selected"),E&&t.id===E.value&&t.element.classList.add("selected")})}function d(){y=!y,b.classList[y?"add":"remove"]("show"),y&&(u(),document.addEventListener("mousedown",a,!1),window.addEventListener("touchstart",h,!1)),v.classList.toggle("show")}b=w("div",{className:"select"+(e.noBackground?" no-background":"")},[w("div",{className:"select-placeholder flex items-center",onclick:d},[c=w("div",{className:"select-placeholder-text flex-1"},n),w("div",{className:"select-placeholder-icon",innerHTML:Zs})]),v=w("div",{className:"select-options"},l)]);function f(t){const i=e.options.find(s=>s.value===t);i&&r(i)}return{element:b,setValue:f}}const En="imgs/apps/photos/",Ra=En+"Thumbnails/",Aa=e=>{if(G(e)){v(e);return}const c=b=>{const y=window.photoData;let E,x,r,n;x=w("div",{className:"app-photos w-full h-full standard-content"},w("div",{className:"w-full h-full flex flex-col theme-background"},[w("div",{className:"photos-app-toolbar flex items-center"},[w("div",{className:"photos-app-toolbar-col flex-1"},[w("div",{className:"photos-app-toolbar-nav flex items-center"},[w("div",{className:"photos-app-toolbar-nav-item active"},"Collection"),w("div",{className:"photos-app-toolbar-nav-item"},"Albums"),w("div",{className:"photos-app-toolbar-nav-item"},"Folders")])]),w("div",{className:"photos-app-toolbar-col flex-1 flex content-center"},Ti({placeholder:"Search photos or things..."}).element),w("div",{className:"photos-app-toolbar-col photos-app-toolbar-actions flex-1 flex content-end"},[w("div",{className:"photos-app-toolbar-action flex items-center"},[w("div",{className:"photos-app-toolbar-action-icon",innerHTML:Or(20)}),w("div",{className:"photos-app-toolbar-action-text"},"New")]),w("div",{className:"photos-app-toolbar-action flex items-center"},[w("div",{className:"photos-app-toolbar-action-icon",innerHTML:Pr(20)}),w("div",{className:"photos-app-toolbar-action-text"},"Select")]),w("div",{className:"photos-app-toolbar-action flex items-center"},[w("div",{className:"photos-app-toolbar-action-icon",innerHTML:Hr(20)}),w("div",{className:"photos-app-toolbar-action-text"},"Import")])])]),r=w("div",{className:"photos-app-content w-full"})])),b.addEventListener("secondInstance",h=>{b.isVisible()||b.show(),b.focus(),v(h)}),b.addEventListener("dragend",()=>{G(E)&&E.updateScrollbar()}),b.addEventListener("ready",()=>{nt(r,l()),E=Ba(n,y,null,{},b,m,a,()=>{})}),b.addEventListener("restore",()=>{E.recalculateLayout()}),b.addEventListener("snap",()=>{E.recalculateLayout()});function l(){return w("div",{className:"w-full h-full"},[w("div",{className:"photos-app-grid-header flex items-center w-full"},[w("div",{className:"flex items-center flex-1"},[w("div",{className:"flex-shrink-0",style:{marginRight:"10px"}},"View By"),ai({value:"datetaken",options:[{text:"Date taken",value:"datetaken"},{text:"Recently added",value:"recentlyadded"}]}).element]),w("div",{className:"flex items-center flex-1"})]),n=w("div",{className:"photos-app-grid w-full"})])}function m(h){const u=window.encodeURI(Ra+h.name),d=window.encodeURI(En+h.name);let f={};return h.name&&(f.backgroundImage=`url('${u}')`),w("div",{title:h.name,className:"grid-item",style:{top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px"}},[w("div",{className:"grid-item-content w-full h-full",style:f,onclick:()=>{v(d)}})])}function a(h){return w("div",{className:"segment-heading flex items-center"},w("div",{className:"segment-heading-inner flex items-center full-height"},w("div",{title:h.name,className:"segment-heading-text text-ellipsis line-clamp-1"},h.name)))}return x};function v(b){G(b)&&Fe("photoViewer",b)}lt({args:e,icon:ie.photos.icon,hideIcon:!0,name:ie.photos.name,title:ie.photos.productName,top:100,left:100,width:980,height:585,center:!0,fluidContent:!0,singleInstance:!0,transprencyContent:!0,content:c})},li={system:{icon:"imgs/icons/Desktop.png",iconType:"image",text:"System",items:{display:{icon:"",text:"Display",desc:"Monitors, brightness, nightlight, display profile"},sound:{icon:"",text:"Sound",desc:"Volume levels, ouput, input sound devices"},noitification:{icon:"",text:"Noitification",desc:"Alerts from apps and system"},focusAssist:{icon:"",text:"Focus Assist",desc:"Notifications, automatic rules"},powerAndBatery:{icon:"",text:"Power & batery",desc:"Sleep, batery usage, batery saver"},storage:{icon:"",text:"Storage",desc:"View storage usage on driver"},troubleshoot:{icon:"",text:"Troubleshoot",desc:"Recommended troubleshooters, preferences, history"},recovery:{icon:"",text:"Recovery",desc:"Reset, advanced startup, go back"}}},bluetoothAndDevice:{icon:"imgs/icons/Misc/Bluetooth.png",text:"Bluetooth & Devices"},networkAndInternet:{icon:"imgs/icons/Misc/wifi.png",text:"Network & Intenet"},personalization:{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalization",items:{background:{icon:"",text:"Background",desc:"Change desktop background image"},colors:{icon:"",text:"Colors",desc:"Accent color, transparency, dark theme"},lockScreen:{icon:"",text:"Lock Screen",desc:"Background image, notifications"},theme:{icon:"",text:"Themes",desc:"Customize window theme"},font:{icon:"",text:"Fonts",desc:"Browser installed fonts or install new fonts"},start:{icon:"",text:"Start",desc:"Pinned apps, remommended"},taskbar:{icon:"",text:"Taskbar",desc:"Taskbar arrangement, position"}}},apps:{icon:"imgs/icons/Misc/15.png",text:"Apps"},accounts:{icon:"imgs/icons/Users.png",iconType:"image",text:"Accounts"},timeAndLanguage:{icon:"imgs/icons/Misc/Time And Language.png",text:"Time & Language"},gaming:{icon:"imgs/icons/Misc/Gaming.png",text:"Gaming"},accessibility:{icon:"imgs/icons/Help.png",text:"Accessibility"},privacyAndSecurity:{icon:"imgs/icons/Security.png",text:"Privacy & Security"},windowUpdate:{icon:"imgs/icons/Emblems/1401.png",text:"Window Update"}},zs=Object.keys(li).map((e,c)=>{const v=li[e];let b=Object.create(null);return b={name:e,icon:v.icon,text:v.text},c===0&&(b.active=!0),b});function Na(e){return w("label",{className:"button "+(e.className||"")},[w("input",{type:"file",accept:e.accept||"",className:"button "+(e.className||""),style:{display:"none"},onchange:e.onChange}),e.children])}function ft(e){return w("div",{className:"setting-nav-row flex flex-wrap"+(e.hasIcon?" has-icon":"")},[w("div",{className:"setting-nav-row-left flex-1"+(G(e.contentCenter)||G(e.itemsCenter)?" flex":"")+(e.contentCenter?" content-center":"")+(e.itemsCenter?" items-center":"")},e==null?void 0:e.contentLeft),w("div",{className:"setting-nav-row-right flex-shrink-0"},e==null?void 0:e.contentRight)])}function Qe(e,c){let v=!1,b,y,E;function x(){if(e.isNav){c(e.path);return}v=!v,b.classList[v?"add":"remove"]("expanded"),y.classList[v?"add":"remove"]("show"),E.classList[v?"add":"remove"]("rotate"),y.scrollIntoView()}b=w("div",{className:"setting-nav-item"+(e.isNav?"":" no-hover"),onclick:e.isNav?c.bind(null,e.path):null},[w("div",{className:"setting-nav-item-header flex"},[e.icon?w("div",{className:"setting-nav-item-icon flex items-center content-center flex-shrink-0",innerHTML:e.icon}):null,w("div",{className:"setting-nav-item-info flex-1 flex flex-col content-center"},[w("div",{className:"setting-nav-item-name flex items-center"},e.text),e.desc?w("div",{className:"setting-nav-item-desc flex items-center"},e.desc):null]),e.control?w("div",{className:"setting-nav-item-control flex items-center"},e.control):null,E=w("div",{className:"setting-nav-item-icon setting-nav-item-icon-more flex items-center content-center flex-shrink-0",innerHTML:jt,onclick:n=>{n.stopPropagation(),x()}})]),e.isNav?null:y=w("div",{className:"setting-nav-item-content"},e.content)]),e.expanded&&x();function r(n){ot(y),Dt(y,n)}return{element:b,setContent:r}}function ds(e,c){return w("div",{className:"setting-nav-list"},e.map(v=>Qe(v,c).element))}function Pa(e,c,v){return w("div",{className:"setting-group"},[w("div",{className:"setting-label"},e),w("div",{className:"setting-items"},ds(c,v))])}function Ha(e){let c,v,b=[];function y(x){e(x)}c=w("div",{className:"settings-recent-images-container"},[w("div",{className:"settings-recent-images-header"},"Recent Images"),v=w("div",{className:"settings-recent-images flex flex-wrap"},E())]);function E(){return xe.getState("recentImages").recentImages.map((r,n)=>{let l=w("div",{key:n,className:"settings-recent-image",onclick:y.bind(null,r)},w("div",{className:"settings-recent-image-inner",style:{myBackgroundImage:r.thumbnailPath}}));return b.push({id:r.path,element:l}),l})}return Ne(ae.backgroundImageChange,"settingRecentImage",()=>{ot(v),Dt(v,E())}),c}function Ln(e){const{themes:c,themeIndex:v,customTheme:b}=xe.getState(["themes","themeIndex","customTheme"]),E=(v>-1?c[v]:b).backgroundImageStyle,x={};G(e.backgroundImage)&&(x.myBackgroundImage=e.backgroundImage);let r=w("div",{className:"settings-screen-preview",style:x},w("div",{className:"settings-screen-preview-inner"},[w("div",{className:"settings-screen-preview-taskbar"}),w("div",{className:"settings-screen-preview-card"},[w("div",{className:"settings-screen-preview-card-placeholder"},[w("div",{className:"settings-screen-preview-card-placeholder-line"}),w("div",{className:"settings-screen-preview-card-placeholder-line"}),w("div",{className:"settings-screen-preview-card-placeholder-line"}),w("div",{className:"settings-screen-preview-card-placeholder-line half"})]),w("div",{className:"settings-screen-preview-card-button"})])]));Ki(r,E);function n(m){r.style.myBackgroundImage=m}function l(m){Ki(r,m)}return{element:r,changeBackground:n,setBackgroundStyle:l}}function Oa(){const{themeIndex:e,themes:c,customTheme:v}=xe.getState(["themeIndex","themes","customTheme"]),y=(e>-1?c[e]:v).background,E=Ln({});let x,r;x=ai({options:[{id:"solid",text:"Solid Color",value:"solid"},{id:"slideshow",text:"Slideshow",value:"slideshow"},{id:"picture",text:"Picture",value:"picture"}],value:"picture",onChange:d=>{r.setContent(m(d.value))}});function n(d){const t=d.target.files[0];if(!t)return;const i=URL.createObjectURL(t),s=rt.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/",o=s+t.name,p=s+"Thumbnails/"+t.name;me.writeFile(s+t.name,t,g=>{g||as(i,(C,T)=>{me.writeFile(p,T,_=>{if(!_){const k={name:t.name,path:o,thumbnailPath:p};Ue.setBackgroundImage(k),E.changeBackground(C)}})})})}function l(){const{themeIndex:d,themes:f,customTheme:t}=xe.getState(["themeIndex","themes","customTheme"]),s=(d>-1?f[d]:t).backgroundImageStyle;return[ft({contentLeft:Ha(u)}),ft({contentLeft:"Choose a photo",contentRight:Na({accept:"image/png, image/jpeg",children:"Choose a photo",onChange:n}),itemsCenter:!0}),ft({contentLeft:"Choose a fit for your desktop image",contentRight:ai({options:[{id:"fill",text:"Fill",value:"fill"},{id:"fit",text:"Fit",value:"fit"},{id:"stretch",text:"Stretch",value:"stretch"},{id:"center",text:"Center",value:"center"},{id:"tile",text:"Tile",value:"tile"},{id:"span",text:"Span",value:"span"}],value:s.toLowerCase(),onChange:o=>{E.setBackgroundStyle(o.value),Ue.setBackgroundStyle(o.value),pt({backgroundImageStyle:o.text})}}).element,itemsCenter:!0})]}function m(d){switch(d){case"solid":return ft({contentLeft:"Solid Color"});case"slideshow":return ft({contentLeft:"Slideshow"});case"picture":return l()}return""}r=Qe({name:"background",text:"Personalize your Background",icon:"",desc:"A picture background applies to your current desktop. Solid color or slideshow background apply to all your desktops.",path:"background",control:x.element,expanded:!0,content:l()});let a=w("div",{className:"setting-system flex flex-wrap"},[w("div",{className:"w-full background-selector"},[E.element,r.element,Pa("Related Settings",[{name:"contras theme",text:"Contrast Theme",icon:"",desc:"Color themes for low vision light sensitvity",path:"contras theme"}])])]);h(y);function h(d){E.changeBackground(d.thumbnailPath)}function u(d){h(d),Ue.setBackgroundImage(d)}return{element:a,dispose:()=>{}}}function Fi(e,c,v){let b,y;function E(l){const m=l.target;typeof v=="function"&&v(m.checked),x(m.checked)}function x(l){r.classList[l?"add":"remove"]("checked"),y.innerHTML=l?Cr:""}const r=w("div",{className:"checkbox"},w("label",{className:"flex items-center"},[b=w("input",{type:"checkbox",style:{display:"none"},checked:c,onchange:E}),y=w("div",{className:"checkbox-mark flex items-center content-center"}),w("div",{className:"checkbox-label"},e)]));x(c);function n(l){b.checked=l,x(l)}return{element:r,setChecked:n}}function Fa(e){let c,v,b,y=0;function E(u){b=c.getBoundingClientRect(),y=a(u.clientX),h(y),document.addEventListener("mousemove",r,!1),document.addEventListener("mouseup",l,!1),e!=null&&e.onChange&&e.onChange(y),e!=null&&e.onDidChange&&e.onDidChange(y)}function x(u){b=c.getBoundingClientRect(),y=a(u.touches[0].clientX),h(y),window.addEventListener("touchmove",n,!1),window.addEventListener("touchend",m,!1),e!=null&&e.onChange&&e.onChange(y),e!=null&&e.onDidChange&&e.onDidChange(y)}function r(u){u.clientX<b.left||u.clientX>b.left+b.width||(y=a(u.clientX),h(y),e!=null&&e.onChange&&e.onChange(y))}function n(u){const d=u.touches[0];d.clientX<b.left||d.clientX>b.left+b.width||(y=a(d.clientX),h(y),e!=null&&e.onChange&&e.onChange(y))}function l(){e!=null&&e.onDidChange&&e.onDidChange(y),document.removeEventListener("mousemove",r,!1),document.removeEventListener("mouseup",l,!1)}function m(){e!=null&&e.onDidChange&&e.onDidChange(y),window.removeEventListener("touchmove",n,!1),window.removeEventListener("touchend",m,!1)}c=w("div",{className:"hue-picker",style:{position:"relative",width:"360px",height:"30px"},onmousedown:E,ontouchstart:x},v=w("div",{className:"hue-picker-mark"}));function a(u=0){return u-b.left}function h(u=0){v.style.left=u-1+"px"}return{element:c,setValue:h}}function ci(e){let c=!1,v;v=w("div",{className:"toggle",onclick:()=>{b(),e.onChange&&e.onChange(c)}},[w("div",{className:"toggle-button"}),w("div",{className:"toggle-indicator"}),e.showLabel?w("div",{className:"toggle-label"},e.label):null]),y(e.checked);function b(){c=!c,v.classList.toggle("checked",c)}function y(E){c=E,v.classList.toggle("checked",c)}return{element:v,get checked(){return c},set checked(E){y(E)}}}const pi="setting-color";function za(){let{themes:e,themeIndex:c,customTheme:v}=xe.getState(["themes","themeIndex","customTheme"]);const b=c>-1?e[c]:v,{useTitleBarAccentColor:y,useTaskbarAndStartMenuAccentColor:E,useWindowBorderAccentColor:x,accentColor:r,transparency:n,dark:l}=b;let m=ci({label:"Dark Theme",checked:l,onChange:i=>{ls(i)}}),a=ci({label:"Dark Theme",checked:n,onChange:i=>{cs(i)}}),h=Fa({onChange:d,onDidChange:f}),u=w("div",{className:"setting-personalization-colors"},[Qe({name:"darktheme",text:"Dark Theme",icon:"",desc:"Dark theme for all windows",path:"personalization/colors/darktheme",control:m.element}).element,Qe({name:"transparency",text:"Transparency",icon:"",desc:"Transparency for all windows",path:"personalization/colors/transparency",control:a.element}).element,Qe({name:"accentColor",text:"Accent Color",icon:"",desc:"Choose your accent color",path:"personalization/colors/accentColor",expanded:!0,content:ft({contentLeft:w("div",null,h.element)})}).element,Qe({name:"showAccentColor",text:"Show Accent Color",icon:"",expanded:!0,desc:"Show accent color on the following surfaces",path:"personalization/colors/showAccentColor",content:ft({contentLeft:[w("div",null,Fi("Window Titlebar",y,i=>{Wt("use-titlebar-accent-color",i),pt({useTitleBarAccentColor:i})}).element),w("div",null,Fi("Start menu, Taskbar,...",E,i=>{Wt("use-startmenu-and-taskbar-accent-color",i),pt({useTaskbarAndStartMenuAccentColor:i})}).element),w("div",null,Fi("Window Borders",x,i=>{Wt("use-window-border-accent-color",i),pt({useWindowBorderAccentColor:i})}).element)]})}).element]);h.setValue(r.h);function d(i){mn({h:i,s:b.dark?100:70,l:b.dark?60:50},!1)}function f(i){pt({accentColor:{h:i,s:b.dark?100:70,l:b.dark?60:50}})}Ne(ae.themeChange,pi,i=>{m.checked=i}),Ne(ae.transparentChange,pi,i=>{a.checked=i});function t(){u.remove(),u=null,si(ae.themeChange,pi),si(ae.nightLightChange,pi)}return{element:u,dispose:t}}function Wa(e){const{themes:c,themeIndex:v}=xe.getState(["themes","themeIndex"]);let b=v,y;function E(x,r,n){const{themeIndex:l}=xe.getState(["themeIndex"]);l>-1&&n===b||(b=n,Array.from(y.children).forEach(m=>{m.classList.remove("selected-item")}),x.classList.add("selected-item"),e(r,n))}return Ne(ae.customThemeChange,"quicktheme",()=>{Array.from(y.children).forEach(x=>{x.classList.remove("selected-item")})}),y=w("div",{className:"setting-quick-theme flex",onBeforeRemove(){si(ae.customThemeChange,"quicktheme")}},c.map((x,r)=>w("div",{className:"setting-quick-theme-item"+(r===b?" active selected-item":""),onclick:n=>{E(n.currentTarget,x,r)}},w("div",{className:"setting-quick-theme-item-inner"},[w("div",{className:"setting-quick-theme-item-image",style:{backgroundImage:`url("${x.background.thumbnailPath}")`}}),w("div",{className:"setting-quick-theme-item-color flex items-end content-center",style:{backgroundColor:x.dark?"#333":"#f8f8f8"}},w("div",{className:"setting-quick-theme-item-color-accent",style:{backgroundColor:`hsl(${x.accentColor.h},${x.accentColor.s}%,${x.accentColor.l}%)`}}))])))),y}function $a(e){let c=li.personalization.items,v;v=Object.keys(c).map(f=>{const t=c[f];return{isNav:!0,name:f,text:t.text,icon:t.icon,desc:t.desc,path:"personalization/"+f}});const{roundedCorner:b,useBorder:y,themes:E,themeIndex:x,customTheme:r}=xe.getState(["roundedCorner","useBorder","backgroundImage","themes","themeIndex","customTheme"]),n=x>-1?E[x]:r;qi(b);const l={isNav:!1,name:"roundedCorner",icon:"",text:"Rounded Corner",desc:"Atjust window and controls corner radius",path:"personalization/roundedCorner",control:ci({label:"Rounded Corner",checked:b,onChange:f=>{qi(f),xe.setState({roundedCorner:f})}}).element},m={isNav:!1,name:"useBorder",icon:"",text:"Window Border",desc:"Show window border",path:"personalization/useBorder",control:ci({checked:y,onChange:f=>{fn(f),xe.setState({useBorder:f})}}).element},a=Ln({});function h(f,t,i=!0){gn(f),d(f.background),i&&xe.setState({themeIndex:t})}let u=w("div",{className:"setting-personalization"},[w("div",{className:"w-full flex flex-wrap"},[w("div",{style:{marginTop:"28px",marginRight:"40px"}},a.element),w("div",{className:"flex-1"},[w("div",{style:{height:"26px",fontWeight:"bold",fontSize:"14px"}},"Select a theme to apply"),Wa(h)])]),ds(v,e),Qe(l,e).element,Qe(m,e).element]);d(n.background);function d(f){a.changeBackground(f.thumbnailPath)}return{element:u,dispose:()=>{}}}function Tn(e){return e?w("div",{className:"setting-help flex-shrink-0"},[e.relates&&w("div",{className:"setting-system-help-items"},e.relates.map(c=>{var v;return w("div",{className:"setting-system-help-item",onclick:(v=c.onClick)==null?void 0:v.bind(null,c.name)},[w("div",{className:"setting-system-help-item-label"},c.text),w("div",{className:"setting-system-help-item-content"},c.desc)])})),e.actions&&w("div",{className:"setting-system-help-actions"},[w("div",{className:"setting-system-help-item-label"},"Have a question?"),w("div",{className:"setting-system-help-actions-list"},e.actions.map(c=>{var v;return w("div",{onclick:(v=c.onClick)==null?void 0:v.bind(null,c.name),className:"setting-system-help-item-link"},c.text)}))])]):null}function Ua(){const e=()=>"settings/system/",{nightlight:c,scale:v}=xe.getState(["nightlight","scale"]),b=ci({checked:c,onChange:()=>{ri.toogleNightLight()}}),y=ai({options:[{text:"50%",value:"0.5"},{text:"60%",value:"0.6"},{text:"70%",value:"0.7"},{text:"80%",value:"0.8"},{text:"90%",value:"0.9"},{text:"100%",value:"1"},{text:"120%",value:"1.2"},{text:"150%",value:"1.5"}],value:v,onChange(a){un(a.value),xe.setState({scale:a.value})}});Ne(ae.nightLightChange,"settings-display-nightlight",a=>{b.checked=a});const E=[{path:"",text:"Night light",desc:"Use warmer colors to help block blue light",icon:"",name:"nightlight",control:b.element,content:ft({itemsCenter:!0,contentLeft:"Atjust the color of the screen to help block blue light"})},{path:"",text:"Scale",desc:"Make your display easier to see",icon:"",name:"scale",content:ft({itemsCenter:!0,contentLeft:"Select value",contentRight:y.element}),expanded:!0},{path:"",text:"HDR",desc:"More about HDR",icon:"",name:"nightlight"}],x=Qe(E[0]),r=Qe(E[1]),n=Qe(E[2]);let l=w("div",{className:"setting-system-display flex flex-wrap",onBeforeRemove(){si(ae.nightLightChange,"settings-display-nightlight")}},[w("div",{className:"flex-1"},w("div",{className:"setting-system-main-content"},[x.element,vn()?r.element:null,n.element])),Tn({relates:[{name:e()+"nightlight",text:"Sleep better",desc:"Nightlight can help you get to sleep by displaying warmer colors at night. Select Night light settings to set things up."}],actions:[{name:"",text:"Changing screen brightness",desc:""},{name:"",text:"Adjusting font size",desc:""}]})]);function m(){l.remove(),l=null}return{element:l,dispose:m}}function ja(e){return w("button",{className:"button "+(e.className||""),onclick:e.onclick},e.children)}function Va(){let e=w("div",{className:"setting-recovery"},[w("div",{},"If you're having problems with your PC or want to reset it, these recovery options might help"),w("div",{},[Qe({path:"",text:"Reset this PC",desc:"Choose or keep your personal files, then reinstall Windows",icon:"",name:"recovery",control:ja({children:"Reset PC",onclick(){Xo()}})}).element])]);function c(){e=null}return{element:e,dispose:c}}function Ka(){const{themes:e,themeIndex:c,customTheme:v}=xe.getState(["themes","themeIndex","customTheme"]),y=(c>-1?e[c]:v).background;let E;const{USER_NAME:x}=rt.getState("USER_NAME");let r=w("div",{className:"setting-system-overall",onBeforeRemove(){si(ae.backgroundImageChange,"setting-system")}},[w("div",{className:"flex"},[w("div",{className:"setting-system-desktop relative"},E=w("div",{className:"setting-system-desktop-inner image-cover"})),w("div",{className:"setting-system-info"},[w("div",{className:"setting-system-info-name"},`${x}`),w("div",{className:"setting-system-info-role"},"Administrator"),w("div",{className:"setting-system-info-action"},"Rename")])]),w("div",{className:"setting-system-office flex"},[w("div",{className:"setting-system-office-onedrive flex"},[w("div",{className:"setting-system-office-onedrive-icon flex items-center content-center"}),w("div",{className:"setting-system-office-onedrive-info"},[w("div",{className:"setting-system-office-onedrive-info-name"},"OneDrive"),w("div",{className:"setting-system-office-onedrive-info-action"},"Manage")])])])]);y&&n(y.path),Ne(ae.backgroundImageChange,"setting-system",l=>{n(l.path)});function n(l){E.style.myBackgroundImage=l}return r}function qa(e){let c=li.system.items,v;v=Object.keys(c).map(E=>{const x=c[E];return{isNav:!0,name:E,text:x.text,icon:x.icon,iconType:x.iconType,desc:x.desc,path:"system/"+E}});let b=w("div",{className:"setting-system flex flex-wrap"},[w("div",{className:"flex-1"},w("div",{className:"setting-system-main-content"},[Ka(),ds(v,e)])),Tn()]);function y(){b.remove(),b=null}return{element:b,dispose:y}}function Oe(){let e=w("div",{},"In progress");function c(){e.remove(),e=null}return{element:e,dispose:c}}const Xa={system:{content:qa,children:{display:{content:Ua},sound:{content:Oe},noitification:{content:Oe},focusAssist:{content:Oe},powerAndBatery:{content:Oe},storage:{content:Oe},troubleshoot:{content:Oe},recovery:{content:Va}}},bluetoothAndDevice:{content:Oe},networkAndInternet:{content:Oe},personalization:{content:$a,children:{background:{content:Oa},colors:{content:za},lockScreen:{content:Oe},theme:{content:Oe},font:{content:Oe},start:{content:Oe},taskbar:{content:Oe}}},apps:{content:Oe},accounts:{content:Oe},timeAndLanguage:{content:Oe},gaming:{content:Oe},accessibility:{content:Oe},privacyAndSecurity:{content:Oe},windowUpdate:{content:Oe}};function Ga(e,c,v){let b=w("div",{className:"setting-sidebar-nav-item flex items-center"+(e.active?" active":""),onclick:()=>v(e,b,c)},[w("div",{className:"setting-sidebar-nav-item-icon flex-shrink-0",style:{backgroundImage:`url("${e.icon}")`}}),w("div",{className:"setting-sidebar-nav-item-text"},e.text)]);return b}function Ya(e){const c=zs.map((n,l)=>Ga(n,l,x));let v=0,b=c[0];b.classList.add("active");let y=Ti({placeholder:"Find a Setting"}),E=w("div",{className:"setting-sidebar h-full flex-shrink-0"},w("div",{className:"setting-sidebar-inner standard-content w-full h-full"},w("div",{className:"w-full h-full flex flex-col"},[w("div",{className:"setting-sidebar-heading"},y.element),w("div",{tabIndex:0,className:"setting-sidebar-nav scrollable scroll-y"},c)])));function x(n,l,m){m!==v&&(b.classList.remove("active"),l.classList.add("active"),v=m,b=l,e(n.name))}function r(n){const l=n.split("/")[0];if(l){const m=zs.findIndex(a=>a.name===l);if(m>-1){b.classList.remove("active");let a=c[m];v=m,a.classList.add("active"),b=a}}}return{element:E,setRoute:r}}function Za(e){let c;const v=w("div",{className:"setting-content-heading flex-shrink-0 flex items-center"},c=w("div",{className:"setting-content-heading-item"},"System"));function b(y){const E=w("div",{className:"w-full flex items-center"},y.map((x,r)=>{let n=w("div",{className:"setting-content-heading-route flex items-center"+(r===y.length-1&&r>0?" disabled":""),onclick:y.length-1?e.bind(null,x.path):null},x.text);return r>0&&n.prepend(w("div",{className:"setting-content-heading-route-divider flex-center",innerHTML:jt})),n}));c.innerHTML="",c.appendChild(E)}return{element:v,setRoute:b}}function Ja(e){let c;const v=Za(e);let b,y=w("div",{className:"setting-content w-full h-full"},w("div",{className:"setting-content-inner standard-content w-full h-full flex flex-col"},[v.element,b=w("div",{tabIndex:0,className:"setting-content-main scrollable scroll-y"})]));function E(x){const r=x.split("/"),n=r.length;if(n===0)return;let l=Xa[r[0]];if(!l)return;c&&c.dispose();let m;n===1?m=l.content(e):n===2&&(m=l.children[r[1]].content(e)),c=m;const a=r.reduce((h,u,d)=>(h.path+=u,h.currentSetting=d===0?li[u]:h.currentSetting.items[u],h.routes.push({text:h.currentSetting.text,path:h.path}),d<n-1&&(h.path+="/"),h),{routes:[],path:"",currentSetting:Object.create(null)});v.setRoute(a.routes),ot(b),b.scrollTop=0,b.appendChild(m.element)}return{element:y,update:E}}const Qa=e=>{const c=function(b){let y=Ya(r),E=Ja(r);function x(n){y.setRoute(n),E.update(n)}e?x(e):E.update("system"),b.addEventListener("secondInstance",n=>{b.isVisible()||b.show(),b.focus(),n&&x(n)});function r(n){E.update(n)}return w("div",{className:"app-settings w-full h-full"},w("div",{className:"setting-inner flex w-full h-full"},[y.element,E.element]))},v=w("div",{className:"w-full h-full flex items-center"},[w("div",{["drag-region"]:"drag",className:"flex-1 h-full"}),w("div",{className:"setting-user-info-avatar",style:{padding:"6px"}},w("div",{className:"setting-user-info-avatar-image w-full h-full",style:{marginLeft:"auto",backgroundImage:`url("${gr}")`,backgroundSize:"cover"}}))]);lt({args:e,icon:ie.settings.icon,name:ie.settings.name,title:ie.settings.productName,singleInstance:!0,titlebarHeight:36,titlebarContent:v,top:200,left:300,minWidth:700,minHeight:400,width:1e3,height:540,center:!0,fluidContent:!0,transprencyContent:!0,content:c})};function el(e){const y=is("calculator",{top:50,left:ke.width-380-50});let{top:E,left:x}=y.getState();E>ke.height-We-Mt&&(E=50),x>ke.width-380-50&&(x=ke.width-380-50);let r,n;const l=ai({options:[{id:"standard",value:"standard",text:"Standard"},{id:"scientific",value:"scientific",text:"Scientific"},{id:"programmer",value:"programmer",text:"Programmer"}],value:"standard",noBackground:!0,onChange(f){m(f.value),r.setContent(n)}});r=lt({icon:ie.calculator.icon,name:ie.calculator.name,title:ie.calculator.productName,titlebarHeight:36,titlebarContent:l.element,top:E,left:x,width:380,height:500,disableResize:!0,disableMaximize:!0,transprencyContent:!0}),r.addEventListener("dragend",f=>{y.setState({top:f.top,left:f.left})}),r.addEventListener("focus",()=>{n.focus()}),m("standard"),r.setContent(n);function m(f){switch(f){case"standard":n=h();break;case"scientific":n=u();break;case"programmer":n=d();break;default:n=h();break}}function a(f,t){const i={};return f.type==="command"&&f.value==="="&&(i.color="var(--accent-color)"),w("div",{className:"calculator-button flex flex-1 items-center content-center"+(f.type==="number"?" emphasis":""),onclick:t.bind(null,f.type,f.value),innerHTML:f.content,style:i})}function h(){let f,t,i,s="",o="",p="",g=48;function C(){let O;const P=parseFloat(s);let L=parseFloat(o);if(!(isNaN(P)||isNaN(L))){switch(p){case"+":O=P+L;break;case"-":O=P-L;break;case"x":O=P*L;break;case"/":O=P/L;break}o=O.toString(),p=null,s=""}}function T(){s="",p="",_()}function _(){o="0",t.style.removeProperty("font-size")}function k(O){const P=O.toString(),L=parseFloat(P.split(".")[0]),I=P.split(".")[1];let A;return isNaN(L)?A="":A=L.toLocaleString("en",{maximumFractionDigits:0}),I!=null?`${A}.${I}`:A}function D(O){O==="."&&o.includes(".")||(o=o.toString()+O.toString())}function M(O){o!==""&&(s!==""&&C(),p=O,s=o,o="")}function S(O){t.scrollWidth>t.offsetWidth&&(O-=2,t.style.fontSize=O+"px",S(O))}function B(){f.textContent=k(parseFloat(o)),S(g),G(p)?i.textContent=`${k(parseFloat(s))} ${p}`:i.textContent=""}function H(O,P){if(O==="number")D(P),B();else if(O==="operator")M(P),B();else if(O==="command"){switch(P){case"c":T();break;case"ce":_();break;case"=":C();break;case"sqrt":o=Math.sqrt(parseFloat(o)).toString();break;case"negative":o=(parseFloat(o)*-1).toString();break}B()}}function F(O){let P=/[0-9]/g,L=/[+\-*\/]/g;O.key.match(P)&&(O.preventDefault(),D(O.key),B()),O.key==="."&&(O.preventDefault(),D(O.key),B()),O.key.match(L)&&(O.preventDefault(),M(O.key),B()),(O.key==="Enter"||O.key==="=")&&(O.preventDefault(),C(),B()),O.key==="Backspace"&&(O.preventDefault(),_(),B()),O.key==="Delete"&&(O.preventDefault(),T(),B())}return w("div",{tabIndex:-1,className:"w-full h-full flex flex-col",onkeydown:F},[w("div",{className:"w-full calculator-display flex flex-col"},[i=w("div",{className:"calculator-display-input flex items-center content-end"}),t=w("div",{className:"calculator-display-result flex-1 flex items-center content-end no-scrollbar"},f=w("div",{className:"w-full"},"0"))]),w("div",{className:"w-full h-full calculator-buttons flex flex-col"},[w("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"command",value:"sqrt",content:'<svg class="svg-icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M277.7 843.7h-35.6L93.6 483.2h-76V445h105.6l132.6 330.4 159.6-635.1h37.8L277.7 843.7zM831.6 773.7L697.7 578.8 563.4 773.7h-45.1l155.4-223.6-148.1-212.5h46.8l125.3 183.7 124.9-183.7h47.2L722.2 549.2l157.1 224.4h-47.7z"  /><path d="M984.5 176h-568v-37.1h568V176z"  /></svg>'},H),a({type:"command",value:"ce",content:"CE"},H),a({type:"command",value:"c",content:"C"},H),a({type:"operator",value:"/",content:"/"},H)]),w("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"7",content:"7"},H),a({type:"number",value:"8",content:"8"},H),a({type:"number",value:"9",content:"9"},H),a({type:"operator",value:"x",content:"&#215;"},H)]),w("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"4",content:"4"},H),a({type:"number",value:"5",content:"5"},H),a({type:"number",value:"6",content:"6"},H),a({type:"operator",value:"-",content:"&#8722;"},H)]),w("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"1",content:"1"},H),a({type:"number",value:"2",content:"2"},H),a({type:"number",value:"3",content:"3"},H),a({type:"operator",value:"+",content:"+"},H)]),w("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"command",value:"negative",content:"+/-"},H),a({type:"number",value:"0",content:"0"},H),a({type:"number",value:".",content:"."},H),a({type:"command",value:"=",content:"="},H)])])])}function u(){return w("div",{className:"w-full h-full flex content-center items-center"},w("h1",{},"Scientific Calculator"))}function d(){return w("div",{className:"w-full h-full flex content-center items-center"},w("h1",{},"Programmer Calculator"))}}var Zi={},tl={get exports(){return Zi},set exports(e){Zi=e}};(function(e,c){(function(v,b){e.exports=b()})(self,()=>(()=>{var v={4567:function(x,r,n){var l=this&&this.__decorate||function(o,p,g,C){var T,_=arguments.length,k=_<3?p:C===null?C=Object.getOwnPropertyDescriptor(p,g):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(o,p,g,C);else for(var D=o.length-1;D>=0;D--)(T=o[D])&&(k=(_<3?T(k):_>3?T(p,g,k):T(p,g))||k);return _>3&&k&&Object.defineProperty(p,g,k),k},m=this&&this.__param||function(o,p){return function(g,C){p(g,C,o)}};Object.defineProperty(r,"__esModule",{value:!0}),r.AccessibilityManager=void 0;const a=n(9042),h=n(6114),u=n(9924),d=n(844),f=n(5596),t=n(4725),i=n(3656);let s=r.AccessibilityManager=class extends d.Disposable{constructor(o,p){super(),this._terminal=o,this._renderService=p,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let g=0;g<this._terminal.rows;g++)this._rowElements[g]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[g]);if(this._topBoundaryFocusListener=g=>this._handleBoundaryFocus(g,0),this._bottomBoundaryFocusListener=g=>this._handleBoundaryFocus(g,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new u.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(g=>this._handleResize(g.rows))),this.register(this._terminal.onRender(g=>this._refreshRows(g.start,g.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(g=>this._handleChar(g))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(g=>this._handleTab(g))),this.register(this._terminal.onKey(g=>this._handleKey(g.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new f.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,i.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,d.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(o){for(let p=0;p<o;p++)this._handleChar(" ")}_handleChar(o){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==o&&(this._charsToAnnounce+=o):this._charsToAnnounce+=o,o===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=a.tooMuchOutput)),h.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,h.isMac&&this._liveRegion.remove()}_handleKey(o){this._clearLiveRegion(),/\p{Control}/u.test(o)||this._charsToConsume.push(o)}_refreshRows(o,p){this._liveRegionDebouncer.refresh(o,p,this._terminal.rows)}_renderRows(o,p){const g=this._terminal.buffer,C=g.lines.length.toString();for(let T=o;T<=p;T++){const _=g.translateBufferLineToString(g.ydisp+T,!0),k=(g.ydisp+T+1).toString(),D=this._rowElements[T];D&&(_.length===0?D.innerText=" ":D.textContent=_,D.setAttribute("aria-posinset",k),D.setAttribute("aria-setsize",C))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(o,p){const g=o.target,C=this._rowElements[p===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(p===0?"1":`${this._terminal.buffer.lines.length}`)||o.relatedTarget!==C)return;let T,_;if(p===0?(T=g,_=this._rowElements.pop(),this._rowContainer.removeChild(_)):(T=this._rowElements.shift(),_=g,this._rowContainer.removeChild(T)),T.removeEventListener("focus",this._topBoundaryFocusListener),_.removeEventListener("focus",this._bottomBoundaryFocusListener),p===0){const k=this._createAccessibilityTreeNode();this._rowElements.unshift(k),this._rowContainer.insertAdjacentElement("afterbegin",k)}else{const k=this._createAccessibilityTreeNode();this._rowElements.push(k),this._rowContainer.appendChild(k)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(p===0?-1:1),this._rowElements[p===0?1:this._rowElements.length-2].focus(),o.preventDefault(),o.stopImmediatePropagation()}_handleResize(o){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let p=this._rowContainer.children.length;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);for(;this._rowElements.length>o;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const o=document.createElement("div");return o.setAttribute("role","listitem"),o.tabIndex=-1,this._refreshRowDimensions(o),o}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let o=0;o<this._terminal.rows;o++)this._refreshRowDimensions(this._rowElements[o])}}_refreshRowDimensions(o){o.style.height=`${this._renderService.dimensions.css.cell.height}px`}};r.AccessibilityManager=s=l([m(1,t.IRenderService)],s)},3614:(x,r)=>{function n(h){return h.replace(/\r?\n/g,"\r")}function l(h,u){return u?"\x1B[200~"+h+"\x1B[201~":h}function m(h,u,d,f){h=l(h=n(h),d.decPrivateModes.bracketedPasteMode&&f.rawOptions.ignoreBracketedPasteMode!==!0),d.triggerDataEvent(h,!0),u.value=""}function a(h,u,d){const f=d.getBoundingClientRect(),t=h.clientX-f.left-10,i=h.clientY-f.top-10;u.style.width="20px",u.style.height="20px",u.style.left=`${t}px`,u.style.top=`${i}px`,u.style.zIndex="1000",u.focus()}Object.defineProperty(r,"__esModule",{value:!0}),r.rightClickHandler=r.moveTextAreaUnderMouseCursor=r.paste=r.handlePasteEvent=r.copyHandler=r.bracketTextForPaste=r.prepareTextForTerminal=void 0,r.prepareTextForTerminal=n,r.bracketTextForPaste=l,r.copyHandler=function(h,u){h.clipboardData&&h.clipboardData.setData("text/plain",u.selectionText),h.preventDefault()},r.handlePasteEvent=function(h,u,d,f){h.stopPropagation(),h.clipboardData&&m(h.clipboardData.getData("text/plain"),u,d,f)},r.paste=m,r.moveTextAreaUnderMouseCursor=a,r.rightClickHandler=function(h,u,d,f,t){a(h,u,d),t&&f.rightClickSelect(h),u.value=f.selectionText,u.select()}},7239:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorContrastCache=void 0;const l=n(1505);r.ColorContrastCache=class{constructor(){this._color=new l.TwoKeyMap,this._css=new l.TwoKeyMap}setCss(m,a,h){this._css.set(m,a,h)}getCss(m,a){return this._css.get(m,a)}setColor(m,a,h){this._color.set(m,a,h)}getColor(m,a){return this._color.get(m,a)}clear(){this._color.clear(),this._css.clear()}}},3656:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.addDisposableDomListener=void 0,r.addDisposableDomListener=function(n,l,m,a){n.addEventListener(l,m,a);let h=!1;return{dispose:()=>{h||(h=!0,n.removeEventListener(l,m,a))}}}},6465:function(x,r,n){var l=this&&this.__decorate||function(t,i,s,o){var p,g=arguments.length,C=g<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(t,i,s,o);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(C=(g<3?p(C):g>3?p(i,s,C):p(i,s))||C);return g>3&&C&&Object.defineProperty(i,s,C),C},m=this&&this.__param||function(t,i){return function(s,o){i(s,o,t)}};Object.defineProperty(r,"__esModule",{value:!0}),r.Linkifier2=void 0;const a=n(3656),h=n(8460),u=n(844),d=n(2585);let f=r.Linkifier2=class extends u.Disposable{get currentLink(){return this._currentLink}constructor(t){super(),this._bufferService=t,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,u.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,u.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(t){return this._linkProviders.push(t),{dispose:()=>{const i=this._linkProviders.indexOf(t);i!==-1&&this._linkProviders.splice(i,1)}}}attachToDom(t,i,s){this._element=t,this._mouseService=i,this._renderService=s,this.register((0,a.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,a.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){if(this._lastMouseEvent=t,!this._element||!this._mouseService)return;const i=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!i)return;this._isMouseOut=!1;const s=t.composedPath();for(let o=0;o<s.length;o++){const p=s[o];if(p.classList.contains("xterm"))break;if(p.classList.contains("xterm-hover"))return}this._lastBufferCell&&i.x===this._lastBufferCell.x&&i.y===this._lastBufferCell.y||(this._handleHover(i),this._lastBufferCell=i)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,i){var s,o;this._activeProviderReplies&&i||((s=this._activeProviderReplies)===null||s===void 0||s.forEach(g=>{g==null||g.forEach(C=>{C.link.dispose&&C.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let p=!1;for(const[g,C]of this._linkProviders.entries())i?!((o=this._activeProviderReplies)===null||o===void 0)&&o.get(g)&&(p=this._checkLinkProviderResult(g,t,p)):C.provideLinks(t.y,T=>{var _,k;if(this._isMouseOut)return;const D=T==null?void 0:T.map(M=>({link:M}));(_=this._activeProviderReplies)===null||_===void 0||_.set(g,D),p=this._checkLinkProviderResult(g,t,p),((k=this._activeProviderReplies)===null||k===void 0?void 0:k.size)===this._linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,i){const s=new Set;for(let o=0;o<i.size;o++){const p=i.get(o);if(p)for(let g=0;g<p.length;g++){const C=p[g],T=C.link.range.start.y<t?0:C.link.range.start.x,_=C.link.range.end.y>t?this._bufferService.cols:C.link.range.end.x;for(let k=T;k<=_;k++){if(s.has(k)){p.splice(g--,1);break}s.add(k)}}}}_checkLinkProviderResult(t,i,s){var o;if(!this._activeProviderReplies)return s;const p=this._activeProviderReplies.get(t);let g=!1;for(let C=0;C<t;C++)this._activeProviderReplies.has(C)&&!this._activeProviderReplies.get(C)||(g=!0);if(!g&&p){const C=p.find(T=>this._linkAtPosition(T.link,i));C&&(s=!0,this._handleNewLink(C))}if(this._activeProviderReplies.size===this._linkProviders.length&&!s)for(let C=0;C<this._activeProviderReplies.size;C++){const T=(o=this._activeProviderReplies.get(C))===null||o===void 0?void 0:o.find(_=>this._linkAtPosition(_.link,i));if(T){s=!0,this._handleNewLink(T);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._element||!this._mouseService||!this._currentLink)return;const i=this._positionFromMouseEvent(t,this._element,this._mouseService);i&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,i)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,i){this._element&&this._currentLink&&this._lastMouseEvent&&(!t||!i||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=i)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,u.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(t.link,i)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>{var s,o;return(o=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||o===void 0?void 0:o.decorations.pointerCursor},set:s=>{var o,p;!((o=this._currentLink)===null||o===void 0)&&o.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&((p=this._element)===null||p===void 0||p.classList.toggle("xterm-cursor-pointer",s)))}},underline:{get:()=>{var s,o;return(o=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||o===void 0?void 0:o.decorations.underline},set:s=>{var o,p,g;!((o=this._currentLink)===null||o===void 0)&&o.state&&((g=(p=this._currentLink)===null||p===void 0?void 0:p.state)===null||g===void 0?void 0:g.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,s))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const o=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,p=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=o&&this._currentLink.link.range.end.y<=p&&(this._clearCurrentLink(o,p),this._lastMouseEvent&&this._element)){const g=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);g&&this._askForLink(g,!1)}})))}_linkHover(t,i,s){var o;!((o=this._currentLink)===null||o===void 0)&&o.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),i.hover&&i.hover(s,i.text)}_fireUnderlineEvent(t,i){const s=t.range,o=this._bufferService.buffer.ydisp,p=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-o-1,s.end.x,s.end.y-o-1,void 0);(i?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(p)}_linkLeave(t,i,s){var o;!((o=this._currentLink)===null||o===void 0)&&o.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),i.leave&&i.leave(s,i.text)}_linkAtPosition(t,i){const s=t.range.start.y*this._bufferService.cols+t.range.start.x,o=t.range.end.y*this._bufferService.cols+t.range.end.x,p=i.y*this._bufferService.cols+i.x;return s<=p&&p<=o}_positionFromMouseEvent(t,i,s){const o=s.getCoords(t,i,this._bufferService.cols,this._bufferService.rows);if(o)return{x:o[0],y:o[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,i,s,o,p){return{x1:t,y1:i,x2:s,y2:o,cols:this._bufferService.cols,fg:p}}};r.Linkifier2=f=l([m(0,d.IBufferService)],f)},9042:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.tooMuchOutput=r.promptLabel=void 0,r.promptLabel="Terminal input",r.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(x,r,n){var l=this&&this.__decorate||function(f,t,i,s){var o,p=arguments.length,g=p<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(f,t,i,s);else for(var C=f.length-1;C>=0;C--)(o=f[C])&&(g=(p<3?o(g):p>3?o(t,i,g):o(t,i))||g);return p>3&&g&&Object.defineProperty(t,i,g),g},m=this&&this.__param||function(f,t){return function(i,s){t(i,s,f)}};Object.defineProperty(r,"__esModule",{value:!0}),r.OscLinkProvider=void 0;const a=n(511),h=n(2585);let u=r.OscLinkProvider=class{constructor(f,t,i){this._bufferService=f,this._optionsService=t,this._oscLinkService=i}provideLinks(f,t){var i;const s=this._bufferService.buffer.lines.get(f-1);if(!s)return void t(void 0);const o=[],p=this._optionsService.rawOptions.linkHandler,g=new a.CellData,C=s.getTrimmedLength();let T=-1,_=-1,k=!1;for(let D=0;D<C;D++)if(_!==-1||s.hasContent(D)){if(s.loadCell(D,g),g.hasExtendedAttrs()&&g.extended.urlId){if(_===-1){_=D,T=g.extended.urlId;continue}k=g.extended.urlId!==T}else _!==-1&&(k=!0);if(k||_!==-1&&D===C-1){const M=(i=this._oscLinkService.getLinkData(T))===null||i===void 0?void 0:i.uri;if(M){const S={start:{x:_+1,y:f},end:{x:D+(k||D!==C-1?0:1),y:f}};let B=!1;if(!(p!=null&&p.allowNonHttpProtocols))try{const H=new URL(M);["http:","https:"].includes(H.protocol)||(B=!0)}catch{B=!0}B||o.push({text:M,range:S,activate:(H,F)=>p?p.activate(H,F,S):d(0,F),hover:(H,F)=>{var O;return(O=p==null?void 0:p.hover)===null||O===void 0?void 0:O.call(p,H,F,S)},leave:(H,F)=>{var O;return(O=p==null?void 0:p.leave)===null||O===void 0?void 0:O.call(p,H,F,S)}})}k=!1,g.hasExtendedAttrs()&&g.extended.urlId?(_=D,T=g.extended.urlId):(_=-1,T=-1)}}t(o)}};function d(f,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){const i=window.open();if(i){try{i.opener=null}catch{}i.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}r.OscLinkProvider=u=l([m(0,h.IBufferService),m(1,h.IOptionsService),m(2,h.IOscLinkService)],u)},6193:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.RenderDebouncer=void 0,r.RenderDebouncer=class{constructor(n,l){this._parentWindow=n,this._renderCallback=l,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(n){return this._refreshCallbacks.push(n),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(n,l,m){this._rowCount=m,n=n!==void 0?n:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const n=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,l),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const n of this._refreshCallbacks)n(0);this._refreshCallbacks=[]}}},5596:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ScreenDprMonitor=void 0;const l=n(844);class m extends l.Disposable{constructor(h){super(),this._parentWindow=h,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,l.toDisposable)(()=>{this.clearListener()}))}setListener(h){this._listener&&this.clearListener(),this._listener=h,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var h;this._outerListener&&((h=this._resolutionMediaMatchList)===null||h===void 0||h.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}r.ScreenDprMonitor=m},3236:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Terminal=void 0;const l=n(3614),m=n(3656),a=n(6465),h=n(9042),u=n(3730),d=n(1680),f=n(3107),t=n(5744),i=n(2950),s=n(1296),o=n(428),p=n(4269),g=n(5114),C=n(8934),T=n(3230),_=n(9312),k=n(4725),D=n(6731),M=n(8055),S=n(8969),B=n(8460),H=n(844),F=n(6114),O=n(8437),P=n(2584),L=n(7399),I=n(5941),A=n(9074),N=n(2585),z=n(5435),j=n(4567),V=typeof window<"u"?window.document:null;class q extends S.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(R={}){super(R),this.browser=F,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new H.MutableDisposable),this._onCursorMove=this.register(new B.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new B.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new B.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new B.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new B.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new B.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new B.EventEmitter),this._onBlur=this.register(new B.EventEmitter),this._onA11yCharEmitter=this.register(new B.EventEmitter),this._onA11yTabEmitter=this.register(new B.EventEmitter),this._onWillOpen=this.register(new B.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(a.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(u.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(A.DecorationService),this._instantiationService.setService(N.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows(($,X)=>this.refresh($,X))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport($=>this._reportWindowsOptions($))),this.register(this._inputHandler.onColor($=>this._handleColorEvent($))),this.register((0,B.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,B.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize($=>this._afterResize($.cols,$.rows))),this.register((0,H.toDisposable)(()=>{var $,X;this._customKeyEventHandler=void 0,(X=($=this.element)===null||$===void 0?void 0:$.parentNode)===null||X===void 0||X.removeChild(this.element)}))}_handleColorEvent(R){if(this._themeService)for(const $ of R){let X,U="";switch($.index){case 256:X="foreground",U="10";break;case 257:X="background",U="11";break;case 258:X="cursor",U="12";break;default:X="ansi",U="4;"+$.index}switch($.type){case 0:const Y=M.color.toColorRGB(X==="ansi"?this._themeService.colors.ansi[$.index]:this._themeService.colors[X]);this.coreService.triggerDataEvent(`${P.C0.ESC}]${U};${(0,I.toRgbString)(Y)}${P.C1_ESCAPED.ST}`);break;case 1:if(X==="ansi")this._themeService.modifyColors(W=>W.ansi[$.index]=M.rgba.toColor(...$.color));else{const W=X;this._themeService.modifyColors(te=>te[W]=M.rgba.toColor(...$.color))}break;case 2:this._themeService.restoreColor($.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(R){R?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(j.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(R){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(P.C0.ESC+"[I"),this.updateCursorStyle(R),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var R;return(R=this.textarea)===null||R===void 0?void 0:R.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(P.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const R=this.buffer.ybase+this.buffer.y,$=this.buffer.lines.get(R);if(!$)return;const X=Math.min(this.buffer.x,this.cols-1),U=this._renderService.dimensions.css.cell.height,Y=$.getWidth(X),W=this._renderService.dimensions.css.cell.width*Y,te=this.buffer.y*this._renderService.dimensions.css.cell.height,_e=X*this._renderService.dimensions.css.cell.width;this.textarea.style.left=_e+"px",this.textarea.style.top=te+"px",this.textarea.style.width=W+"px",this.textarea.style.height=U+"px",this.textarea.style.lineHeight=U+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,m.addDisposableDomListener)(this.element,"copy",$=>{this.hasSelection()&&(0,l.copyHandler)($,this._selectionService)}));const R=$=>(0,l.handlePasteEvent)($,this.textarea,this.coreService,this.optionsService);this.register((0,m.addDisposableDomListener)(this.textarea,"paste",R)),this.register((0,m.addDisposableDomListener)(this.element,"paste",R)),F.isFirefox?this.register((0,m.addDisposableDomListener)(this.element,"mousedown",$=>{$.button===2&&(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,m.addDisposableDomListener)(this.element,"contextmenu",$=>{(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),F.isLinux&&this.register((0,m.addDisposableDomListener)(this.element,"auxclick",$=>{$.button===1&&(0,l.moveTextAreaUnderMouseCursor)($,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,m.addDisposableDomListener)(this.textarea,"keyup",R=>this._keyUp(R),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keydown",R=>this._keyDown(R),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keypress",R=>this._keyPress(R),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionupdate",R=>this._compositionHelper.compositionupdate(R))),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,m.addDisposableDomListener)(this.textarea,"input",R=>this._inputEvent(R),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(R){var $;if(!R)throw new Error("Terminal requires a parent element.");R.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=R.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),R.appendChild(this.element);const X=V.createDocumentFragment();this._viewportElement=V.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),X.appendChild(this._viewportElement),this._viewportScrollArea=V.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=V.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=V.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),X.appendChild(this.screenElement),this.textarea=V.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),F.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(g.CoreBrowserService,this.textarea,($=this._document.defaultView)!==null&&$!==void 0?$:window),this._instantiationService.setService(k.ICoreBrowserService,this._coreBrowserService),this.register((0,m.addDisposableDomListener)(this.textarea,"focus",U=>this._handleTextAreaFocus(U))),this.register((0,m.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(o.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(k.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(D.ThemeService),this._instantiationService.setService(k.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(p.CharacterJoinerService),this._instantiationService.setService(k.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(T.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(k.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(U=>this._onRender.fire(U))),this.onResize(U=>this._renderService.resize(U.cols,U.rows)),this._compositionView=V.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(i.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(X);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(C.MouseService),this._instantiationService.setService(k.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(d.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(U=>this.scrollLines(U.amount,U.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(_.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(k.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(U=>this.scrollLines(U.amount,U.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(U=>this._renderService.handleSelectionChanged(U.start,U.end,U.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(U=>{this.textarea.value=U,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(U=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,m.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(f.BufferDecorationRenderer,this.screenElement)),this.register((0,m.addDisposableDomListener)(this.element,"mousedown",U=>this._selectionService.handleMouseDown(U))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(j.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",U=>this._handleScreenReaderModeOptionChange(U))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",U=>{!this._overviewRulerRenderer&&U&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(s.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const R=this,$=this.element;function X(W){const te=R._mouseService.getMouseReportCoords(W,R.screenElement);if(!te)return!1;let _e,Q;switch(W.overrideType||W.type){case"mousemove":Q=32,W.buttons===void 0?(_e=3,W.button!==void 0&&(_e=W.button<3?W.button:3)):_e=1&W.buttons?0:4&W.buttons?1:2&W.buttons?2:3;break;case"mouseup":Q=0,_e=W.button<3?W.button:3;break;case"mousedown":Q=1,_e=W.button<3?W.button:3;break;case"wheel":if(R.viewport.getLinesScrolled(W)===0)return!1;Q=W.deltaY<0?0:1,_e=4;break;default:return!1}return!(Q===void 0||_e===void 0||_e>4)&&R.coreMouseService.triggerMouseEvent({col:te.col,row:te.row,x:te.x,y:te.y,button:_e,action:Q,ctrl:W.ctrlKey,alt:W.altKey,shift:W.shiftKey})}const U={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Y={mouseup:W=>(X(W),W.buttons||(this._document.removeEventListener("mouseup",U.mouseup),U.mousedrag&&this._document.removeEventListener("mousemove",U.mousedrag)),this.cancel(W)),wheel:W=>(X(W),this.cancel(W,!0)),mousedrag:W=>{W.buttons&&X(W)},mousemove:W=>{W.buttons||X(W)}};this.register(this.coreMouseService.onProtocolChange(W=>{W?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(W)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&W?U.mousemove||($.addEventListener("mousemove",Y.mousemove),U.mousemove=Y.mousemove):($.removeEventListener("mousemove",U.mousemove),U.mousemove=null),16&W?U.wheel||($.addEventListener("wheel",Y.wheel,{passive:!1}),U.wheel=Y.wheel):($.removeEventListener("wheel",U.wheel),U.wheel=null),2&W?U.mouseup||($.addEventListener("mouseup",Y.mouseup),U.mouseup=Y.mouseup):(this._document.removeEventListener("mouseup",U.mouseup),$.removeEventListener("mouseup",U.mouseup),U.mouseup=null),4&W?U.mousedrag||(U.mousedrag=Y.mousedrag):(this._document.removeEventListener("mousemove",U.mousedrag),U.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,m.addDisposableDomListener)($,"mousedown",W=>{if(W.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(W))return X(W),U.mouseup&&this._document.addEventListener("mouseup",U.mouseup),U.mousedrag&&this._document.addEventListener("mousemove",U.mousedrag),this.cancel(W)})),this.register((0,m.addDisposableDomListener)($,"wheel",W=>{if(!U.wheel){if(!this.buffer.hasScrollback){const te=this.viewport.getLinesScrolled(W);if(te===0)return;const _e=P.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(W.deltaY<0?"A":"B");let Q="";for(let re=0;re<Math.abs(te);re++)Q+=_e;return this.coreService.triggerDataEvent(Q,!0),this.cancel(W,!0)}return this.viewport.handleWheel(W)?this.cancel(W):void 0}},{passive:!1})),this.register((0,m.addDisposableDomListener)($,"touchstart",W=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(W),this.cancel(W)},{passive:!0})),this.register((0,m.addDisposableDomListener)($,"touchmove",W=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(W)?void 0:this.cancel(W)},{passive:!1}))}refresh(R,$){var X;(X=this._renderService)===null||X===void 0||X.refreshRows(R,$)}updateCursorStyle(R){var $;!(($=this._selectionService)===null||$===void 0)&&$.shouldColumnSelect(R)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(R,$,X=0){var U;X===1?(super.scrollLines(R,$,X),this.refresh(0,this.rows-1)):(U=this.viewport)===null||U===void 0||U.scrollLines(R)}paste(R){(0,l.paste)(R,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(R){this._customKeyEventHandler=R}registerLinkProvider(R){return this.linkifier2.registerLinkProvider(R)}registerCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const $=this._characterJoinerService.register(R);return this.refresh(0,this.rows-1),$}deregisterCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(R)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(R){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+R)}registerDecoration(R){return this._decorationService.registerDecoration(R)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(R,$,X){this._selectionService.setSelection(R,$,X)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var R;(R=this._selectionService)===null||R===void 0||R.clearSelection()}selectAll(){var R;(R=this._selectionService)===null||R===void 0||R.selectAll()}selectLines(R,$){var X;(X=this._selectionService)===null||X===void 0||X.selectLines(R,$)}_keyDown(R){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;const $=this.browser.isMac&&this.options.macOptionIsMeta&&R.altKey;if(!$&&!this._compositionHelper.keydown(R))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;$||R.key!=="Dead"&&R.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const X=(0,L.evaluateKeyboardEvent)(R,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(R),X.type===3||X.type===2){const U=this.rows-1;return this.scrollLines(X.type===2?-U:U),this.cancel(R,!0)}return X.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,R)||(X.cancel&&this.cancel(R,!0),!X.key||!!(R.key&&!R.ctrlKey&&!R.altKey&&!R.metaKey&&R.key.length===1&&R.key.charCodeAt(0)>=65&&R.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(X.key!==P.C0.ETX&&X.key!==P.C0.CR||(this.textarea.value=""),this._onKey.fire({key:X.key,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent(X.key,!0),!this.optionsService.rawOptions.screenReaderMode||R.altKey||R.ctrlKey?this.cancel(R,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(R,$){const X=R.isMac&&!this.options.macOptionIsMeta&&$.altKey&&!$.ctrlKey&&!$.metaKey||R.isWindows&&$.altKey&&$.ctrlKey&&!$.metaKey||R.isWindows&&$.getModifierState("AltGraph");return $.type==="keypress"?X:X&&(!$.keyCode||$.keyCode>47)}_keyUp(R){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1||(function($){return $.keyCode===16||$.keyCode===17||$.keyCode===18}(R)||this.focus(),this.updateCursorStyle(R),this._keyPressHandled=!1)}_keyPress(R){let $;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;if(this.cancel(R),R.charCode)$=R.charCode;else if(R.which===null||R.which===void 0)$=R.keyCode;else{if(R.which===0||R.charCode===0)return!1;$=R.which}return!(!$||(R.altKey||R.ctrlKey||R.metaKey)&&!this._isThirdLevelShift(this.browser,R)||($=String.fromCharCode($),this._onKey.fire({key:$,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent($,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(R){if(R.data&&R.inputType==="insertText"&&(!R.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const $=R.data;return this.coreService.triggerDataEvent($,!0),this.cancel(R),!0}return!1}resize(R,$){R!==this.cols||$!==this.rows?super.resize(R,$):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(R,$){var X,U;(X=this._charSizeService)===null||X===void 0||X.measure(),(U=this.viewport)===null||U===void 0||U.syncScrollArea(!0)}clear(){var R;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let $=1;$<this.rows;$++)this.buffer.lines.push(this.buffer.getBlankLine(O.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(R=this.viewport)===null||R===void 0||R.reset(),this.refresh(0,this.rows-1)}}reset(){var R,$;this.options.rows=this.rows,this.options.cols=this.cols;const X=this._customKeyEventHandler;this._setup(),super.reset(),(R=this._selectionService)===null||R===void 0||R.reset(),this._decorationService.reset(),($=this.viewport)===null||$===void 0||$.reset(),this._customKeyEventHandler=X,this.refresh(0,this.rows-1)}clearTextureAtlas(){var R;(R=this._renderService)===null||R===void 0||R.clearTextureAtlas()}_reportFocus(){var R;!((R=this.element)===null||R===void 0)&&R.classList.contains("focus")?this.coreService.triggerDataEvent(P.C0.ESC+"[I"):this.coreService.triggerDataEvent(P.C0.ESC+"[O")}_reportWindowsOptions(R){if(this._renderService)switch(R){case z.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const $=this._renderService.dimensions.css.canvas.width.toFixed(0),X=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${P.C0.ESC}[4;${X};${$}t`);break;case z.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const U=this._renderService.dimensions.css.cell.width.toFixed(0),Y=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${P.C0.ESC}[6;${Y};${U}t`)}}cancel(R,$){if(this.options.cancelEvents||$)return R.preventDefault(),R.stopPropagation(),!1}}r.Terminal=q},9924:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TimeBasedDebouncer=void 0,r.TimeBasedDebouncer=class{constructor(n,l=1e3){this._renderCallback=n,this._debounceThresholdMS=l,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(n,l,m){this._rowCount=m,n=n!==void 0?n:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l;const a=Date.now();if(a-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=a,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=a-this._lastRefreshMs,u=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},u)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const n=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,l)}}},1680:function(x,r,n){var l=this&&this.__decorate||function(i,s,o,p){var g,C=arguments.length,T=C<3?s:p===null?p=Object.getOwnPropertyDescriptor(s,o):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(i,s,o,p);else for(var _=i.length-1;_>=0;_--)(g=i[_])&&(T=(C<3?g(T):C>3?g(s,o,T):g(s,o))||T);return C>3&&T&&Object.defineProperty(s,o,T),T},m=this&&this.__param||function(i,s){return function(o,p){s(o,p,i)}};Object.defineProperty(r,"__esModule",{value:!0}),r.Viewport=void 0;const a=n(3656),h=n(4725),u=n(8460),d=n(844),f=n(2585);let t=r.Viewport=class extends d.Disposable{constructor(i,s,o,p,g,C,T,_){super(),this._viewportElement=i,this._scrollArea=s,this._bufferService=o,this._optionsService=p,this._charSizeService=g,this._renderService=C,this._coreBrowserService=T,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new u.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(k=>this._activeBuffer=k.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(k=>this._renderDimensions=k)),this._handleThemeChange(_.colors),this.register(_.onChangeColors(k=>this._handleThemeChange(k))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(i){this._viewportElement.style.backgroundColor=i.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(i){if(i)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const s=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==s&&(this._lastRecordedBufferHeight=s,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const i=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==i&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=i),this._refreshAnimationFrame=null}syncScrollArea(i=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(i);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(i)}_handleScroll(i){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const s=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:s,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const i=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(i*(this._smoothScrollState.target-this._smoothScrollState.origin)),i<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(i,s){const o=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(s<0&&this._viewportElement.scrollTop!==0||s>0&&o<this._lastRecordedBufferHeight)||(i.cancelable&&i.preventDefault(),!1)}handleWheel(i){const s=this._getPixelsScrolled(i);return s!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+s:this._smoothScrollState.target+=s,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=s,this._bubbleScroll(i,s))}scrollLines(i){if(i!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const s=i*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+s,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:i,suppressScrollEvent:!1})}_getPixelsScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let s=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_LINE?s*=this._currentRowHeight:i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._currentRowHeight*this._bufferService.rows),s}getBufferElements(i,s){var o;let p,g="";const C=[],T=s??this._bufferService.buffer.lines.length,_=this._bufferService.buffer.lines;for(let k=i;k<T;k++){const D=_.get(k);if(!D)continue;const M=(o=_.get(k+1))===null||o===void 0?void 0:o.isWrapped;if(g+=D.translateToString(!M),!M||k===_.length-1){const S=document.createElement("div");S.textContent=g,C.push(S),g.length>0&&(p=S),g=""}}return{bufferElements:C,cursorElement:p}}getLinesScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let s=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(s/=this._currentRowHeight+0,this._wheelPartialScroll+=s,s=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._bufferService.rows),s}_applyScrollModifier(i,s){const o=this._optionsService.rawOptions.fastScrollModifier;return o==="alt"&&s.altKey||o==="ctrl"&&s.ctrlKey||o==="shift"&&s.shiftKey?i*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:i*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(i){this._lastTouchY=i.touches[0].pageY}handleTouchMove(i){const s=this._lastTouchY-i.touches[0].pageY;return this._lastTouchY=i.touches[0].pageY,s!==0&&(this._viewportElement.scrollTop+=s,this._bubbleScroll(i,s))}};r.Viewport=t=l([m(2,f.IBufferService),m(3,f.IOptionsService),m(4,h.ICharSizeService),m(5,h.IRenderService),m(6,h.ICoreBrowserService),m(7,h.IThemeService)],t)},3107:function(x,r,n){var l=this&&this.__decorate||function(t,i,s,o){var p,g=arguments.length,C=g<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(t,i,s,o);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(C=(g<3?p(C):g>3?p(i,s,C):p(i,s))||C);return g>3&&C&&Object.defineProperty(i,s,C),C},m=this&&this.__param||function(t,i){return function(s,o){i(s,o,t)}};Object.defineProperty(r,"__esModule",{value:!0}),r.BufferDecorationRenderer=void 0;const a=n(3656),h=n(4725),u=n(844),d=n(2585);let f=r.BufferDecorationRenderer=class extends u.Disposable{constructor(t,i,s,o){super(),this._screenElement=t,this._bufferService=i,this._decorationService=s,this._renderService=o,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(p=>this._removeDecoration(p))),this.register((0,u.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){var i,s;const o=document.createElement("div");o.classList.add("xterm-decoration"),o.classList.toggle("xterm-decoration-top-layer",((i=t==null?void 0:t.options)===null||i===void 0?void 0:i.layer)==="top"),o.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,o.style.height=(t.options.height||1)*this._renderService.dimensions.css.cell.height+"px",o.style.top=(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",o.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const p=(s=t.options.x)!==null&&s!==void 0?s:0;return p&&p>this._bufferService.cols&&(o.style.display="none"),this._refreshXPosition(t,o),o}_refreshStyle(t){const i=t.marker.line-this._bufferService.buffers.active.ydisp;if(i<0||i>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let s=this._decorationElements.get(t);s||(s=this._createElement(t),t.element=s,this._decorationElements.set(t,s),this._container.appendChild(s),t.onDispose(()=>{this._decorationElements.delete(t),s.remove()})),s.style.top=i*this._renderService.dimensions.css.cell.height+"px",s.style.display=this._altBufferIsActive?"none":"block",t.onRenderEmitter.fire(s)}}_refreshXPosition(t,i=t.element){var s;if(!i)return;const o=(s=t.options.x)!==null&&s!==void 0?s:0;(t.options.anchor||"left")==="right"?i.style.right=o?o*this._renderService.dimensions.css.cell.width+"px":"":i.style.left=o?o*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(t){var i;(i=this._decorationElements.get(t))===null||i===void 0||i.remove(),this._decorationElements.delete(t),t.dispose()}};r.BufferDecorationRenderer=f=l([m(1,d.IBufferService),m(2,d.IDecorationService),m(3,h.IRenderService)],f)},5871:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorZoneStore=void 0,r.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(n){if(n.options.overviewRulerOptions){for(const l of this._zones)if(l.color===n.options.overviewRulerOptions.color&&l.position===n.options.overviewRulerOptions.position){if(this._lineIntersectsZone(l,n.marker.line))return;if(this._lineAdjacentToZone(l,n.marker.line,n.options.overviewRulerOptions.position))return void this._addLineToZone(l,n.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=n.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=n.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=n.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=n.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:n.options.overviewRulerOptions.color,position:n.options.overviewRulerOptions.position,startBufferLine:n.marker.line,endBufferLine:n.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(n){this._linePadding=n}_lineIntersectsZone(n,l){return l>=n.startBufferLine&&l<=n.endBufferLine}_lineAdjacentToZone(n,l,m){return l>=n.startBufferLine-this._linePadding[m||"full"]&&l<=n.endBufferLine+this._linePadding[m||"full"]}_addLineToZone(n,l){n.startBufferLine=Math.min(n.startBufferLine,l),n.endBufferLine=Math.max(n.endBufferLine,l)}}},5744:function(x,r,n){var l=this&&this.__decorate||function(p,g,C,T){var _,k=arguments.length,D=k<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,C):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(p,g,C,T);else for(var M=p.length-1;M>=0;M--)(_=p[M])&&(D=(k<3?_(D):k>3?_(g,C,D):_(g,C))||D);return k>3&&D&&Object.defineProperty(g,C,D),D},m=this&&this.__param||function(p,g){return function(C,T){g(C,T,p)}};Object.defineProperty(r,"__esModule",{value:!0}),r.OverviewRulerRenderer=void 0;const a=n(5871),h=n(3656),u=n(4725),d=n(844),f=n(2585),t={full:0,left:0,center:0,right:0},i={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0};let o=r.OverviewRulerRenderer=class extends d.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(p,g,C,T,_,k,D){var M;super(),this._viewportElement=p,this._screenElement=g,this._bufferService=C,this._decorationService=T,this._renderService=_,this._optionsService=k,this._coreBrowseService=D,this._colorZoneStore=new a.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(M=this._viewportElement.parentElement)===null||M===void 0||M.insertBefore(this._canvas,this._viewportElement);const S=this._canvas.getContext("2d");if(!S)throw new Error("Ctx cannot be null");this._ctx=S,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,d.toDisposable)(()=>{var B;(B=this._canvas)===null||B===void 0||B.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,h.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const p=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);i.full=this._canvas.width,i.left=p,i.center=g,i.right=p,this._refreshDrawHeightConstants(),s.full=0,s.left=0,s.center=i.left,s.right=i.left+i.center}_refreshDrawHeightConstants(){t.full=Math.round(2*this._coreBrowseService.dpr);const p=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(p,12),6)*this._coreBrowseService.dpr);t.left=g,t.center=g,t.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const p=this._colorZoneStore.zones;for(const g of p)g.position!=="full"&&this._renderColorZone(g);for(const g of p)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(p){this._ctx.fillStyle=p.color,this._ctx.fillRect(s[p.position||"full"],Math.round((this._canvas.height-1)*(p.startBufferLine/this._bufferService.buffers.active.lines.length)-t[p.position||"full"]/2),i[p.position||"full"],Math.round((this._canvas.height-1)*((p.endBufferLine-p.startBufferLine)/this._bufferService.buffers.active.lines.length)+t[p.position||"full"]))}_queueRefresh(p,g){this._shouldUpdateDimensions=p||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};r.OverviewRulerRenderer=o=l([m(2,f.IBufferService),m(3,f.IDecorationService),m(4,u.IRenderService),m(5,f.IOptionsService),m(6,u.ICoreBrowserService)],o)},2950:function(x,r,n){var l=this&&this.__decorate||function(f,t,i,s){var o,p=arguments.length,g=p<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(f,t,i,s);else for(var C=f.length-1;C>=0;C--)(o=f[C])&&(g=(p<3?o(g):p>3?o(t,i,g):o(t,i))||g);return p>3&&g&&Object.defineProperty(t,i,g),g},m=this&&this.__param||function(f,t){return function(i,s){t(i,s,f)}};Object.defineProperty(r,"__esModule",{value:!0}),r.CompositionHelper=void 0;const a=n(4725),h=n(2585),u=n(2584);let d=r.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(f,t,i,s,o,p){this._textarea=f,this._compositionView=t,this._bufferService=i,this._optionsService=s,this._coreService=o,this._renderService=p,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(f){this._compositionView.textContent=f.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(f){if(this._isComposing||this._isSendingComposition){if(f.keyCode===229||f.keyCode===16||f.keyCode===17||f.keyCode===18)return!1;this._finalizeComposition(!1)}return f.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(f){if(this._compositionView.classList.remove("active"),this._isComposing=!1,f){const t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let i;this._isSendingComposition=!1,t.start+=this._dataAlreadySent.length,i=this._isComposing?this._textarea.value.substring(t.start,t.end):this._textarea.value.substring(t.start),i.length>0&&this._coreService.triggerDataEvent(i,!0)}},0)}else{this._isSendingComposition=!1;const t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){const f=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const t=this._textarea.value,i=t.replace(f,"");this._dataAlreadySent=i,t.length>f.length?this._coreService.triggerDataEvent(i,!0):t.length<f.length?this._coreService.triggerDataEvent(`${u.C0.DEL}`,!0):t.length===f.length&&t!==f&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(f){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),i=this._renderService.dimensions.css.cell.height,s=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,o=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=o+"px",this._compositionView.style.top=s+"px",this._compositionView.style.height=i+"px",this._compositionView.style.lineHeight=i+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const p=this._compositionView.getBoundingClientRect();this._textarea.style.left=o+"px",this._textarea.style.top=s+"px",this._textarea.style.width=Math.max(p.width,1)+"px",this._textarea.style.height=Math.max(p.height,1)+"px",this._textarea.style.lineHeight=p.height+"px"}f||setTimeout(()=>this.updateCompositionElements(!0),0)}}};r.CompositionHelper=d=l([m(2,h.IBufferService),m(3,h.IOptionsService),m(4,h.ICoreService),m(5,a.IRenderService)],d)},9806:(x,r)=>{function n(l,m,a){const h=a.getBoundingClientRect(),u=l.getComputedStyle(a),d=parseInt(u.getPropertyValue("padding-left")),f=parseInt(u.getPropertyValue("padding-top"));return[m.clientX-h.left-d,m.clientY-h.top-f]}Object.defineProperty(r,"__esModule",{value:!0}),r.getCoords=r.getCoordsRelativeToElement=void 0,r.getCoordsRelativeToElement=n,r.getCoords=function(l,m,a,h,u,d,f,t,i){if(!d)return;const s=n(l,m,a);return s?(s[0]=Math.ceil((s[0]+(i?f/2:0))/f),s[1]=Math.ceil(s[1]/t),s[0]=Math.min(Math.max(s[0],1),h+(i?1:0)),s[1]=Math.min(Math.max(s[1],1),u),s):void 0}},9504:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.moveToCellSequence=void 0;const l=n(2584);function m(t,i,s,o){const p=t-a(t,s),g=i-a(i,s),C=Math.abs(p-g)-function(T,_,k){let D=0;const M=T-a(T,k),S=_-a(_,k);for(let B=0;B<Math.abs(M-S);B++){const H=h(T,_)==="A"?-1:1,F=k.buffer.lines.get(M+H*B);F!=null&&F.isWrapped&&D++}return D}(t,i,s);return f(C,d(h(t,i),o))}function a(t,i){let s=0,o=i.buffer.lines.get(t),p=o==null?void 0:o.isWrapped;for(;p&&t>=0&&t<i.rows;)s++,o=i.buffer.lines.get(--t),p=o==null?void 0:o.isWrapped;return s}function h(t,i){return t>i?"A":"B"}function u(t,i,s,o,p,g){let C=t,T=i,_="";for(;C!==s||T!==o;)C+=p?1:-1,p&&C>g.cols-1?(_+=g.buffer.translateBufferLineToString(T,!1,t,C),C=0,t=0,T++):!p&&C<0&&(_+=g.buffer.translateBufferLineToString(T,!1,0,t+1),C=g.cols-1,t=C,T--);return _+g.buffer.translateBufferLineToString(T,!1,t,C)}function d(t,i){const s=i?"O":"[";return l.C0.ESC+s+t}function f(t,i){t=Math.floor(t);let s="";for(let o=0;o<t;o++)s+=i;return s}r.moveToCellSequence=function(t,i,s,o){const p=s.buffer.x,g=s.buffer.y;if(!s.buffer.hasScrollback)return function(_,k,D,M,S,B){return m(k,M,S,B).length===0?"":f(u(_,k,_,k-a(k,S),!1,S).length,d("D",B))}(p,g,0,i,s,o)+m(g,i,s,o)+function(_,k,D,M,S,B){let H;H=m(k,M,S,B).length>0?M-a(M,S):k;const F=M,O=function(P,L,I,A,N,z){let j;return j=m(I,A,N,z).length>0?A-a(A,N):L,P<I&&j<=A||P>=I&&j<A?"C":"D"}(_,k,D,M,S,B);return f(u(_,H,D,F,O==="C",S).length,d(O,B))}(p,g,t,i,s,o);let C;if(g===i)return C=p>t?"D":"C",f(Math.abs(p-t),d(C,o));C=g>i?"D":"C";const T=Math.abs(g-i);return f(function(_,k){return k.cols-_}(g>i?t:p,s)+(T-1)*s.cols+1+((g>i?p:t)-1),d(C,o))}},1296:function(x,r,n){var l=this&&this.__decorate||function(S,B,H,F){var O,P=arguments.length,L=P<3?B:F===null?F=Object.getOwnPropertyDescriptor(B,H):F;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(S,B,H,F);else for(var I=S.length-1;I>=0;I--)(O=S[I])&&(L=(P<3?O(L):P>3?O(B,H,L):O(B,H))||L);return P>3&&L&&Object.defineProperty(B,H,L),L},m=this&&this.__param||function(S,B){return function(H,F){B(H,F,S)}};Object.defineProperty(r,"__esModule",{value:!0}),r.DomRenderer=void 0;const a=n(3787),h=n(2550),u=n(2223),d=n(6171),f=n(4725),t=n(8055),i=n(8460),s=n(844),o=n(2585),p="xterm-dom-renderer-owner-",g="xterm-rows",C="xterm-fg-",T="xterm-bg-",_="xterm-focus",k="xterm-selection";let D=1,M=r.DomRenderer=class extends s.Disposable{constructor(S,B,H,F,O,P,L,I,A,N){super(),this._element=S,this._screenElement=B,this._viewportElement=H,this._linkifier2=F,this._charSizeService=P,this._optionsService=L,this._bufferService=I,this._coreBrowserService=A,this._themeService=N,this._terminalClass=D++,this._rowElements=[],this.onRequestRedraw=this.register(new i.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(g),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(k),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,d.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(z=>this._injectCss(z))),this._injectCss(this._themeService.colors),this._rowFactory=O.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(p+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(z=>this._handleLinkHover(z))),this.register(this._linkifier2.onHideLinkUnderline(z=>this._handleLinkLeave(z))),this.register((0,s.toDisposable)(()=>{this._element.classList.remove(p+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const S=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*S,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*S),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/S),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/S),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const H of this._rowElements)H.style.width=`${this.dimensions.css.canvas.width}px`,H.style.height=`${this.dimensions.css.cell.height}px`,H.style.lineHeight=`${this.dimensions.css.cell.height}px`,H.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const B=`${this._terminalSelector} .${g} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=B,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(S){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let B=`${this._terminalSelector} .${g} { color: ${S.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;B+=`${this._terminalSelector} .${g} .xterm-dim { color: ${t.color.multiplyOpacity(S.foreground,.5).css};}`,B+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,B+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",B+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${S.cursor.css};  color: ${S.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${S.cursor.css}; }}`,B+=`${this._terminalSelector} .${g}.${_} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g}.${_} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block { background-color: ${S.cursor.css}; color: ${S.cursorAccent.css};}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${S.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${S.cursor.css} inset;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${S.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,B+=`${this._terminalSelector} .${k} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${k} div { position: absolute; background-color: ${S.selectionBackgroundOpaque.css};}${this._terminalSelector} .${k} div { position: absolute; background-color: ${S.selectionInactiveBackgroundOpaque.css};}`;for(const[H,F]of S.ansi.entries())B+=`${this._terminalSelector} .${C}${H} { color: ${F.css}; }${this._terminalSelector} .${C}${H}.xterm-dim { color: ${t.color.multiplyOpacity(F,.5).css}; }${this._terminalSelector} .${T}${H} { background-color: ${F.css}; }`;B+=`${this._terminalSelector} .${C}${u.INVERTED_DEFAULT_COLOR} { color: ${t.color.opaque(S.background).css}; }${this._terminalSelector} .${C}${u.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${t.color.multiplyOpacity(t.color.opaque(S.background),.5).css}; }${this._terminalSelector} .${T}${u.INVERTED_DEFAULT_COLOR} { background-color: ${S.foreground.css}; }`,this._themeStyleElement.textContent=B}_setDefaultSpacing(){const S=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${S}px`,this._rowFactory.defaultSpacing=S}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(S,B){for(let H=this._rowElements.length;H<=B;H++){const F=document.createElement("div");this._rowContainer.appendChild(F),this._rowElements.push(F)}for(;this._rowElements.length>B;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(S,B){this._refreshRowElements(S,B),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(_)}handleFocus(){this._rowContainer.classList.add(_),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(S,B,H){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(S,B,H),this.renderRows(0,this._bufferService.rows-1),!S||!B)return;const F=S[1]-this._bufferService.buffer.ydisp,O=B[1]-this._bufferService.buffer.ydisp,P=Math.max(F,0),L=Math.min(O,this._bufferService.rows-1);if(P>=this._bufferService.rows||L<0)return;const I=document.createDocumentFragment();if(H){const A=S[0]>B[0];I.appendChild(this._createSelectionElement(P,A?B[0]:S[0],A?S[0]:B[0],L-P+1))}else{const A=F===P?S[0]:0,N=P===O?B[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(P,A,N));const z=L-P-1;if(I.appendChild(this._createSelectionElement(P+1,0,this._bufferService.cols,z)),P!==L){const j=O===L?B[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(L,0,j))}}this._selectionContainer.appendChild(I)}_createSelectionElement(S,B,H,F=1){const O=document.createElement("div");return O.style.height=F*this.dimensions.css.cell.height+"px",O.style.top=S*this.dimensions.css.cell.height+"px",O.style.left=B*this.dimensions.css.cell.width+"px",O.style.width=this.dimensions.css.cell.width*(H-B)+"px",O}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const S of this._rowElements)S.replaceChildren()}renderRows(S,B){const H=this._bufferService.buffer,F=H.ybase+H.y,O=Math.min(H.x,this._bufferService.cols-1),P=this._optionsService.rawOptions.cursorBlink,L=this._optionsService.rawOptions.cursorStyle,I=this._optionsService.rawOptions.cursorInactiveStyle;for(let A=S;A<=B;A++){const N=A+H.ydisp,z=this._rowElements[A],j=H.lines.get(N);if(!z||!j)break;z.replaceChildren(...this._rowFactory.createRow(j,N,N===F,L,I,O,P,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${p}${this._terminalClass}`}_handleLinkHover(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!0)}_handleLinkLeave(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!1)}_setCellUnderline(S,B,H,F,O,P){H<0&&(S=0),F<0&&(B=0);const L=this._bufferService.rows-1;H=Math.max(Math.min(H,L),0),F=Math.max(Math.min(F,L),0),O=Math.min(O,this._bufferService.cols);const I=this._bufferService.buffer,A=I.ybase+I.y,N=Math.min(I.x,O-1),z=this._optionsService.rawOptions.cursorBlink,j=this._optionsService.rawOptions.cursorStyle,V=this._optionsService.rawOptions.cursorInactiveStyle;for(let q=H;q<=F;++q){const Z=q+I.ydisp,R=this._rowElements[q],$=I.lines.get(Z);if(!R||!$)break;R.replaceChildren(...this._rowFactory.createRow($,Z,Z===A,j,V,N,z,this.dimensions.css.cell.width,this._widthCache,P?q===H?S:0:-1,P?(q===F?B:O)-1:-1))}}};r.DomRenderer=M=l([m(4,o.IInstantiationService),m(5,f.ICharSizeService),m(6,o.IOptionsService),m(7,o.IBufferService),m(8,f.ICoreBrowserService),m(9,f.IThemeService)],M)},3787:function(x,r,n){var l=this&&this.__decorate||function(C,T,_,k){var D,M=arguments.length,S=M<3?T:k===null?k=Object.getOwnPropertyDescriptor(T,_):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(C,T,_,k);else for(var B=C.length-1;B>=0;B--)(D=C[B])&&(S=(M<3?D(S):M>3?D(T,_,S):D(T,_))||S);return M>3&&S&&Object.defineProperty(T,_,S),S},m=this&&this.__param||function(C,T){return function(_,k){T(_,k,C)}};Object.defineProperty(r,"__esModule",{value:!0}),r.DomRendererRowFactory=void 0;const a=n(2223),h=n(643),u=n(511),d=n(2585),f=n(8055),t=n(4725),i=n(4269),s=n(6171),o=n(3734);let p=r.DomRendererRowFactory=class{constructor(C,T,_,k,D,M,S){this._document=C,this._characterJoinerService=T,this._optionsService=_,this._coreBrowserService=k,this._coreService=D,this._decorationService=M,this._themeService=S,this._workCell=new u.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(C,T,_){this._selectionStart=C,this._selectionEnd=T,this._columnSelectMode=_}createRow(C,T,_,k,D,M,S,B,H,F,O){const P=[],L=this._characterJoinerService.getJoinedCharacters(T),I=this._themeService.colors;let A,N=C.getNoBgTrimmedLength();_&&N<M+1&&(N=M+1);let z=0,j="",V=0,q=0,Z=0,R=!1,$=0,X=!1,U=0;const Y=[],W=F!==-1&&O!==-1;for(let te=0;te<N;te++){C.loadCell(te,this._workCell);let _e=this._workCell.getWidth();if(_e===0)continue;let Q=!1,re=te,ee=this._workCell;if(L.length>0&&te===L[0][0]){Q=!0;const oe=L.shift();ee=new i.JoinedCellData(this._workCell,C.translateToString(!0,oe[0],oe[1]),oe[1]-oe[0]),re=oe[1]-1,_e=ee.getWidth()}const he=this._isCellInSelection(te,T),we=_&&te===M,ye=W&&te>=F&&te<=O;let J=!1;this._decorationService.forEachDecorationAtCell(te,T,void 0,oe=>{J=!0});let le=ee.getChars()||h.WHITESPACE_CELL_CHAR;if(le===" "&&(ee.isUnderline()||ee.isOverline())&&(le=" "),U=_e*B-H.get(le,ee.isBold(),ee.isItalic()),A){if(z&&(he&&X||!he&&!X&&ee.bg===V)&&(he&&X&&I.selectionForeground||ee.fg===q)&&ee.extended.ext===Z&&ye===R&&U===$&&!we&&!Q&&!J){j+=le,z++;continue}z&&(A.textContent=j),A=this._document.createElement("span"),z=0,j=""}else A=this._document.createElement("span");if(V=ee.bg,q=ee.fg,Z=ee.extended.ext,R=ye,$=U,X=he,Q&&M>=te&&M<=re&&(M=te),!this._coreService.isCursorHidden&&we){if(Y.push("xterm-cursor"),this._coreBrowserService.isFocused)S&&Y.push("xterm-cursor-blink"),Y.push(k==="bar"?"xterm-cursor-bar":k==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(D)switch(D){case"outline":Y.push("xterm-cursor-outline");break;case"block":Y.push("xterm-cursor-block");break;case"bar":Y.push("xterm-cursor-bar");break;case"underline":Y.push("xterm-cursor-underline")}}if(ee.isBold()&&Y.push("xterm-bold"),ee.isItalic()&&Y.push("xterm-italic"),ee.isDim()&&Y.push("xterm-dim"),j=ee.isInvisible()?h.WHITESPACE_CELL_CHAR:ee.getChars()||h.WHITESPACE_CELL_CHAR,ee.isUnderline()&&(Y.push(`xterm-underline-${ee.extended.underlineStyle}`),j===" "&&(j=" "),!ee.isUnderlineColorDefault()))if(ee.isUnderlineColorRGB())A.style.textDecorationColor=`rgb(${o.AttributeData.toColorRGB(ee.getUnderlineColor()).join(",")})`;else{let oe=ee.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ee.isBold()&&oe<8&&(oe+=8),A.style.textDecorationColor=I.ansi[oe].css}ee.isOverline()&&(Y.push("xterm-overline"),j===" "&&(j=" ")),ee.isStrikethrough()&&Y.push("xterm-strikethrough"),ye&&(A.style.textDecoration="underline");let se=ee.getFgColor(),Ce=ee.getFgColorMode(),de=ee.getBgColor(),Pe=ee.getBgColorMode();const be=!!ee.isInverse();if(be){const oe=se;se=de,de=oe;const fe=Ce;Ce=Pe,Pe=fe}let ne,ge,ue,Le=!1;switch(this._decorationService.forEachDecorationAtCell(te,T,void 0,oe=>{oe.options.layer!=="top"&&Le||(oe.backgroundColorRGB&&(Pe=50331648,de=oe.backgroundColorRGB.rgba>>8&16777215,ne=oe.backgroundColorRGB),oe.foregroundColorRGB&&(Ce=50331648,se=oe.foregroundColorRGB.rgba>>8&16777215,ge=oe.foregroundColorRGB),Le=oe.options.layer==="top")}),!Le&&he&&(ne=this._coreBrowserService.isFocused?I.selectionBackgroundOpaque:I.selectionInactiveBackgroundOpaque,de=ne.rgba>>8&16777215,Pe=50331648,Le=!0,I.selectionForeground&&(Ce=50331648,se=I.selectionForeground.rgba>>8&16777215,ge=I.selectionForeground)),Le&&Y.push("xterm-decoration-top"),Pe){case 16777216:case 33554432:ue=I.ansi[de],Y.push(`xterm-bg-${de}`);break;case 50331648:ue=f.rgba.toColor(de>>16,de>>8&255,255&de),this._addStyle(A,`background-color:#${g((de>>>0).toString(16),"0",6)}`);break;default:be?(ue=I.foreground,Y.push(`xterm-bg-${a.INVERTED_DEFAULT_COLOR}`)):ue=I.background}switch(ne||ee.isDim()&&(ne=f.color.multiplyOpacity(ue,.5)),Ce){case 16777216:case 33554432:ee.isBold()&&se<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(se+=8),this._applyMinimumContrast(A,ue,I.ansi[se],ee,ne,void 0)||Y.push(`xterm-fg-${se}`);break;case 50331648:const oe=f.rgba.toColor(se>>16&255,se>>8&255,255&se);this._applyMinimumContrast(A,ue,oe,ee,ne,ge)||this._addStyle(A,`color:#${g(se.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(A,ue,I.foreground,ee,ne,void 0)||be&&Y.push(`xterm-fg-${a.INVERTED_DEFAULT_COLOR}`)}Y.length&&(A.className=Y.join(" "),Y.length=0),we||Q||J?A.textContent=j:z++,U!==this.defaultSpacing&&(A.style.letterSpacing=`${U}px`),P.push(A),te=re}return A&&z&&(A.textContent=j),P}_applyMinimumContrast(C,T,_,k,D,M){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,s.excludeFromContrastRatioDemands)(k.getCode()))return!1;const S=this._getContrastCache(k);let B;if(D||M||(B=S.getColor(T.rgba,_.rgba)),B===void 0){const H=this._optionsService.rawOptions.minimumContrastRatio/(k.isDim()?2:1);B=f.color.ensureContrastRatio(D||T,M||_,H),S.setColor((D||T).rgba,(M||_).rgba,B??null)}return!!B&&(this._addStyle(C,`color:${B.css}`),!0)}_getContrastCache(C){return C.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(C,T){C.setAttribute("style",`${C.getAttribute("style")||""}${T};`)}_isCellInSelection(C,T){const _=this._selectionStart,k=this._selectionEnd;return!(!_||!k)&&(this._columnSelectMode?_[0]<=k[0]?C>=_[0]&&T>=_[1]&&C<k[0]&&T<=k[1]:C<_[0]&&T>=_[1]&&C>=k[0]&&T<=k[1]:T>_[1]&&T<k[1]||_[1]===k[1]&&T===_[1]&&C>=_[0]&&C<k[0]||_[1]<k[1]&&T===k[1]&&C<k[0]||_[1]<k[1]&&T===_[1]&&C>=_[0])}};function g(C,T,_){for(;C.length<_;)C=T+C;return C}r.DomRendererRowFactory=p=l([m(1,t.ICharacterJoinerService),m(2,d.IOptionsService),m(3,t.ICoreBrowserService),m(4,d.ICoreService),m(5,d.IDecorationService),m(6,t.IThemeService)],p)},2550:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.WidthCache=void 0,r.WidthCache=class{constructor(n){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=n.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const l=n.createElement("span"),m=n.createElement("span");m.style.fontWeight="bold";const a=n.createElement("span");a.style.fontStyle="italic";const h=n.createElement("span");h.style.fontWeight="bold",h.style.fontStyle="italic",this._measureElements=[l,m,a,h],this._container.appendChild(l),this._container.appendChild(m),this._container.appendChild(a),this._container.appendChild(h),n.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(n,l,m,a){n===this._font&&l===this._fontSize&&m===this._weight&&a===this._weightBold||(this._font=n,this._fontSize=l,this._weight=m,this._weightBold=a,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${m}`,this._measureElements[1].style.fontWeight=`${a}`,this._measureElements[2].style.fontWeight=`${m}`,this._measureElements[3].style.fontWeight=`${a}`,this.clear())}get(n,l,m){let a=0;if(!l&&!m&&n.length===1&&(a=n.charCodeAt(0))<256)return this._flat[a]!==-9999?this._flat[a]:this._flat[a]=this._measure(n,0);let h=n;l&&(h+="B"),m&&(h+="I");let u=this._holey.get(h);if(u===void 0){let d=0;l&&(d|=1),m&&(d|=2),u=this._measure(n,d),this._holey.set(h,u)}return u}_measure(n,l){const m=this._measureElements[l];return m.textContent=n.repeat(32),m.offsetWidth/32}}},2223:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TEXT_BASELINE=r.DIM_OPACITY=r.INVERTED_DEFAULT_COLOR=void 0;const l=n(6114);r.INVERTED_DEFAULT_COLOR=257,r.DIM_OPACITY=.5,r.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},6171:(x,r)=>{function n(l){return 57508<=l&&l<=57558}Object.defineProperty(r,"__esModule",{value:!0}),r.createRenderDimensions=r.excludeFromContrastRatioDemands=r.isRestrictedPowerlineGlyph=r.isPowerlineGlyph=r.throwIfFalsy=void 0,r.throwIfFalsy=function(l){if(!l)throw new Error("value must not be falsy");return l},r.isPowerlineGlyph=n,r.isRestrictedPowerlineGlyph=function(l){return 57520<=l&&l<=57527},r.excludeFromContrastRatioDemands=function(l){return n(l)||function(m){return 9472<=m&&m<=9631}(l)},r.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SelectionModel=void 0,r.SelectionModel=class{constructor(n){this._bufferService=n,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?n%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)-1]:[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[n,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[Math.max(n,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const n=this.selectionStart,l=this.selectionEnd;return!(!n||!l)&&(n[1]>l[1]||n[1]===l[1]&&n[0]>l[0])}handleTrim(n){return this.selectionStart&&(this.selectionStart[1]-=n),this.selectionEnd&&(this.selectionEnd[1]-=n),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(x,r,n){var l=this&&this.__decorate||function(t,i,s,o){var p,g=arguments.length,C=g<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(t,i,s,o);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(C=(g<3?p(C):g>3?p(i,s,C):p(i,s))||C);return g>3&&C&&Object.defineProperty(i,s,C),C},m=this&&this.__param||function(t,i){return function(s,o){i(s,o,t)}};Object.defineProperty(r,"__esModule",{value:!0}),r.CharSizeService=void 0;const a=n(2585),h=n(8460),u=n(844);let d=r.CharSizeService=class extends u.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(t,i,s){super(),this._optionsService=s,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new f(t,i,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};r.CharSizeService=d=l([m(2,a.IOptionsService)],d);class f{constructor(i,s,o){this._document=i,this._parentElement=s,this._optionsService=o,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const i={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return i.width!==0&&i.height!==0&&(this._result.width=i.width/32,this._result.height=Math.ceil(i.height)),this._result}}},4269:function(x,r,n){var l=this&&this.__decorate||function(i,s,o,p){var g,C=arguments.length,T=C<3?s:p===null?p=Object.getOwnPropertyDescriptor(s,o):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(i,s,o,p);else for(var _=i.length-1;_>=0;_--)(g=i[_])&&(T=(C<3?g(T):C>3?g(s,o,T):g(s,o))||T);return C>3&&T&&Object.defineProperty(s,o,T),T},m=this&&this.__param||function(i,s){return function(o,p){s(o,p,i)}};Object.defineProperty(r,"__esModule",{value:!0}),r.CharacterJoinerService=r.JoinedCellData=void 0;const a=n(3734),h=n(643),u=n(511),d=n(2585);class f extends a.AttributeData{constructor(s,o,p){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=o,this._width=p}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}r.JoinedCellData=f;let t=r.CharacterJoinerService=class Dn{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new u.CellData}register(s){const o={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(o),o.id}deregister(s){for(let o=0;o<this._characterJoiners.length;o++)if(this._characterJoiners[o].id===s)return this._characterJoiners.splice(o,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const o=this._bufferService.buffer.lines.get(s);if(!o||o.length===0)return[];const p=[],g=o.translateToString(!0);let C=0,T=0,_=0,k=o.getFg(0),D=o.getBg(0);for(let M=0;M<o.getTrimmedLength();M++)if(o.loadCell(M,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==k||this._workCell.bg!==D){if(M-C>1){const S=this._getJoinedRanges(g,_,T,o,C);for(let B=0;B<S.length;B++)p.push(S[B])}C=M,_=T,k=this._workCell.fg,D=this._workCell.bg}T+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-C>1){const M=this._getJoinedRanges(g,_,T,o,C);for(let S=0;S<M.length;S++)p.push(M[S])}return p}_getJoinedRanges(s,o,p,g,C){const T=s.substring(o,p);let _=[];try{_=this._characterJoiners[0].handler(T)}catch(k){console.error(k)}for(let k=1;k<this._characterJoiners.length;k++)try{const D=this._characterJoiners[k].handler(T);for(let M=0;M<D.length;M++)Dn._mergeRanges(_,D[M])}catch(D){console.error(D)}return this._stringRangesToCellRanges(_,g,C),_}_stringRangesToCellRanges(s,o,p){let g=0,C=!1,T=0,_=s[g];if(_){for(let k=p;k<this._bufferService.cols;k++){const D=o.getWidth(k),M=o.getString(k).length||h.WHITESPACE_CELL_CHAR.length;if(D!==0){if(!C&&_[0]<=T&&(_[0]=k,C=!0),_[1]<=T){if(_[1]=k,_=s[++g],!_)break;_[0]<=T?(_[0]=k,C=!0):C=!1}T+=M}}_&&(_[1]=this._bufferService.cols)}}static _mergeRanges(s,o){let p=!1;for(let g=0;g<s.length;g++){const C=s[g];if(p){if(o[1]<=C[0])return s[g-1][1]=o[1],s;if(o[1]<=C[1])return s[g-1][1]=Math.max(o[1],C[1]),s.splice(g,1),s;s.splice(g,1),g--}else{if(o[1]<=C[0])return s.splice(g,0,o),s;if(o[1]<=C[1])return C[0]=Math.min(o[0],C[0]),s;o[0]<C[1]&&(C[0]=Math.min(o[0],C[0]),p=!0)}}return p?s[s.length-1][1]=o[1]:s.push(o),s}};r.CharacterJoinerService=t=l([m(0,d.IBufferService)],t)},5114:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CoreBrowserService=void 0,r.CoreBrowserService=class{constructor(n,l){this._textarea=n,this.window=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(x,r,n){var l=this&&this.__decorate||function(d,f,t,i){var s,o=arguments.length,p=o<3?f:i===null?i=Object.getOwnPropertyDescriptor(f,t):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(d,f,t,i);else for(var g=d.length-1;g>=0;g--)(s=d[g])&&(p=(o<3?s(p):o>3?s(f,t,p):s(f,t))||p);return o>3&&p&&Object.defineProperty(f,t,p),p},m=this&&this.__param||function(d,f){return function(t,i){f(t,i,d)}};Object.defineProperty(r,"__esModule",{value:!0}),r.MouseService=void 0;const a=n(4725),h=n(9806);let u=r.MouseService=class{constructor(d,f){this._renderService=d,this._charSizeService=f}getCoords(d,f,t,i,s){return(0,h.getCoords)(window,d,f,t,i,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(d,f){const t=(0,h.getCoordsRelativeToElement)(window,d,f);if(this._charSizeService.hasValidSize)return t[0]=Math.min(Math.max(t[0],0),this._renderService.dimensions.css.canvas.width-1),t[1]=Math.min(Math.max(t[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(t[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(t[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(t[0]),y:Math.floor(t[1])}}};r.MouseService=u=l([m(0,a.IRenderService),m(1,a.ICharSizeService)],u)},3230:function(x,r,n){var l=this&&this.__decorate||function(p,g,C,T){var _,k=arguments.length,D=k<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,C):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(p,g,C,T);else for(var M=p.length-1;M>=0;M--)(_=p[M])&&(D=(k<3?_(D):k>3?_(g,C,D):_(g,C))||D);return k>3&&D&&Object.defineProperty(g,C,D),D},m=this&&this.__param||function(p,g){return function(C,T){g(C,T,p)}};Object.defineProperty(r,"__esModule",{value:!0}),r.RenderService=void 0;const a=n(3656),h=n(6193),u=n(5596),d=n(4725),f=n(8460),t=n(844),i=n(7226),s=n(2585);let o=r.RenderService=class extends t.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(p,g,C,T,_,k,D,M){if(super(),this._rowCount=p,this._charSizeService=T,this._renderer=this.register(new t.MutableDisposable),this._pausedResizeTask=new i.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new f.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new f.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new f.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new f.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer(D.window,(S,B)=>this._renderRows(S,B)),this.register(this._renderDebouncer),this._screenDprMonitor=new u.ScreenDprMonitor(D.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(k.onResize(()=>this._fullRefresh())),this.register(k.buffers.onBufferActivate(()=>{var S;return(S=this._renderer.value)===null||S===void 0?void 0:S.clear()})),this.register(C.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(_.onDecorationRegistered(()=>this._fullRefresh())),this.register(_.onDecorationRemoved(()=>this._fullRefresh())),this.register(C.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(k.cols,k.rows),this._fullRefresh()})),this.register(C.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(k.buffer.y,k.buffer.y,!0))),this.register((0,a.addDisposableDomListener)(D.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(M.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in D.window){const S=new D.window.IntersectionObserver(B=>this._handleIntersectionChange(B[B.length-1]),{threshold:0});S.observe(g),this.register({dispose:()=>S.disconnect()})}}_handleIntersectionChange(p){this._isPaused=p.isIntersecting===void 0?p.intersectionRatio===0:!p.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(p,g,C=!1){this._isPaused?this._needsFullRefresh=!0:(C||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(p,g,this._rowCount))}_renderRows(p,g){this._renderer.value&&(p=Math.min(p,this._rowCount-1),g=Math.min(g,this._rowCount-1),this._renderer.value.renderRows(p,g),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:p,end:g}),this._onRender.fire({start:p,end:g}),this._isNextRenderRedrawOnly=!0)}resize(p,g){this._rowCount=g,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(p){this._renderer.value=p,this._renderer.value.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(p){return this._renderDebouncer.addRefreshCallback(p)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var p,g;this._renderer.value&&((g=(p=this._renderer.value).clearTextureAtlas)===null||g===void 0||g.call(p),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(p,g){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(p,g)):this._renderer.value.handleResize(p,g),this._fullRefresh())}handleCharSizeChanged(){var p;(p=this._renderer.value)===null||p===void 0||p.handleCharSizeChanged()}handleBlur(){var p;(p=this._renderer.value)===null||p===void 0||p.handleBlur()}handleFocus(){var p;(p=this._renderer.value)===null||p===void 0||p.handleFocus()}handleSelectionChanged(p,g,C){var T;this._selectionState.start=p,this._selectionState.end=g,this._selectionState.columnSelectMode=C,(T=this._renderer.value)===null||T===void 0||T.handleSelectionChanged(p,g,C)}handleCursorMove(){var p;(p=this._renderer.value)===null||p===void 0||p.handleCursorMove()}clear(){var p;(p=this._renderer.value)===null||p===void 0||p.clear()}};r.RenderService=o=l([m(2,s.IOptionsService),m(3,d.ICharSizeService),m(4,s.IDecorationService),m(5,s.IBufferService),m(6,d.ICoreBrowserService),m(7,d.IThemeService)],o)},9312:function(x,r,n){var l=this&&this.__decorate||function(_,k,D,M){var S,B=arguments.length,H=B<3?k:M===null?M=Object.getOwnPropertyDescriptor(k,D):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(_,k,D,M);else for(var F=_.length-1;F>=0;F--)(S=_[F])&&(H=(B<3?S(H):B>3?S(k,D,H):S(k,D))||H);return B>3&&H&&Object.defineProperty(k,D,H),H},m=this&&this.__param||function(_,k){return function(D,M){k(D,M,_)}};Object.defineProperty(r,"__esModule",{value:!0}),r.SelectionService=void 0;const a=n(9806),h=n(9504),u=n(456),d=n(4725),f=n(8460),t=n(844),i=n(6114),s=n(4841),o=n(511),p=n(2585),g=String.fromCharCode(160),C=new RegExp(g,"g");let T=r.SelectionService=class extends t.Disposable{constructor(_,k,D,M,S,B,H,F,O){super(),this._element=_,this._screenElement=k,this._linkifier=D,this._bufferService=M,this._coreService=S,this._mouseService=B,this._optionsService=H,this._renderService=F,this._coreBrowserService=O,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new o.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new f.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new f.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=P=>this._handleMouseMove(P),this._mouseUpListener=P=>this._handleMouseUp(P),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(P=>this._handleTrim(P)),this.register(this._bufferService.buffers.onBufferActivate(P=>this._handleBufferActivate(P))),this.enable(),this._model=new u.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,t.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const _=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;return!(!_||!k||_[0]===k[0]&&_[1]===k[1])}get selectionText(){const _=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;if(!_||!k)return"";const D=this._bufferService.buffer,M=[];if(this._activeSelectionMode===3){if(_[0]===k[0])return"";const S=_[0]<k[0]?_[0]:k[0],B=_[0]<k[0]?k[0]:_[0];for(let H=_[1];H<=k[1];H++){const F=D.translateBufferLineToString(H,!0,S,B);M.push(F)}}else{const S=_[1]===k[1]?k[0]:void 0;M.push(D.translateBufferLineToString(_[1],!0,_[0],S));for(let B=_[1]+1;B<=k[1]-1;B++){const H=D.lines.get(B),F=D.translateBufferLineToString(B,!0);H!=null&&H.isWrapped?M[M.length-1]+=F:M.push(F)}if(_[1]!==k[1]){const B=D.lines.get(k[1]),H=D.translateBufferLineToString(k[1],!0,0,k[0]);B&&B.isWrapped?M[M.length-1]+=H:M.push(H)}}return M.map(S=>S.replace(C," ")).join(i.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(_){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),i.isLinux&&_&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(_){const k=this._getMouseBufferCoords(_),D=this._model.finalSelectionStart,M=this._model.finalSelectionEnd;return!!(D&&M&&k)&&this._areCoordsInSelection(k,D,M)}isCellInSelection(_,k){const D=this._model.finalSelectionStart,M=this._model.finalSelectionEnd;return!(!D||!M)&&this._areCoordsInSelection([_,k],D,M)}_areCoordsInSelection(_,k,D){return _[1]>k[1]&&_[1]<D[1]||k[1]===D[1]&&_[1]===k[1]&&_[0]>=k[0]&&_[0]<D[0]||k[1]<D[1]&&_[1]===D[1]&&_[0]<D[0]||k[1]<D[1]&&_[1]===k[1]&&_[0]>=k[0]}_selectWordAtCursor(_,k){var D,M;const S=(M=(D=this._linkifier.currentLink)===null||D===void 0?void 0:D.link)===null||M===void 0?void 0:M.range;if(S)return this._model.selectionStart=[S.start.x-1,S.start.y-1],this._model.selectionStartLength=(0,s.getRangeLength)(S,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const B=this._getMouseBufferCoords(_);return!!B&&(this._selectWordAt(B,k),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(_,k){this._model.clearSelection(),_=Math.max(_,0),k=Math.min(k,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,_],this._model.selectionEnd=[this._bufferService.cols,k],this.refresh(),this._onSelectionChange.fire()}_handleTrim(_){this._model.handleTrim(_)&&this.refresh()}_getMouseBufferCoords(_){const k=this._mouseService.getCoords(_,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(k)return k[0]--,k[1]--,k[1]+=this._bufferService.buffer.ydisp,k}_getMouseEventScrollAmount(_){let k=(0,a.getCoordsRelativeToElement)(this._coreBrowserService.window,_,this._screenElement)[1];const D=this._renderService.dimensions.css.canvas.height;return k>=0&&k<=D?0:(k>D&&(k-=D),k=Math.min(Math.max(k,-50),50),k/=50,k/Math.abs(k)+Math.round(14*k))}shouldForceSelection(_){return i.isMac?_.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:_.shiftKey}handleMouseDown(_){if(this._mouseDownTimeStamp=_.timeStamp,(_.button!==2||!this.hasSelection)&&_.button===0){if(!this._enabled){if(!this.shouldForceSelection(_))return;_.stopPropagation()}_.preventDefault(),this._dragScrollAmount=0,this._enabled&&_.shiftKey?this._handleIncrementalClick(_):_.detail===1?this._handleSingleClick(_):_.detail===2?this._handleDoubleClick(_):_.detail===3&&this._handleTripleClick(_),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(_){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(_))}_handleSingleClick(_){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(_)?3:0,this._model.selectionStart=this._getMouseBufferCoords(_),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const k=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);k&&k.length!==this._model.selectionStart[0]&&k.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(_){this._selectWordAtCursor(_,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(_){const k=this._getMouseBufferCoords(_);k&&(this._activeSelectionMode=2,this._selectLineAt(k[1]))}shouldColumnSelect(_){return _.altKey&&!(i.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(_){if(_.stopImmediatePropagation(),!this._model.selectionStart)return;const k=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(_),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(_),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const D=this._bufferService.buffer;if(this._model.selectionEnd[1]<D.lines.length){const M=D.lines.get(this._model.selectionEnd[1]);M&&M.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}k&&k[0]===this._model.selectionEnd[0]&&k[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const _=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(_.ydisp+this._bufferService.rows,_.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=_.ydisp),this.refresh()}}_handleMouseUp(_){const k=_.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&k<500&&_.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const D=this._mouseService.getCoords(_,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(D&&D[0]!==void 0&&D[1]!==void 0){const M=(0,h.moveToCellSequence)(D[0]-1,D[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(M,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const _=this._model.finalSelectionStart,k=this._model.finalSelectionEnd,D=!(!_||!k||_[0]===k[0]&&_[1]===k[1]);D?_&&k&&(this._oldSelectionStart&&this._oldSelectionEnd&&_[0]===this._oldSelectionStart[0]&&_[1]===this._oldSelectionStart[1]&&k[0]===this._oldSelectionEnd[0]&&k[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(_,k,D)):this._oldHasSelection&&this._fireOnSelectionChange(_,k,D)}_fireOnSelectionChange(_,k,D){this._oldSelectionStart=_,this._oldSelectionEnd=k,this._oldHasSelection=D,this._onSelectionChange.fire()}_handleBufferActivate(_){this.clearSelection(),this._trimListener.dispose(),this._trimListener=_.activeBuffer.lines.onTrim(k=>this._handleTrim(k))}_convertViewportColToCharacterIndex(_,k){let D=k;for(let M=0;k>=M;M++){const S=_.loadCell(M,this._workCell).getChars().length;this._workCell.getWidth()===0?D--:S>1&&k!==M&&(D+=S-1)}return D}setSelection(_,k,D){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[_,k],this._model.selectionStartLength=D,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(_){this._isClickInSelection(_)||(this._selectWordAtCursor(_,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(_,k,D=!0,M=!0){if(_[0]>=this._bufferService.cols)return;const S=this._bufferService.buffer,B=S.lines.get(_[1]);if(!B)return;const H=S.translateBufferLineToString(_[1],!1);let F=this._convertViewportColToCharacterIndex(B,_[0]),O=F;const P=_[0]-F;let L=0,I=0,A=0,N=0;if(H.charAt(F)===" "){for(;F>0&&H.charAt(F-1)===" ";)F--;for(;O<H.length&&H.charAt(O+1)===" ";)O++}else{let V=_[0],q=_[0];B.getWidth(V)===0&&(L++,V--),B.getWidth(q)===2&&(I++,q++);const Z=B.getString(q).length;for(Z>1&&(N+=Z-1,O+=Z-1);V>0&&F>0&&!this._isCharWordSeparator(B.loadCell(V-1,this._workCell));){B.loadCell(V-1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===0?(L++,V--):R>1&&(A+=R-1,F-=R-1),F--,V--}for(;q<B.length&&O+1<H.length&&!this._isCharWordSeparator(B.loadCell(q+1,this._workCell));){B.loadCell(q+1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===2?(I++,q++):R>1&&(N+=R-1,O+=R-1),O++,q++}}O++;let z=F+P-L+A,j=Math.min(this._bufferService.cols,O-F+L+I-A-N);if(k||H.slice(F,O).trim()!==""){if(D&&z===0&&B.getCodePoint(0)!==32){const V=S.lines.get(_[1]-1);if(V&&B.isWrapped&&V.getCodePoint(this._bufferService.cols-1)!==32){const q=this._getWordAt([this._bufferService.cols-1,_[1]-1],!1,!0,!1);if(q){const Z=this._bufferService.cols-q.start;z-=Z,j+=Z}}}if(M&&z+j===this._bufferService.cols&&B.getCodePoint(this._bufferService.cols-1)!==32){const V=S.lines.get(_[1]+1);if(V!=null&&V.isWrapped&&V.getCodePoint(0)!==32){const q=this._getWordAt([0,_[1]+1],!1,!1,!0);q&&(j+=q.length)}}return{start:z,length:j}}}_selectWordAt(_,k){const D=this._getWordAt(_,k);if(D){for(;D.start<0;)D.start+=this._bufferService.cols,_[1]--;this._model.selectionStart=[D.start,_[1]],this._model.selectionStartLength=D.length}}_selectToWordAt(_){const k=this._getWordAt(_,!0);if(k){let D=_[1];for(;k.start<0;)k.start+=this._bufferService.cols,D--;if(!this._model.areSelectionValuesReversed())for(;k.start+k.length>this._bufferService.cols;)k.length-=this._bufferService.cols,D++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?k.start:k.start+k.length,D]}}_isCharWordSeparator(_){return _.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(_.getChars())>=0}_selectLineAt(_){const k=this._bufferService.buffer.getWrappedRangeForLine(_),D={start:{x:0,y:k.first},end:{x:this._bufferService.cols-1,y:k.last}};this._model.selectionStart=[0,k.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,s.getRangeLength)(D,this._bufferService.cols)}};r.SelectionService=T=l([m(3,p.IBufferService),m(4,p.ICoreService),m(5,d.IMouseService),m(6,p.IOptionsService),m(7,d.IRenderService),m(8,d.ICoreBrowserService)],T)},4725:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.IThemeService=r.ICharacterJoinerService=r.ISelectionService=r.IRenderService=r.IMouseService=r.ICoreBrowserService=r.ICharSizeService=void 0;const l=n(8343);r.ICharSizeService=(0,l.createDecorator)("CharSizeService"),r.ICoreBrowserService=(0,l.createDecorator)("CoreBrowserService"),r.IMouseService=(0,l.createDecorator)("MouseService"),r.IRenderService=(0,l.createDecorator)("RenderService"),r.ISelectionService=(0,l.createDecorator)("SelectionService"),r.ICharacterJoinerService=(0,l.createDecorator)("CharacterJoinerService"),r.IThemeService=(0,l.createDecorator)("ThemeService")},6731:function(x,r,n){var l=this&&this.__decorate||function(T,_,k,D){var M,S=arguments.length,B=S<3?_:D===null?D=Object.getOwnPropertyDescriptor(_,k):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(T,_,k,D);else for(var H=T.length-1;H>=0;H--)(M=T[H])&&(B=(S<3?M(B):S>3?M(_,k,B):M(_,k))||B);return S>3&&B&&Object.defineProperty(_,k,B),B},m=this&&this.__param||function(T,_){return function(k,D){_(k,D,T)}};Object.defineProperty(r,"__esModule",{value:!0}),r.ThemeService=r.DEFAULT_ANSI_COLORS=void 0;const a=n(7239),h=n(8055),u=n(8460),d=n(844),f=n(2585),t=h.css.toColor("#ffffff"),i=h.css.toColor("#000000"),s=h.css.toColor("#ffffff"),o=h.css.toColor("#000000"),p={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};r.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const T=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],_=[0,95,135,175,215,255];for(let k=0;k<216;k++){const D=_[k/36%6|0],M=_[k/6%6|0],S=_[k%6];T.push({css:h.channels.toCss(D,M,S),rgba:h.channels.toRgba(D,M,S)})}for(let k=0;k<24;k++){const D=8+10*k;T.push({css:h.channels.toCss(D,D,D),rgba:h.channels.toRgba(D,D,D)})}return T})());let g=r.ThemeService=class extends d.Disposable{get colors(){return this._colors}constructor(T){super(),this._optionsService=T,this._contrastCache=new a.ColorContrastCache,this._halfContrastCache=new a.ColorContrastCache,this._onChangeColors=this.register(new u.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:t,background:i,cursor:s,cursorAccent:o,selectionForeground:void 0,selectionBackgroundTransparent:p,selectionBackgroundOpaque:h.color.blend(i,p),selectionInactiveBackgroundTransparent:p,selectionInactiveBackgroundOpaque:h.color.blend(i,p),ansi:r.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(T={}){const _=this._colors;if(_.foreground=C(T.foreground,t),_.background=C(T.background,i),_.cursor=C(T.cursor,s),_.cursorAccent=C(T.cursorAccent,o),_.selectionBackgroundTransparent=C(T.selectionBackground,p),_.selectionBackgroundOpaque=h.color.blend(_.background,_.selectionBackgroundTransparent),_.selectionInactiveBackgroundTransparent=C(T.selectionInactiveBackground,_.selectionBackgroundTransparent),_.selectionInactiveBackgroundOpaque=h.color.blend(_.background,_.selectionInactiveBackgroundTransparent),_.selectionForeground=T.selectionForeground?C(T.selectionForeground,h.NULL_COLOR):void 0,_.selectionForeground===h.NULL_COLOR&&(_.selectionForeground=void 0),h.color.isOpaque(_.selectionBackgroundTransparent)&&(_.selectionBackgroundTransparent=h.color.opacity(_.selectionBackgroundTransparent,.3)),h.color.isOpaque(_.selectionInactiveBackgroundTransparent)&&(_.selectionInactiveBackgroundTransparent=h.color.opacity(_.selectionInactiveBackgroundTransparent,.3)),_.ansi=r.DEFAULT_ANSI_COLORS.slice(),_.ansi[0]=C(T.black,r.DEFAULT_ANSI_COLORS[0]),_.ansi[1]=C(T.red,r.DEFAULT_ANSI_COLORS[1]),_.ansi[2]=C(T.green,r.DEFAULT_ANSI_COLORS[2]),_.ansi[3]=C(T.yellow,r.DEFAULT_ANSI_COLORS[3]),_.ansi[4]=C(T.blue,r.DEFAULT_ANSI_COLORS[4]),_.ansi[5]=C(T.magenta,r.DEFAULT_ANSI_COLORS[5]),_.ansi[6]=C(T.cyan,r.DEFAULT_ANSI_COLORS[6]),_.ansi[7]=C(T.white,r.DEFAULT_ANSI_COLORS[7]),_.ansi[8]=C(T.brightBlack,r.DEFAULT_ANSI_COLORS[8]),_.ansi[9]=C(T.brightRed,r.DEFAULT_ANSI_COLORS[9]),_.ansi[10]=C(T.brightGreen,r.DEFAULT_ANSI_COLORS[10]),_.ansi[11]=C(T.brightYellow,r.DEFAULT_ANSI_COLORS[11]),_.ansi[12]=C(T.brightBlue,r.DEFAULT_ANSI_COLORS[12]),_.ansi[13]=C(T.brightMagenta,r.DEFAULT_ANSI_COLORS[13]),_.ansi[14]=C(T.brightCyan,r.DEFAULT_ANSI_COLORS[14]),_.ansi[15]=C(T.brightWhite,r.DEFAULT_ANSI_COLORS[15]),T.extendedAnsi){const k=Math.min(_.ansi.length-16,T.extendedAnsi.length);for(let D=0;D<k;D++)_.ansi[D+16]=C(T.extendedAnsi[D],r.DEFAULT_ANSI_COLORS[D+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(T){this._restoreColor(T),this._onChangeColors.fire(this.colors)}_restoreColor(T){if(T!==void 0)switch(T){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[T]=this._restoreColors.ansi[T]}else for(let _=0;_<this._restoreColors.ansi.length;++_)this._colors.ansi[_]=this._restoreColors.ansi[_]}modifyColors(T){T(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function C(T,_){if(T!==void 0)try{return h.css.toColor(T)}catch{}return _}r.ThemeService=g=l([m(0,f.IOptionsService)],g)},6349:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CircularList=void 0;const l=n(8460),m=n(844);class a extends m.Disposable{constructor(u){super(),this._maxLength=u,this.onDeleteEmitter=this.register(new l.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new l.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new l.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(u){if(this._maxLength===u)return;const d=new Array(u);for(let f=0;f<Math.min(u,this.length);f++)d[f]=this._array[this._getCyclicIndex(f)];this._array=d,this._maxLength=u,this._startIndex=0}get length(){return this._length}set length(u){if(u>this._length)for(let d=this._length;d<u;d++)this._array[d]=void 0;this._length=u}get(u){return this._array[this._getCyclicIndex(u)]}set(u,d){this._array[this._getCyclicIndex(u)]=d}push(u){this._array[this._getCyclicIndex(this._length)]=u,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(u,d,...f){if(d){for(let t=u;t<this._length-d;t++)this._array[this._getCyclicIndex(t)]=this._array[this._getCyclicIndex(t+d)];this._length-=d,this.onDeleteEmitter.fire({index:u,amount:d})}for(let t=this._length-1;t>=u;t--)this._array[this._getCyclicIndex(t+f.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<f.length;t++)this._array[this._getCyclicIndex(u+t)]=f[t];if(f.length&&this.onInsertEmitter.fire({index:u,amount:f.length}),this._length+f.length>this._maxLength){const t=this._length+f.length-this._maxLength;this._startIndex+=t,this._length=this._maxLength,this.onTrimEmitter.fire(t)}else this._length+=f.length}trimStart(u){u>this._length&&(u=this._length),this._startIndex+=u,this._length-=u,this.onTrimEmitter.fire(u)}shiftElements(u,d,f){if(!(d<=0)){if(u<0||u>=this._length)throw new Error("start argument out of range");if(u+f<0)throw new Error("Cannot shift elements in list beyond index 0");if(f>0){for(let i=d-1;i>=0;i--)this.set(u+i+f,this.get(u+i));const t=u+d+f-this._length;if(t>0)for(this._length+=t;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let t=0;t<d;t++)this.set(u+t+f,this.get(u+t))}}_getCyclicIndex(u){return(this._startIndex+u)%this._maxLength}}r.CircularList=a},1439:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.clone=void 0,r.clone=function n(l,m=5){if(typeof l!="object")return l;const a=Array.isArray(l)?[]:{};for(const h in l)a[h]=m<=1?l[h]:l[h]&&n(l[h],m-1);return a}},8055:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.contrastRatio=r.toPaddedHex=r.rgba=r.rgb=r.css=r.color=r.channels=r.NULL_COLOR=void 0;const l=n(6114);let m=0,a=0,h=0,u=0;var d,f,t,i,s;function o(g){const C=g.toString(16);return C.length<2?"0"+C:C}function p(g,C){return g<C?(C+.05)/(g+.05):(g+.05)/(C+.05)}r.NULL_COLOR={css:"#00000000",rgba:0},function(g){g.toCss=function(C,T,_,k){return k!==void 0?`#${o(C)}${o(T)}${o(_)}${o(k)}`:`#${o(C)}${o(T)}${o(_)}`},g.toRgba=function(C,T,_,k=255){return(C<<24|T<<16|_<<8|k)>>>0}}(d||(r.channels=d={})),function(g){function C(T,_){return u=Math.round(255*_),[m,a,h]=s.toChannels(T.rgba),{css:d.toCss(m,a,h,u),rgba:d.toRgba(m,a,h,u)}}g.blend=function(T,_){if(u=(255&_.rgba)/255,u===1)return{css:_.css,rgba:_.rgba};const k=_.rgba>>24&255,D=_.rgba>>16&255,M=_.rgba>>8&255,S=T.rgba>>24&255,B=T.rgba>>16&255,H=T.rgba>>8&255;return m=S+Math.round((k-S)*u),a=B+Math.round((D-B)*u),h=H+Math.round((M-H)*u),{css:d.toCss(m,a,h),rgba:d.toRgba(m,a,h)}},g.isOpaque=function(T){return(255&T.rgba)==255},g.ensureContrastRatio=function(T,_,k){const D=s.ensureContrastRatio(T.rgba,_.rgba,k);if(D)return s.toColor(D>>24&255,D>>16&255,D>>8&255)},g.opaque=function(T){const _=(255|T.rgba)>>>0;return[m,a,h]=s.toChannels(_),{css:d.toCss(m,a,h),rgba:_}},g.opacity=C,g.multiplyOpacity=function(T,_){return u=255&T.rgba,C(T,u*_/255)},g.toColorRGB=function(T){return[T.rgba>>24&255,T.rgba>>16&255,T.rgba>>8&255]}}(f||(r.color=f={})),function(g){let C,T;if(!l.isNode){const _=document.createElement("canvas");_.width=1,_.height=1;const k=_.getContext("2d",{willReadFrequently:!0});k&&(C=k,C.globalCompositeOperation="copy",T=C.createLinearGradient(0,0,1,1))}g.toColor=function(_){if(_.match(/#[\da-f]{3,8}/i))switch(_.length){case 4:return m=parseInt(_.slice(1,2).repeat(2),16),a=parseInt(_.slice(2,3).repeat(2),16),h=parseInt(_.slice(3,4).repeat(2),16),s.toColor(m,a,h);case 5:return m=parseInt(_.slice(1,2).repeat(2),16),a=parseInt(_.slice(2,3).repeat(2),16),h=parseInt(_.slice(3,4).repeat(2),16),u=parseInt(_.slice(4,5).repeat(2),16),s.toColor(m,a,h,u);case 7:return{css:_,rgba:(parseInt(_.slice(1),16)<<8|255)>>>0};case 9:return{css:_,rgba:parseInt(_.slice(1),16)>>>0}}const k=_.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(k)return m=parseInt(k[1]),a=parseInt(k[2]),h=parseInt(k[3]),u=Math.round(255*(k[5]===void 0?1:parseFloat(k[5]))),s.toColor(m,a,h,u);if(!C||!T)throw new Error("css.toColor: Unsupported css format");if(C.fillStyle=T,C.fillStyle=_,typeof C.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(C.fillRect(0,0,1,1),[m,a,h,u]=C.getImageData(0,0,1,1).data,u!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(m,a,h,u),css:_}}}(t||(r.css=t={})),function(g){function C(T,_,k){const D=T/255,M=_/255,S=k/255;return .2126*(D<=.03928?D/12.92:Math.pow((D+.055)/1.055,2.4))+.7152*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.0722*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))}g.relativeLuminance=function(T){return C(T>>16&255,T>>8&255,255&T)},g.relativeLuminance2=C}(i||(r.rgb=i={})),function(g){function C(_,k,D){const M=_>>24&255,S=_>>16&255,B=_>>8&255;let H=k>>24&255,F=k>>16&255,O=k>>8&255,P=p(i.relativeLuminance2(H,F,O),i.relativeLuminance2(M,S,B));for(;P<D&&(H>0||F>0||O>0);)H-=Math.max(0,Math.ceil(.1*H)),F-=Math.max(0,Math.ceil(.1*F)),O-=Math.max(0,Math.ceil(.1*O)),P=p(i.relativeLuminance2(H,F,O),i.relativeLuminance2(M,S,B));return(H<<24|F<<16|O<<8|255)>>>0}function T(_,k,D){const M=_>>24&255,S=_>>16&255,B=_>>8&255;let H=k>>24&255,F=k>>16&255,O=k>>8&255,P=p(i.relativeLuminance2(H,F,O),i.relativeLuminance2(M,S,B));for(;P<D&&(H<255||F<255||O<255);)H=Math.min(255,H+Math.ceil(.1*(255-H))),F=Math.min(255,F+Math.ceil(.1*(255-F))),O=Math.min(255,O+Math.ceil(.1*(255-O))),P=p(i.relativeLuminance2(H,F,O),i.relativeLuminance2(M,S,B));return(H<<24|F<<16|O<<8|255)>>>0}g.ensureContrastRatio=function(_,k,D){const M=i.relativeLuminance(_>>8),S=i.relativeLuminance(k>>8);if(p(M,S)<D){if(S<M){const F=C(_,k,D),O=p(M,i.relativeLuminance(F>>8));if(O<D){const P=T(_,k,D);return O>p(M,i.relativeLuminance(P>>8))?F:P}return F}const B=T(_,k,D),H=p(M,i.relativeLuminance(B>>8));if(H<D){const F=C(_,k,D);return H>p(M,i.relativeLuminance(F>>8))?B:F}return B}},g.reduceLuminance=C,g.increaseLuminance=T,g.toChannels=function(_){return[_>>24&255,_>>16&255,_>>8&255,255&_]},g.toColor=function(_,k,D,M){return{css:d.toCss(_,k,D,M),rgba:d.toRgba(_,k,D,M)}}}(s||(r.rgba=s={})),r.toPaddedHex=o,r.contrastRatio=p},8969:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CoreTerminal=void 0;const l=n(844),m=n(2585),a=n(4348),h=n(7866),u=n(744),d=n(7302),f=n(6975),t=n(8460),i=n(1753),s=n(1480),o=n(7994),p=n(9282),g=n(5435),C=n(5981),T=n(2660);let _=!1;class k extends l.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new t.EventEmitter),this._onScroll.event(M=>{var S;(S=this._onScrollApi)===null||S===void 0||S.fire(M.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(M){for(const S in M)this.optionsService.options[S]=M[S]}constructor(M){super(),this._windowsWrappingHeuristics=this.register(new l.MutableDisposable),this._onBinary=this.register(new t.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new t.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new t.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new t.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new t.EventEmitter),this._instantiationService=new a.InstantiationService,this.optionsService=this.register(new d.OptionsService(M)),this._instantiationService.setService(m.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(u.BufferService)),this._instantiationService.setService(m.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(m.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(f.CoreService)),this._instantiationService.setService(m.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(i.CoreMouseService)),this._instantiationService.setService(m.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(s.UnicodeService)),this._instantiationService.setService(m.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(o.CharsetService),this._instantiationService.setService(m.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(T.OscLinkService),this._instantiationService.setService(m.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new g.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,t.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,t.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,t.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,t.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(S=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(S=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new C.WriteBuffer((S,B)=>this._inputHandler.parse(S,B))),this.register((0,t.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(M,S){this._writeBuffer.write(M,S)}writeSync(M,S){this._logService.logLevel<=m.LogLevelEnum.WARN&&!_&&(this._logService.warn("writeSync is unreliable and will be removed soon."),_=!0),this._writeBuffer.writeSync(M,S)}resize(M,S){isNaN(M)||isNaN(S)||(M=Math.max(M,u.MINIMUM_COLS),S=Math.max(S,u.MINIMUM_ROWS),this._bufferService.resize(M,S))}scroll(M,S=!1){this._bufferService.scroll(M,S)}scrollLines(M,S,B){this._bufferService.scrollLines(M,S,B)}scrollPages(M){this.scrollLines(M*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(M){const S=M-this._bufferService.buffer.ydisp;S!==0&&this.scrollLines(S)}registerEscHandler(M,S){return this._inputHandler.registerEscHandler(M,S)}registerDcsHandler(M,S){return this._inputHandler.registerDcsHandler(M,S)}registerCsiHandler(M,S){return this._inputHandler.registerCsiHandler(M,S)}registerOscHandler(M,S){return this._inputHandler.registerOscHandler(M,S)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let M=!1;const S=this.optionsService.rawOptions.windowsPty;S&&S.buildNumber!==void 0&&S.buildNumber!==void 0?M=S.backend==="conpty"&&S.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(M=!0),M?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const M=[];M.push(this.onLineFeed(p.updateWindowsModeWrappedState.bind(null,this._bufferService))),M.push(this.registerCsiHandler({final:"H"},()=>((0,p.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,l.toDisposable)(()=>{for(const S of M)S.dispose()})}}}r.CoreTerminal=k},8460:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.forwardEvent=r.EventEmitter=void 0,r.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===n)return void this._listeners.splice(l,1)}}})),this._event}fire(n,l){const m=[];for(let a=0;a<this._listeners.length;a++)m.push(this._listeners[a]);for(let a=0;a<m.length;a++)m[a].call(void 0,n,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},r.forwardEvent=function(n,l){return n(m=>l.fire(m))}},5435:function(x,r,n){var l=this&&this.__decorate||function(P,L,I,A){var N,z=arguments.length,j=z<3?L:A===null?A=Object.getOwnPropertyDescriptor(L,I):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(P,L,I,A);else for(var V=P.length-1;V>=0;V--)(N=P[V])&&(j=(z<3?N(j):z>3?N(L,I,j):N(L,I))||j);return z>3&&j&&Object.defineProperty(L,I,j),j},m=this&&this.__param||function(P,L){return function(I,A){L(I,A,P)}};Object.defineProperty(r,"__esModule",{value:!0}),r.InputHandler=r.WindowsOptionsReportType=void 0;const a=n(2584),h=n(7116),u=n(2015),d=n(844),f=n(482),t=n(8437),i=n(8460),s=n(643),o=n(511),p=n(3734),g=n(2585),C=n(6242),T=n(6351),_=n(5941),k={"(":0,")":1,"*":2,"+":3,"-":1,".":2},D=131072;function M(P,L){if(P>24)return L.setWinLines||!1;switch(P){case 1:return!!L.restoreWin;case 2:return!!L.minimizeWin;case 3:return!!L.setWinPosition;case 4:return!!L.setWinSizePixels;case 5:return!!L.raiseWin;case 6:return!!L.lowerWin;case 7:return!!L.refreshWin;case 8:return!!L.setWinSizeChars;case 9:return!!L.maximizeWin;case 10:return!!L.fullscreenWin;case 11:return!!L.getWinState;case 13:return!!L.getWinPosition;case 14:return!!L.getWinSizePixels;case 15:return!!L.getScreenSizePixels;case 16:return!!L.getCellSizePixels;case 18:return!!L.getWinSizeChars;case 19:return!!L.getScreenSizeChars;case 20:return!!L.getIconTitle;case 21:return!!L.getWinTitle;case 22:return!!L.pushTitle;case 23:return!!L.popTitle;case 24:return!!L.setWinLines}return!1}var S;(function(P){P[P.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",P[P.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(S||(r.WindowsOptionsReportType=S={}));let B=0;class H extends d.Disposable{getAttrData(){return this._curAttrData}constructor(L,I,A,N,z,j,V,q,Z=new u.EscapeSequenceParser){super(),this._bufferService=L,this._charsetService=I,this._coreService=A,this._logService=N,this._optionsService=z,this._oscLinkService=j,this._coreMouseService=V,this._unicodeService=q,this._parser=Z,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new f.StringToUtf32,this._utf8Decoder=new f.Utf8ToUtf32,this._workCell=new o.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new i.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new i.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new i.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new i.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new i.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new i.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new i.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new i.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new i.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new i.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new i.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new i.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new i.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new F(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._parser.setCsiHandlerFallback((R,$)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(R),params:$.toArray()})}),this._parser.setEscHandlerFallback(R=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(R)})}),this._parser.setExecuteHandlerFallback(R=>{this._logService.debug("Unknown EXECUTE code: ",{code:R})}),this._parser.setOscHandlerFallback((R,$,X)=>{this._logService.debug("Unknown OSC code: ",{identifier:R,action:$,data:X})}),this._parser.setDcsHandlerFallback((R,$,X)=>{$==="HOOK"&&(X=X.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(R),action:$,payload:X})}),this._parser.setPrintHandler((R,$,X)=>this.print(R,$,X)),this._parser.registerCsiHandler({final:"@"},R=>this.insertChars(R)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},R=>this.scrollLeft(R)),this._parser.registerCsiHandler({final:"A"},R=>this.cursorUp(R)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},R=>this.scrollRight(R)),this._parser.registerCsiHandler({final:"B"},R=>this.cursorDown(R)),this._parser.registerCsiHandler({final:"C"},R=>this.cursorForward(R)),this._parser.registerCsiHandler({final:"D"},R=>this.cursorBackward(R)),this._parser.registerCsiHandler({final:"E"},R=>this.cursorNextLine(R)),this._parser.registerCsiHandler({final:"F"},R=>this.cursorPrecedingLine(R)),this._parser.registerCsiHandler({final:"G"},R=>this.cursorCharAbsolute(R)),this._parser.registerCsiHandler({final:"H"},R=>this.cursorPosition(R)),this._parser.registerCsiHandler({final:"I"},R=>this.cursorForwardTab(R)),this._parser.registerCsiHandler({final:"J"},R=>this.eraseInDisplay(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},R=>this.eraseInDisplay(R,!0)),this._parser.registerCsiHandler({final:"K"},R=>this.eraseInLine(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},R=>this.eraseInLine(R,!0)),this._parser.registerCsiHandler({final:"L"},R=>this.insertLines(R)),this._parser.registerCsiHandler({final:"M"},R=>this.deleteLines(R)),this._parser.registerCsiHandler({final:"P"},R=>this.deleteChars(R)),this._parser.registerCsiHandler({final:"S"},R=>this.scrollUp(R)),this._parser.registerCsiHandler({final:"T"},R=>this.scrollDown(R)),this._parser.registerCsiHandler({final:"X"},R=>this.eraseChars(R)),this._parser.registerCsiHandler({final:"Z"},R=>this.cursorBackwardTab(R)),this._parser.registerCsiHandler({final:"`"},R=>this.charPosAbsolute(R)),this._parser.registerCsiHandler({final:"a"},R=>this.hPositionRelative(R)),this._parser.registerCsiHandler({final:"b"},R=>this.repeatPrecedingCharacter(R)),this._parser.registerCsiHandler({final:"c"},R=>this.sendDeviceAttributesPrimary(R)),this._parser.registerCsiHandler({prefix:">",final:"c"},R=>this.sendDeviceAttributesSecondary(R)),this._parser.registerCsiHandler({final:"d"},R=>this.linePosAbsolute(R)),this._parser.registerCsiHandler({final:"e"},R=>this.vPositionRelative(R)),this._parser.registerCsiHandler({final:"f"},R=>this.hVPosition(R)),this._parser.registerCsiHandler({final:"g"},R=>this.tabClear(R)),this._parser.registerCsiHandler({final:"h"},R=>this.setMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"h"},R=>this.setModePrivate(R)),this._parser.registerCsiHandler({final:"l"},R=>this.resetMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"l"},R=>this.resetModePrivate(R)),this._parser.registerCsiHandler({final:"m"},R=>this.charAttributes(R)),this._parser.registerCsiHandler({final:"n"},R=>this.deviceStatus(R)),this._parser.registerCsiHandler({prefix:"?",final:"n"},R=>this.deviceStatusPrivate(R)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},R=>this.softReset(R)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},R=>this.setCursorStyle(R)),this._parser.registerCsiHandler({final:"r"},R=>this.setScrollRegion(R)),this._parser.registerCsiHandler({final:"s"},R=>this.saveCursor(R)),this._parser.registerCsiHandler({final:"t"},R=>this.windowOptions(R)),this._parser.registerCsiHandler({final:"u"},R=>this.restoreCursor(R)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},R=>this.insertColumns(R)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},R=>this.deleteColumns(R)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},R=>this.selectProtected(R)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},R=>this.requestMode(R,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},R=>this.requestMode(R,!1)),this._parser.setExecuteHandler(a.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(a.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(a.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(a.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(a.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(a.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(a.C1.IND,()=>this.index()),this._parser.setExecuteHandler(a.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(a.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new C.OscHandler(R=>(this.setTitle(R),this.setIconName(R),!0))),this._parser.registerOscHandler(1,new C.OscHandler(R=>this.setIconName(R))),this._parser.registerOscHandler(2,new C.OscHandler(R=>this.setTitle(R))),this._parser.registerOscHandler(4,new C.OscHandler(R=>this.setOrReportIndexedColor(R))),this._parser.registerOscHandler(8,new C.OscHandler(R=>this.setHyperlink(R))),this._parser.registerOscHandler(10,new C.OscHandler(R=>this.setOrReportFgColor(R))),this._parser.registerOscHandler(11,new C.OscHandler(R=>this.setOrReportBgColor(R))),this._parser.registerOscHandler(12,new C.OscHandler(R=>this.setOrReportCursorColor(R))),this._parser.registerOscHandler(104,new C.OscHandler(R=>this.restoreIndexedColor(R))),this._parser.registerOscHandler(110,new C.OscHandler(R=>this.restoreFgColor(R))),this._parser.registerOscHandler(111,new C.OscHandler(R=>this.restoreBgColor(R))),this._parser.registerOscHandler(112,new C.OscHandler(R=>this.restoreCursorColor(R))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const R in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:R},()=>this.selectCharset("("+R)),this._parser.registerEscHandler({intermediates:")",final:R},()=>this.selectCharset(")"+R)),this._parser.registerEscHandler({intermediates:"*",final:R},()=>this.selectCharset("*"+R)),this._parser.registerEscHandler({intermediates:"+",final:R},()=>this.selectCharset("+"+R)),this._parser.registerEscHandler({intermediates:"-",final:R},()=>this.selectCharset("-"+R)),this._parser.registerEscHandler({intermediates:".",final:R},()=>this.selectCharset("."+R)),this._parser.registerEscHandler({intermediates:"/",final:R},()=>this.selectCharset("/"+R));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(R=>(this._logService.error("Parsing error: ",R),R)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new T.DcsHandler((R,$)=>this.requestStatusString(R,$)))}_preserveStack(L,I,A,N){this._parseStack.paused=!0,this._parseStack.cursorStartX=L,this._parseStack.cursorStartY=I,this._parseStack.decodedLength=A,this._parseStack.position=N}_logSlowResolvingAsync(L){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([L,new Promise((I,A)=>setTimeout(()=>A("#SLOW_TIMEOUT"),5e3))]).catch(I=>{if(I!=="#SLOW_TIMEOUT")throw I;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(L,I){let A,N=this._activeBuffer.x,z=this._activeBuffer.y,j=0;const V=this._parseStack.paused;if(V){if(A=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,I))return this._logSlowResolvingAsync(A),A;N=this._parseStack.cursorStartX,z=this._parseStack.cursorStartY,this._parseStack.paused=!1,L.length>D&&(j=this._parseStack.position+D)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof L=="string"?` "${L}"`:` "${Array.prototype.map.call(L,q=>String.fromCharCode(q)).join("")}"`),typeof L=="string"?L.split("").map(q=>q.charCodeAt(0)):L),this._parseBuffer.length<L.length&&this._parseBuffer.length<D&&(this._parseBuffer=new Uint32Array(Math.min(L.length,D))),V||this._dirtyRowTracker.clearRange(),L.length>D)for(let q=j;q<L.length;q+=D){const Z=q+D<L.length?q+D:L.length,R=typeof L=="string"?this._stringDecoder.decode(L.substring(q,Z),this._parseBuffer):this._utf8Decoder.decode(L.subarray(q,Z),this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,R))return this._preserveStack(N,z,R,q),this._logSlowResolvingAsync(A),A}else if(!V){const q=typeof L=="string"?this._stringDecoder.decode(L,this._parseBuffer):this._utf8Decoder.decode(L,this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,q))return this._preserveStack(N,z,q,0),this._logSlowResolvingAsync(A),A}this._activeBuffer.x===N&&this._activeBuffer.y===z||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(L,I,A){let N,z;const j=this._charsetService.charset,V=this._optionsService.rawOptions.screenReaderMode,q=this._bufferService.cols,Z=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,$=this._curAttrData;let X=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&A-I>0&&X.getWidth(this._activeBuffer.x-1)===2&&X.setCellFromCodePoint(this._activeBuffer.x-1,0,1,$.fg,$.bg,$.extended);for(let U=I;U<A;++U){if(N=L[U],z=this._unicodeService.wcwidth(N),N<127&&j){const Y=j[String.fromCharCode(N)];Y&&(N=Y.charCodeAt(0))}if(V&&this._onA11yChar.fire((0,f.stringFromCodePoint)(N)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),z||!this._activeBuffer.x){if(this._activeBuffer.x+z-1>=q){if(Z){for(;this._activeBuffer.x<q;)X.setCellFromCodePoint(this._activeBuffer.x++,0,1,$.fg,$.bg,$.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),X=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=q-1,z===2)continue}if(R&&(X.insertCells(this._activeBuffer.x,z,this._activeBuffer.getNullCell($),$),X.getWidth(q-1)===2&&X.setCellFromCodePoint(q-1,s.NULL_CELL_CODE,s.NULL_CELL_WIDTH,$.fg,$.bg,$.extended)),X.setCellFromCodePoint(this._activeBuffer.x++,N,z,$.fg,$.bg,$.extended),z>0)for(;--z;)X.setCellFromCodePoint(this._activeBuffer.x++,0,0,$.fg,$.bg,$.extended)}else X.getWidth(this._activeBuffer.x-1)?X.addCodepointToCell(this._activeBuffer.x-1,N):X.addCodepointToCell(this._activeBuffer.x-2,N)}A-I>0&&(X.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<q&&A-I>0&&X.getWidth(this._activeBuffer.x)===0&&!X.hasContent(this._activeBuffer.x)&&X.setCellFromCodePoint(this._activeBuffer.x,0,1,$.fg,$.bg,$.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(L,I){return L.final!=="t"||L.prefix||L.intermediates?this._parser.registerCsiHandler(L,I):this._parser.registerCsiHandler(L,A=>!M(A.params[0],this._optionsService.rawOptions.windowOptions)||I(A))}registerDcsHandler(L,I){return this._parser.registerDcsHandler(L,new T.DcsHandler(I))}registerEscHandler(L,I){return this._parser.registerEscHandler(L,I)}registerOscHandler(L,I){return this._parser.registerOscHandler(L,new C.OscHandler(I))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var L;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||L===void 0)&&L.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);I.hasWidth(this._activeBuffer.x)&&!I.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const L=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-L),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(L=this._bufferService.cols-1){this._activeBuffer.x=Math.min(L,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(L,I){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=L,this._activeBuffer.y=this._activeBuffer.scrollTop+I):(this._activeBuffer.x=L,this._activeBuffer.y=I),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(L,I){this._restrictCursor(),this._setCursor(this._activeBuffer.x+L,this._activeBuffer.y+I)}cursorUp(L){const I=this._activeBuffer.y-this._activeBuffer.scrollTop;return I>=0?this._moveCursor(0,-Math.min(I,L.params[0]||1)):this._moveCursor(0,-(L.params[0]||1)),!0}cursorDown(L){const I=this._activeBuffer.scrollBottom-this._activeBuffer.y;return I>=0?this._moveCursor(0,Math.min(I,L.params[0]||1)):this._moveCursor(0,L.params[0]||1),!0}cursorForward(L){return this._moveCursor(L.params[0]||1,0),!0}cursorBackward(L){return this._moveCursor(-(L.params[0]||1),0),!0}cursorNextLine(L){return this.cursorDown(L),this._activeBuffer.x=0,!0}cursorPrecedingLine(L){return this.cursorUp(L),this._activeBuffer.x=0,!0}cursorCharAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(L){return this._setCursor(L.length>=2?(L.params[1]||1)-1:0,(L.params[0]||1)-1),!0}charPosAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(L){return this._moveCursor(L.params[0]||1,0),!0}linePosAbsolute(L){return this._setCursor(this._activeBuffer.x,(L.params[0]||1)-1),!0}vPositionRelative(L){return this._moveCursor(0,L.params[0]||1),!0}hVPosition(L){return this.cursorPosition(L),!0}tabClear(L){const I=L.params[0];return I===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:I===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=L.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=L.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(L){const I=L.params[0];return I===1&&(this._curAttrData.bg|=536870912),I!==2&&I!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(L,I,A,N=!1,z=!1){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);j.replaceCells(I,A,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),z),N&&(j.isWrapped=!1)}_resetBufferLine(L,I=!1){const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);A&&(A.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),I),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+L),A.isWrapped=!1)}eraseInDisplay(L,I=!1){let A;switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);A<this._bufferService.rows;A++)this._resetBufferLine(A,I);this._dirtyRowTracker.markDirty(A);break;case 1:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A,0,this._activeBuffer.x+1,!0,I),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(A+1).isWrapped=!1);A--;)this._resetBufferLine(A,I);this._dirtyRowTracker.markDirty(0);break;case 2:for(A=this._bufferService.rows,this._dirtyRowTracker.markDirty(A-1);A--;)this._resetBufferLine(A,I);this._dirtyRowTracker.markDirty(0);break;case 3:const N=this._activeBuffer.lines.length-this._bufferService.rows;N>0&&(this._activeBuffer.lines.trimStart(N),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-N,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-N,0),this._onScroll.fire(0))}return!0}eraseInLine(L,I=!1){switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,I);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,I)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(L){this._restrictCursor();let I=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y,N=this._bufferService.rows-1-this._activeBuffer.scrollBottom,z=this._bufferService.rows-1+this._activeBuffer.ybase-N+1;for(;I--;)this._activeBuffer.lines.splice(z-1,1),this._activeBuffer.lines.splice(A,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(L){this._restrictCursor();let I=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y;let N;for(N=this._bufferService.rows-1-this._activeBuffer.scrollBottom,N=this._bufferService.rows-1+this._activeBuffer.ybase-N;I--;)this._activeBuffer.lines.splice(A,1),this._activeBuffer.lines.splice(N,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(L){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.insertCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(L){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.deleteCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(L){let I=L.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(L){let I=L.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(t.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);N.deleteCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);N.insertCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);N.insertCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);N.deleteCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(L){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(L.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(L){if(!this._parser.precedingCodepoint)return!0;const I=L.params[0]||1,A=new Uint32Array(I);for(let N=0;N<I;++N)A[N]=this._parser.precedingCodepoint;return this.print(A,0,A.length),!0}sendDeviceAttributesPrimary(L){return L.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(a.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(a.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(L){return L.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(a.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(a.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(L.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(a.C0.ESC+"[>83;40003;0c")),!0}_is(L){return(this._optionsService.rawOptions.termName+"").indexOf(L)===0}setMode(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),L.params[I]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(L,I){const A=this._coreService.decPrivateModes,{activeProtocol:N,activeEncoding:z}=this._coreMouseService,j=this._coreService,{buffers:V,cols:q}=this._bufferService,{active:Z,alt:R}=V,$=this._optionsService.rawOptions,X=te=>te?1:2,U=L.params[0];return Y=U,W=I?U===2?4:U===4?X(j.modes.insertMode):U===12?3:U===20?X($.convertEol):0:U===1?X(A.applicationCursorKeys):U===3?$.windowOptions.setWinLines?q===80?2:q===132?1:0:0:U===6?X(A.origin):U===7?X(A.wraparound):U===8?3:U===9?X(N==="X10"):U===12?X($.cursorBlink):U===25?X(!j.isCursorHidden):U===45?X(A.reverseWraparound):U===66?X(A.applicationKeypad):U===67?4:U===1e3?X(N==="VT200"):U===1002?X(N==="DRAG"):U===1003?X(N==="ANY"):U===1004?X(A.sendFocus):U===1005?4:U===1006?X(z==="SGR"):U===1015?4:U===1016?X(z==="SGR_PIXELS"):U===1048?1:U===47||U===1047||U===1049?X(Z===R):U===2004?X(A.bracketedPasteMode):0,j.triggerDataEvent(`${a.C0.ESC}[${I?"":"?"}${Y};${W}$y`),!0;var Y,W}_updateAttrColor(L,I,A,N,z){return I===2?(L|=50331648,L&=-16777216,L|=p.AttributeData.fromColorRGB([A,N,z])):I===5&&(L&=-50331904,L|=33554432|255&A),L}_extractColor(L,I,A){const N=[0,0,-1,0,0,0];let z=0,j=0;do{if(N[j+z]=L.params[I+j],L.hasSubParams(I+j)){const V=L.getSubParams(I+j);let q=0;do N[1]===5&&(z=1),N[j+q+1+z]=V[q];while(++q<V.length&&q+j+1+z<N.length);break}if(N[1]===5&&j+z>=2||N[1]===2&&j+z>=5)break;N[1]&&(z=1)}while(++j+I<L.length&&j+z<N.length);for(let V=2;V<N.length;++V)N[V]===-1&&(N[V]=0);switch(N[0]){case 38:A.fg=this._updateAttrColor(A.fg,N[1],N[3],N[4],N[5]);break;case 48:A.bg=this._updateAttrColor(A.bg,N[1],N[3],N[4],N[5]);break;case 58:A.extended=A.extended.clone(),A.extended.underlineColor=this._updateAttrColor(A.extended.underlineColor,N[1],N[3],N[4],N[5])}return j}_processUnderline(L,I){I.extended=I.extended.clone(),(!~L||L>5)&&(L=1),I.extended.underlineStyle=L,I.fg|=268435456,L===0&&(I.fg&=-268435457),I.updateExtended()}_processSGR0(L){L.fg=t.DEFAULT_ATTR_DATA.fg,L.bg=t.DEFAULT_ATTR_DATA.bg,L.extended=L.extended.clone(),L.extended.underlineStyle=0,L.extended.underlineColor&=-67108864,L.updateExtended()}charAttributes(L){if(L.length===1&&L.params[0]===0)return this._processSGR0(this._curAttrData),!0;const I=L.length;let A;const N=this._curAttrData;for(let z=0;z<I;z++)A=L.params[z],A>=30&&A<=37?(N.fg&=-50331904,N.fg|=16777216|A-30):A>=40&&A<=47?(N.bg&=-50331904,N.bg|=16777216|A-40):A>=90&&A<=97?(N.fg&=-50331904,N.fg|=16777224|A-90):A>=100&&A<=107?(N.bg&=-50331904,N.bg|=16777224|A-100):A===0?this._processSGR0(N):A===1?N.fg|=134217728:A===3?N.bg|=67108864:A===4?(N.fg|=268435456,this._processUnderline(L.hasSubParams(z)?L.getSubParams(z)[0]:1,N)):A===5?N.fg|=536870912:A===7?N.fg|=67108864:A===8?N.fg|=1073741824:A===9?N.fg|=2147483648:A===2?N.bg|=134217728:A===21?this._processUnderline(2,N):A===22?(N.fg&=-134217729,N.bg&=-134217729):A===23?N.bg&=-67108865:A===24?(N.fg&=-268435457,this._processUnderline(0,N)):A===25?N.fg&=-536870913:A===27?N.fg&=-67108865:A===28?N.fg&=-1073741825:A===29?N.fg&=2147483647:A===39?(N.fg&=-67108864,N.fg|=16777215&t.DEFAULT_ATTR_DATA.fg):A===49?(N.bg&=-67108864,N.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):A===38||A===48||A===58?z+=this._extractColor(L,z,N):A===53?N.bg|=1073741824:A===55?N.bg&=-1073741825:A===59?(N.extended=N.extended.clone(),N.extended.underlineColor=-1,N.updateExtended()):A===100?(N.fg&=-67108864,N.fg|=16777215&t.DEFAULT_ATTR_DATA.fg,N.bg&=-67108864,N.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",A);return!0}deviceStatus(L){switch(L.params[0]){case 5:this._coreService.triggerDataEvent(`${a.C0.ESC}[0n`);break;case 6:const I=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[${I};${A}R`)}return!0}deviceStatusPrivate(L){if(L.params[0]===6){const I=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[?${I};${A}R`)}return!0}softReset(L){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(L){const I=L.params[0]||1;switch(I){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const A=I%2==1;return this._optionsService.options.cursorBlink=A,!0}setScrollRegion(L){const I=L.params[0]||1;let A;return(L.length<2||(A=L.params[1])>this._bufferService.rows||A===0)&&(A=this._bufferService.rows),A>I&&(this._activeBuffer.scrollTop=I-1,this._activeBuffer.scrollBottom=A-1,this._setCursor(0,0)),!0}windowOptions(L){if(!M(L.params[0],this._optionsService.rawOptions.windowOptions))return!0;const I=L.length>1?L.params[1]:0;switch(L.params[0]){case 14:I!==2&&this._onRequestWindowsOptionsReport.fire(S.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(S.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${a.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:I!==0&&I!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),I!==0&&I!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:I!==0&&I!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),I!==0&&I!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(L){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(L){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(L){return this._windowTitle=L,this._onTitleChange.fire(L),!0}setIconName(L){return this._iconName=L,!0}setOrReportIndexedColor(L){const I=[],A=L.split(";");for(;A.length>1;){const N=A.shift(),z=A.shift();if(/^\d+$/.exec(N)){const j=parseInt(N);if(O(j))if(z==="?")I.push({type:0,index:j});else{const V=(0,_.parseColor)(z);V&&I.push({type:1,index:j,color:V})}}}return I.length&&this._onColor.fire(I),!0}setHyperlink(L){const I=L.split(";");return!(I.length<2)&&(I[1]?this._createHyperlink(I[0],I[1]):!I[0]&&this._finishHyperlink())}_createHyperlink(L,I){this._getCurrentLinkId()&&this._finishHyperlink();const A=L.split(":");let N;const z=A.findIndex(j=>j.startsWith("id="));return z!==-1&&(N=A[z].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:N,uri:I}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(L,I){const A=L.split(";");for(let N=0;N<A.length&&!(I>=this._specialColors.length);++N,++I)if(A[N]==="?")this._onColor.fire([{type:0,index:this._specialColors[I]}]);else{const z=(0,_.parseColor)(A[N]);z&&this._onColor.fire([{type:1,index:this._specialColors[I],color:z}])}return!0}setOrReportFgColor(L){return this._setOrReportSpecialColor(L,0)}setOrReportBgColor(L){return this._setOrReportSpecialColor(L,1)}setOrReportCursorColor(L){return this._setOrReportSpecialColor(L,2)}restoreIndexedColor(L){if(!L)return this._onColor.fire([{type:2}]),!0;const I=[],A=L.split(";");for(let N=0;N<A.length;++N)if(/^\d+$/.exec(A[N])){const z=parseInt(A[N]);O(z)&&I.push({type:2,index:z})}return I.length&&this._onColor.fire(I),!0}restoreFgColor(L){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(L){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(L){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(L){return L.length!==2?(this.selectDefaultCharset(),!0):(L[0]==="/"||this._charsetService.setgCharset(k[L[0]],h.CHARSETS[L[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const L=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,L,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(L){return this._charsetService.setgLevel(L),!0}screenAlignmentPattern(){const L=new o.CellData;L.content=4194304|"E".charCodeAt(0),L.fg=this._curAttrData.fg,L.bg=this._curAttrData.bg,this._setCursor(0,0);for(let I=0;I<this._bufferService.rows;++I){const A=this._activeBuffer.ybase+this._activeBuffer.y+I,N=this._activeBuffer.lines.get(A);N&&(N.fill(L),N.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(L,I){const A=this._bufferService.buffer,N=this._optionsService.rawOptions;return(z=>(this._coreService.triggerDataEvent(`${a.C0.ESC}${z}${a.C0.ESC}\\`),!0))(L==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:L==='"p'?'P1$r61;1"p':L==="r"?`P1$r${A.scrollTop+1};${A.scrollBottom+1}r`:L==="m"?"P1$r0m":L===" q"?`P1$r${{block:2,underline:4,bar:6}[N.cursorStyle]-(N.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(L,I){this._dirtyRowTracker.markRangeDirty(L,I)}}r.InputHandler=H;let F=class{constructor(P){this._bufferService=P,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(P){P<this.start?this.start=P:P>this.end&&(this.end=P)}markRangeDirty(P,L){P>L&&(B=P,P=L,L=B),P<this.start&&(this.start=P),L>this.end&&(this.end=L)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function O(P){return 0<=P&&P<256}F=l([m(0,g.IBufferService)],F)},844:(x,r)=>{function n(l){for(const m of l)m.dispose();l.length=0}Object.defineProperty(r,"__esModule",{value:!0}),r.getDisposeArrayDisposable=r.disposeArray=r.toDisposable=r.MutableDisposable=r.Disposable=void 0,r.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const m=this._disposables.indexOf(l);m!==-1&&this._disposables.splice(m,1)}},r.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(l){var m;this._isDisposed||l===this._value||((m=this._value)===null||m===void 0||m.dispose(),this._value=l)}clear(){this.value=void 0}dispose(){var l;this._isDisposed=!0,(l=this._value)===null||l===void 0||l.dispose(),this._value=void 0}},r.toDisposable=function(l){return{dispose:l}},r.disposeArray=n,r.getDisposeArrayDisposable=function(l){return{dispose:()=>n(l)}}},1505:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FourKeyMap=r.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(m,a,h){this._data[m]||(this._data[m]={}),this._data[m][a]=h}get(m,a){return this._data[m]?this._data[m][a]:void 0}clear(){this._data={}}}r.TwoKeyMap=n,r.FourKeyMap=class{constructor(){this._data=new n}set(l,m,a,h,u){this._data.get(l,m)||this._data.set(l,m,new n),this._data.get(l,m).set(a,h,u)}get(l,m,a,h){var u;return(u=this._data.get(l,m))===null||u===void 0?void 0:u.get(a,h)}clear(){this._data.clear()}}},6114:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isChromeOS=r.isLinux=r.isWindows=r.isIphone=r.isIpad=r.isMac=r.getSafariVersion=r.isSafari=r.isLegacyEdge=r.isFirefox=r.isNode=void 0,r.isNode=typeof navigator>"u";const n=r.isNode?"node":navigator.userAgent,l=r.isNode?"node":navigator.platform;r.isFirefox=n.includes("Firefox"),r.isLegacyEdge=n.includes("Edge"),r.isSafari=/^((?!chrome|android).)*safari/i.test(n),r.getSafariVersion=function(){if(!r.isSafari)return 0;const m=n.match(/Version\/(\d+)/);return m===null||m.length<2?0:parseInt(m[1])},r.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),r.isIpad=l==="iPad",r.isIphone=l==="iPhone",r.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),r.isLinux=l.indexOf("Linux")>=0,r.isChromeOS=/\bCrOS\b/.test(n)},6106:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SortedList=void 0;let n=0;r.SortedList=class{constructor(l){this._getKey=l,this._array=[]}clear(){this._array.length=0}insert(l){this._array.length!==0?(n=this._search(this._getKey(l)),this._array.splice(n,0,l)):this._array.push(l)}delete(l){if(this._array.length===0)return!1;const m=this._getKey(l);if(m===void 0||(n=this._search(m),n===-1)||this._getKey(this._array[n])!==m)return!1;do if(this._array[n]===l)return this._array.splice(n,1),!0;while(++n<this._array.length&&this._getKey(this._array[n])===m);return!1}*getKeyIterator(l){if(this._array.length!==0&&(n=this._search(l),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===l))do yield this._array[n];while(++n<this._array.length&&this._getKey(this._array[n])===l)}forEachByKey(l,m){if(this._array.length!==0&&(n=this._search(l),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===l))do m(this._array[n]);while(++n<this._array.length&&this._getKey(this._array[n])===l)}values(){return[...this._array].values()}_search(l){let m=0,a=this._array.length-1;for(;a>=m;){let h=m+a>>1;const u=this._getKey(this._array[h]);if(u>l)a=h-1;else{if(!(u<l)){for(;h>0&&this._getKey(this._array[h-1])===l;)h--;return h}m=h+1}}return m}}},7226:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DebouncedIdleTask=r.IdleTaskQueue=r.PriorityTaskQueue=void 0;const l=n(6114);class m{constructor(){this._tasks=[],this._i=0}enqueue(u){this._tasks.push(u),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(u){this._idleCallback=void 0;let d=0,f=0,t=u.timeRemaining(),i=0;for(;this._i<this._tasks.length;){if(d=Date.now(),this._tasks[this._i]()||this._i++,d=Math.max(1,Date.now()-d),f=Math.max(d,f),i=u.timeRemaining(),1.5*f>i)return t-d<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-d))}ms`),void this._start();t=i}this.clear()}}class a extends m{_requestCallback(u){return setTimeout(()=>u(this._createDeadline(16)))}_cancelCallback(u){clearTimeout(u)}_createDeadline(u){const d=Date.now()+u;return{timeRemaining:()=>Math.max(0,d-Date.now())}}}r.PriorityTaskQueue=a,r.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends m{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:a,r.DebouncedIdleTask=class{constructor(){this._queue=new r.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.updateWindowsModeWrappedState=void 0;const l=n(643);r.updateWindowsModeWrappedState=function(m){const a=m.buffer.lines.get(m.buffer.ybase+m.buffer.y-1),h=a==null?void 0:a.get(m.cols-1),u=m.buffer.lines.get(m.buffer.ybase+m.buffer.y);u&&h&&(u.isWrapped=h[l.CHAR_DATA_CODE_INDEX]!==l.NULL_CELL_CODE&&h[l.CHAR_DATA_CODE_INDEX]!==l.WHITESPACE_CELL_CODE)}},3734:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ExtendedAttrs=r.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(a){return[a>>>16&255,a>>>8&255,255&a]}static fromColorRGB(a){return(255&a[0])<<16|(255&a[1])<<8|255&a[2]}clone(){const a=new n;return a.fg=this.fg,a.bg=this.bg,a.extended=this.extended.clone(),a}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}r.AttributeData=n;class l{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(a){this._ext=a}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(a){this._ext&=-469762049,this._ext|=a<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(a){this._ext&=-67108864,this._ext|=67108863&a}get urlId(){return this._urlId}set urlId(a){this._urlId=a}constructor(a=0,h=0){this._ext=0,this._urlId=0,this._ext=a,this._urlId=h}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}r.ExtendedAttrs=l},9092:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Buffer=r.MAX_BUFFER_SIZE=void 0;const l=n(6349),m=n(7226),a=n(3734),h=n(8437),u=n(4634),d=n(511),f=n(643),t=n(4863),i=n(7116);r.MAX_BUFFER_SIZE=4294967295,r.Buffer=class{constructor(s,o,p){this._hasScrollback=s,this._optionsService=o,this._bufferService=p,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=i.DEFAULT_CHARSET,this.markers=[],this._nullCell=d.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]),this._whitespaceCell=d.CellData.fromCharData([0,f.WHITESPACE_CELL_CHAR,f.WHITESPACE_CELL_WIDTH,f.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new m.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(s){return s?(this._nullCell.fg=s.fg,this._nullCell.bg=s.bg,this._nullCell.extended=s.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new a.ExtendedAttrs),this._nullCell}getWhitespaceCell(s){return s?(this._whitespaceCell.fg=s.fg,this._whitespaceCell.bg=s.bg,this._whitespaceCell.extended=s.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new a.ExtendedAttrs),this._whitespaceCell}getBlankLine(s,o){return new h.BufferLine(this._bufferService.cols,this.getNullCell(s),o)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const s=this.ybase+this.y-this.ydisp;return s>=0&&s<this._rows}_getCorrectBufferLength(s){if(!this._hasScrollback)return s;const o=s+this._optionsService.rawOptions.scrollback;return o>r.MAX_BUFFER_SIZE?r.MAX_BUFFER_SIZE:o}fillViewportRows(s){if(this.lines.length===0){s===void 0&&(s=h.DEFAULT_ATTR_DATA);let o=this._rows;for(;o--;)this.lines.push(this.getBlankLine(s))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(s,o){const p=this.getNullCell(h.DEFAULT_ATTR_DATA);let g=0;const C=this._getCorrectBufferLength(o);if(C>this.lines.maxLength&&(this.lines.maxLength=C),this.lines.length>0){if(this._cols<s)for(let _=0;_<this.lines.length;_++)g+=+this.lines.get(_).resize(s,p);let T=0;if(this._rows<o)for(let _=this._rows;_<o;_++)this.lines.length<o+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(s,p)):this.ybase>0&&this.lines.length<=this.ybase+this.y+T+1?(this.ybase--,T++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(s,p)));else for(let _=this._rows;_>o;_--)this.lines.length>o+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(C<this.lines.maxLength){const _=this.lines.length-C;_>0&&(this.lines.trimStart(_),this.ybase=Math.max(this.ybase-_,0),this.ydisp=Math.max(this.ydisp-_,0),this.savedY=Math.max(this.savedY-_,0)),this.lines.maxLength=C}this.x=Math.min(this.x,s-1),this.y=Math.min(this.y,o-1),T&&(this.y+=T),this.savedX=Math.min(this.savedX,s-1),this.scrollTop=0}if(this.scrollBottom=o-1,this._isReflowEnabled&&(this._reflow(s,o),this._cols>s))for(let T=0;T<this.lines.length;T++)g+=+this.lines.get(T).resize(s,p);this._cols=s,this._rows=o,this._memoryCleanupQueue.clear(),g>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let s=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,s=!1);let o=0;for(;this._memoryCleanupPosition<this.lines.length;)if(o+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),o>100)return!0;return s}get _isReflowEnabled(){const s=this._optionsService.rawOptions.windowsPty;return s&&s.buildNumber?this._hasScrollback&&s.backend==="conpty"&&s.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(s,o){this._cols!==s&&(s>this._cols?this._reflowLarger(s,o):this._reflowSmaller(s,o))}_reflowLarger(s,o){const p=(0,u.reflowLargerGetLinesToRemove)(this.lines,this._cols,s,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(p.length>0){const g=(0,u.reflowLargerCreateNewLayout)(this.lines,p);(0,u.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(s,o,g.countRemoved)}}_reflowLargerAdjustViewport(s,o,p){const g=this.getNullCell(h.DEFAULT_ATTR_DATA);let C=p;for(;C-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<o&&this.lines.push(new h.BufferLine(s,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-p,0)}_reflowSmaller(s,o){const p=this.getNullCell(h.DEFAULT_ATTR_DATA),g=[];let C=0;for(let T=this.lines.length-1;T>=0;T--){let _=this.lines.get(T);if(!_||!_.isWrapped&&_.getTrimmedLength()<=s)continue;const k=[_];for(;_.isWrapped&&T>0;)_=this.lines.get(--T),k.unshift(_);const D=this.ybase+this.y;if(D>=T&&D<T+k.length)continue;const M=k[k.length-1].getTrimmedLength(),S=(0,u.reflowSmallerGetNewLineLengths)(k,this._cols,s),B=S.length-k.length;let H;H=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const F=[];for(let N=0;N<B;N++){const z=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);F.push(z)}F.length>0&&(g.push({start:T+k.length+C,newLines:F}),C+=F.length),k.push(...F);let O=S.length-1,P=S[O];P===0&&(O--,P=S[O]);let L=k.length-B-1,I=M;for(;L>=0;){const N=Math.min(I,P);if(k[O]===void 0)break;if(k[O].copyCellsFrom(k[L],I-N,P-N,N,!0),P-=N,P===0&&(O--,P=S[O]),I-=N,I===0){L--;const z=Math.max(L,0);I=(0,u.getWrappedLineTrimmedLength)(k,z,this._cols)}}for(let N=0;N<k.length;N++)S[N]<s&&k[N].setCell(S[N],p);let A=B-H;for(;A-- >0;)this.ybase===0?this.y<o-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+C)-o&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+o-1)}if(g.length>0){const T=[],_=[];for(let O=0;O<this.lines.length;O++)_.push(this.lines.get(O));const k=this.lines.length;let D=k-1,M=0,S=g[M];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+C);let B=0;for(let O=Math.min(this.lines.maxLength-1,k+C-1);O>=0;O--)if(S&&S.start>D+B){for(let P=S.newLines.length-1;P>=0;P--)this.lines.set(O--,S.newLines[P]);O++,T.push({index:D+1,amount:S.newLines.length}),B+=S.newLines.length,S=g[++M]}else this.lines.set(O,_[D--]);let H=0;for(let O=T.length-1;O>=0;O--)T[O].index+=H,this.lines.onInsertEmitter.fire(T[O]),H+=T[O].amount;const F=Math.max(0,k+C-this.lines.maxLength);F>0&&this.lines.onTrimEmitter.fire(F)}}translateBufferLineToString(s,o,p=0,g){const C=this.lines.get(s);return C?C.translateToString(o,p,g):""}getWrappedRangeForLine(s){let o=s,p=s;for(;o>0&&this.lines.get(o).isWrapped;)o--;for(;p+1<this.lines.length&&this.lines.get(p+1).isWrapped;)p++;return{first:o,last:p}}setupTabStops(s){for(s!=null?this.tabs[s]||(s=this.prevStop(s)):(this.tabs={},s=0);s<this._cols;s+=this._optionsService.rawOptions.tabStopWidth)this.tabs[s]=!0}prevStop(s){for(s==null&&(s=this.x);!this.tabs[--s]&&s>0;);return s>=this._cols?this._cols-1:s<0?0:s}nextStop(s){for(s==null&&(s=this.x);!this.tabs[++s]&&s<this._cols;);return s>=this._cols?this._cols-1:s<0?0:s}clearMarkers(s){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].line===s&&(this.markers[o].dispose(),this.markers.splice(o--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].dispose(),this.markers.splice(s--,1);this._isClearing=!1}addMarker(s){const o=new t.Marker(s);return this.markers.push(o),o.register(this.lines.onTrim(p=>{o.line-=p,o.line<0&&o.dispose()})),o.register(this.lines.onInsert(p=>{o.line>=p.index&&(o.line+=p.amount)})),o.register(this.lines.onDelete(p=>{o.line>=p.index&&o.line<p.index+p.amount&&o.dispose(),o.line>p.index&&(o.line-=p.amount)})),o.register(o.onDispose(()=>this._removeMarker(o))),o}_removeMarker(s){this._isClearing||this.markers.splice(this.markers.indexOf(s),1)}}},8437:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BufferLine=r.DEFAULT_ATTR_DATA=void 0;const l=n(3734),m=n(511),a=n(643),h=n(482);r.DEFAULT_ATTR_DATA=Object.freeze(new l.AttributeData);let u=0;class d{constructor(t,i,s=!1){this.isWrapped=s,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);const o=i||m.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]);for(let p=0;p<t;++p)this.setCell(p,o);this.length=t}get(t){const i=this._data[3*t+0],s=2097151&i;return[this._data[3*t+1],2097152&i?this._combined[t]:s?(0,h.stringFromCodePoint)(s):"",i>>22,2097152&i?this._combined[t].charCodeAt(this._combined[t].length-1):s]}set(t,i){this._data[3*t+1]=i[a.CHAR_DATA_ATTR_INDEX],i[a.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[t]=i[1],this._data[3*t+0]=2097152|t|i[a.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*t+0]=i[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|i[a.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(t){return this._data[3*t+0]>>22}hasWidth(t){return 12582912&this._data[3*t+0]}getFg(t){return this._data[3*t+1]}getBg(t){return this._data[3*t+2]}hasContent(t){return 4194303&this._data[3*t+0]}getCodePoint(t){const i=this._data[3*t+0];return 2097152&i?this._combined[t].charCodeAt(this._combined[t].length-1):2097151&i}isCombined(t){return 2097152&this._data[3*t+0]}getString(t){const i=this._data[3*t+0];return 2097152&i?this._combined[t]:2097151&i?(0,h.stringFromCodePoint)(2097151&i):""}isProtected(t){return 536870912&this._data[3*t+2]}loadCell(t,i){return u=3*t,i.content=this._data[u+0],i.fg=this._data[u+1],i.bg=this._data[u+2],2097152&i.content&&(i.combinedData=this._combined[t]),268435456&i.bg&&(i.extended=this._extendedAttrs[t]),i}setCell(t,i){2097152&i.content&&(this._combined[t]=i.combinedData),268435456&i.bg&&(this._extendedAttrs[t]=i.extended),this._data[3*t+0]=i.content,this._data[3*t+1]=i.fg,this._data[3*t+2]=i.bg}setCellFromCodePoint(t,i,s,o,p,g){268435456&p&&(this._extendedAttrs[t]=g),this._data[3*t+0]=i|s<<22,this._data[3*t+1]=o,this._data[3*t+2]=p}addCodepointToCell(t,i){let s=this._data[3*t+0];2097152&s?this._combined[t]+=(0,h.stringFromCodePoint)(i):(2097151&s?(this._combined[t]=(0,h.stringFromCodePoint)(2097151&s)+(0,h.stringFromCodePoint)(i),s&=-2097152,s|=2097152):s=i|4194304,this._data[3*t+0]=s)}insertCells(t,i,s,o){if((t%=this.length)&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs),i<this.length-t){const p=new m.CellData;for(let g=this.length-t-i-1;g>=0;--g)this.setCell(t+i+g,this.loadCell(t+g,p));for(let g=0;g<i;++g)this.setCell(t+g,s)}else for(let p=t;p<this.length;++p)this.setCell(p,s);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs)}deleteCells(t,i,s,o){if(t%=this.length,i<this.length-t){const p=new m.CellData;for(let g=0;g<this.length-t-i;++g)this.setCell(t+g,this.loadCell(t+i+g,p));for(let g=this.length-i;g<this.length;++g)this.setCell(g,s)}else for(let p=t;p<this.length;++p)this.setCell(p,s);t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs),this.getWidth(t)!==0||this.hasContent(t)||this.setCellFromCodePoint(t,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs)}replaceCells(t,i,s,o,p=!1){if(p)for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodePoint(t-1,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs),i<this.length&&this.getWidth(i-1)===2&&!this.isProtected(i)&&this.setCellFromCodePoint(i,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs);t<i&&t<this.length;)this.isProtected(t)||this.setCell(t,s),t++;else for(t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs),i<this.length&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i,0,1,(o==null?void 0:o.fg)||0,(o==null?void 0:o.bg)||0,(o==null?void 0:o.extended)||new l.ExtendedAttrs);t<i&&t<this.length;)this.setCell(t++,s)}resize(t,i){if(t===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const s=3*t;if(t>this.length){if(this._data.buffer.byteLength>=4*s)this._data=new Uint32Array(this._data.buffer,0,s);else{const o=new Uint32Array(s);o.set(this._data),this._data=o}for(let o=this.length;o<t;++o)this.setCell(o,i)}else{this._data=this._data.subarray(0,s);const o=Object.keys(this._combined);for(let g=0;g<o.length;g++){const C=parseInt(o[g],10);C>=t&&delete this._combined[C]}const p=Object.keys(this._extendedAttrs);for(let g=0;g<p.length;g++){const C=parseInt(p[g],10);C>=t&&delete this._extendedAttrs[C]}}return this.length=t,4*s*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,i=!1){if(i)for(let s=0;s<this.length;++s)this.isProtected(s)||this.setCell(s,t);else{this._combined={},this._extendedAttrs={};for(let s=0;s<this.length;++s)this.setCell(s,t)}}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(const i in t._combined)this._combined[i]=t._combined[i];this._extendedAttrs={};for(const i in t._extendedAttrs)this._extendedAttrs[i]=t._extendedAttrs[i];this.isWrapped=t.isWrapped}clone(){const t=new d(0);t._data=new Uint32Array(this._data),t.length=this.length;for(const i in this._combined)t._combined[i]=this._combined[i];for(const i in this._extendedAttrs)t._extendedAttrs[i]=this._extendedAttrs[i];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0])return t+(this._data[3*t+0]>>22);return 0}getNoBgTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0]||50331648&this._data[3*t+2])return t+(this._data[3*t+0]>>22);return 0}copyCellsFrom(t,i,s,o,p){const g=t._data;if(p)for(let T=o-1;T>=0;T--){for(let _=0;_<3;_++)this._data[3*(s+T)+_]=g[3*(i+T)+_];268435456&g[3*(i+T)+2]&&(this._extendedAttrs[s+T]=t._extendedAttrs[i+T])}else for(let T=0;T<o;T++){for(let _=0;_<3;_++)this._data[3*(s+T)+_]=g[3*(i+T)+_];268435456&g[3*(i+T)+2]&&(this._extendedAttrs[s+T]=t._extendedAttrs[i+T])}const C=Object.keys(t._combined);for(let T=0;T<C.length;T++){const _=parseInt(C[T],10);_>=i&&(this._combined[_-i+s]=t._combined[_])}}translateToString(t=!1,i=0,s=this.length){t&&(s=Math.min(s,this.getTrimmedLength()));let o="";for(;i<s;){const p=this._data[3*i+0],g=2097151&p;o+=2097152&p?this._combined[i]:g?(0,h.stringFromCodePoint)(g):a.WHITESPACE_CELL_CHAR,i+=p>>22||1}return o}}r.BufferLine=d},4841:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getRangeLength=void 0,r.getRangeLength=function(n,l){if(n.start.y>n.end.y)throw new Error(`Buffer range end (${n.end.x}, ${n.end.y}) cannot be before start (${n.start.x}, ${n.start.y})`);return l*(n.end.y-n.start.y)+(n.end.x-n.start.x+1)}},4634:(x,r)=>{function n(l,m,a){if(m===l.length-1)return l[m].getTrimmedLength();const h=!l[m].hasContent(a-1)&&l[m].getWidth(a-1)===1,u=l[m+1].getWidth(0)===2;return h&&u?a-1:a}Object.defineProperty(r,"__esModule",{value:!0}),r.getWrappedLineTrimmedLength=r.reflowSmallerGetNewLineLengths=r.reflowLargerApplyNewLayout=r.reflowLargerCreateNewLayout=r.reflowLargerGetLinesToRemove=void 0,r.reflowLargerGetLinesToRemove=function(l,m,a,h,u){const d=[];for(let f=0;f<l.length-1;f++){let t=f,i=l.get(++t);if(!i.isWrapped)continue;const s=[l.get(f)];for(;t<l.length&&i.isWrapped;)s.push(i),i=l.get(++t);if(h>=f&&h<t){f+=s.length-1;continue}let o=0,p=n(s,o,m),g=1,C=0;for(;g<s.length;){const _=n(s,g,m),k=_-C,D=a-p,M=Math.min(k,D);s[o].copyCellsFrom(s[g],C,p,M,!1),p+=M,p===a&&(o++,p=0),C+=M,C===_&&(g++,C=0),p===0&&o!==0&&s[o-1].getWidth(a-1)===2&&(s[o].copyCellsFrom(s[o-1],a-1,p++,1,!1),s[o-1].setCell(a-1,u))}s[o].replaceCells(p,a,u);let T=0;for(let _=s.length-1;_>0&&(_>o||s[_].getTrimmedLength()===0);_--)T++;T>0&&(d.push(f+s.length-T),d.push(T)),f+=s.length-1}return d},r.reflowLargerCreateNewLayout=function(l,m){const a=[];let h=0,u=m[h],d=0;for(let f=0;f<l.length;f++)if(u===f){const t=m[++h];l.onDeleteEmitter.fire({index:f-d,amount:t}),f+=t-1,d+=t,u=m[++h]}else a.push(f);return{layout:a,countRemoved:d}},r.reflowLargerApplyNewLayout=function(l,m){const a=[];for(let h=0;h<m.length;h++)a.push(l.get(m[h]));for(let h=0;h<a.length;h++)l.set(h,a[h]);l.length=m.length},r.reflowSmallerGetNewLineLengths=function(l,m,a){const h=[],u=l.map((i,s)=>n(l,s,m)).reduce((i,s)=>i+s);let d=0,f=0,t=0;for(;t<u;){if(u-t<a){h.push(u-t);break}d+=a;const i=n(l,f,m);d>i&&(d-=i,f++);const s=l[f].getWidth(d-1)===2;s&&d--;const o=s?a-1:a;h.push(o),t+=o}return h},r.getWrappedLineTrimmedLength=n},5295:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BufferSet=void 0;const l=n(8460),m=n(844),a=n(9092);class h extends m.Disposable{constructor(d,f){super(),this._optionsService=d,this._bufferService=f,this._onBufferActivate=this.register(new l.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new a.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new a.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(d){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(d),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(d,f){this._normal.resize(d,f),this._alt.resize(d,f),this.setupTabStops(d)}setupTabStops(d){this._normal.setupTabStops(d),this._alt.setupTabStops(d)}}r.BufferSet=h},511:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CellData=void 0;const l=n(482),m=n(643),a=n(3734);class h extends a.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new a.ExtendedAttrs,this.combinedData=""}static fromCharData(d){const f=new h;return f.setFromCharData(d),f}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(d){this.fg=d[m.CHAR_DATA_ATTR_INDEX],this.bg=0;let f=!1;if(d[m.CHAR_DATA_CHAR_INDEX].length>2)f=!0;else if(d[m.CHAR_DATA_CHAR_INDEX].length===2){const t=d[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const i=d[m.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=i&&i<=57343?this.content=1024*(t-55296)+i-56320+65536|d[m.CHAR_DATA_WIDTH_INDEX]<<22:f=!0}else f=!0}else this.content=d[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|d[m.CHAR_DATA_WIDTH_INDEX]<<22;f&&(this.combinedData=d[m.CHAR_DATA_CHAR_INDEX],this.content=2097152|d[m.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}r.CellData=h},643:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.WHITESPACE_CELL_CODE=r.WHITESPACE_CELL_WIDTH=r.WHITESPACE_CELL_CHAR=r.NULL_CELL_CODE=r.NULL_CELL_WIDTH=r.NULL_CELL_CHAR=r.CHAR_DATA_CODE_INDEX=r.CHAR_DATA_WIDTH_INDEX=r.CHAR_DATA_CHAR_INDEX=r.CHAR_DATA_ATTR_INDEX=r.DEFAULT_EXT=r.DEFAULT_ATTR=r.DEFAULT_COLOR=void 0,r.DEFAULT_COLOR=0,r.DEFAULT_ATTR=256|r.DEFAULT_COLOR<<9,r.DEFAULT_EXT=0,r.CHAR_DATA_ATTR_INDEX=0,r.CHAR_DATA_CHAR_INDEX=1,r.CHAR_DATA_WIDTH_INDEX=2,r.CHAR_DATA_CODE_INDEX=3,r.NULL_CELL_CHAR="",r.NULL_CELL_WIDTH=1,r.NULL_CELL_CODE=0,r.WHITESPACE_CELL_CHAR=" ",r.WHITESPACE_CELL_WIDTH=1,r.WHITESPACE_CELL_CODE=32},4863:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Marker=void 0;const l=n(8460),m=n(844);class a{get id(){return this._id}constructor(u){this.line=u,this.isDisposed=!1,this._disposables=[],this._id=a._nextId++,this._onDispose=this.register(new l.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,m.disposeArray)(this._disposables),this._disposables.length=0)}register(u){return this._disposables.push(u),u}}r.Marker=a,a._nextId=1},7116:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_CHARSET=r.CHARSETS=void 0,r.CHARSETS={},r.DEFAULT_CHARSET=r.CHARSETS.B,r.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},r.CHARSETS.A={"#":"£"},r.CHARSETS.B=void 0,r.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},r.CHARSETS.C=r.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},r.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},r.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},r.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},r.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},r.CHARSETS.E=r.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},r.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},r.CHARSETS.H=r.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},r.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(x,r)=>{var n,l,m;Object.defineProperty(r,"__esModule",{value:!0}),r.C1_ESCAPED=r.C1=r.C0=void 0,function(a){a.NUL="\0",a.SOH="",a.STX="",a.ETX="",a.EOT="",a.ENQ="",a.ACK="",a.BEL="\x07",a.BS="\b",a.HT="	",a.LF=`
`,a.VT="\v",a.FF="\f",a.CR="\r",a.SO="",a.SI="",a.DLE="",a.DC1="",a.DC2="",a.DC3="",a.DC4="",a.NAK="",a.SYN="",a.ETB="",a.CAN="",a.EM="",a.SUB="",a.ESC="\x1B",a.FS="",a.GS="",a.RS="",a.US="",a.SP=" ",a.DEL=""}(n||(r.C0=n={})),function(a){a.PAD="",a.HOP="",a.BPH="",a.NBH="",a.IND="",a.NEL="",a.SSA="",a.ESA="",a.HTS="",a.HTJ="",a.VTS="",a.PLD="",a.PLU="",a.RI="",a.SS2="",a.SS3="",a.DCS="",a.PU1="",a.PU2="",a.STS="",a.CCH="",a.MW="",a.SPA="",a.EPA="",a.SOS="",a.SGCI="",a.SCI="",a.CSI="",a.ST="",a.OSC="",a.PM="",a.APC=""}(l||(r.C1=l={})),function(a){a.ST=`${n.ESC}\\`}(m||(r.C1_ESCAPED=m={}))},7399:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.evaluateKeyboardEvent=void 0;const l=n(2584),m={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};r.evaluateKeyboardEvent=function(a,h,u,d){const f={type:0,cancel:!1,key:void 0},t=(a.shiftKey?1:0)|(a.altKey?2:0)|(a.ctrlKey?4:0)|(a.metaKey?8:0);switch(a.keyCode){case 0:a.key==="UIKeyInputUpArrow"?f.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A":a.key==="UIKeyInputLeftArrow"?f.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D":a.key==="UIKeyInputRightArrow"?f.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C":a.key==="UIKeyInputDownArrow"&&(f.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B");break;case 8:if(a.altKey){f.key=l.C0.ESC+l.C0.DEL;break}f.key=l.C0.DEL;break;case 9:if(a.shiftKey){f.key=l.C0.ESC+"[Z";break}f.key=l.C0.HT,f.cancel=!0;break;case 13:f.key=a.altKey?l.C0.ESC+l.C0.CR:l.C0.CR,f.cancel=!0;break;case 27:f.key=l.C0.ESC,a.altKey&&(f.key=l.C0.ESC+l.C0.ESC),f.cancel=!0;break;case 37:if(a.metaKey)break;t?(f.key=l.C0.ESC+"[1;"+(t+1)+"D",f.key===l.C0.ESC+"[1;3D"&&(f.key=l.C0.ESC+(u?"b":"[1;5D"))):f.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D";break;case 39:if(a.metaKey)break;t?(f.key=l.C0.ESC+"[1;"+(t+1)+"C",f.key===l.C0.ESC+"[1;3C"&&(f.key=l.C0.ESC+(u?"f":"[1;5C"))):f.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C";break;case 38:if(a.metaKey)break;t?(f.key=l.C0.ESC+"[1;"+(t+1)+"A",u||f.key!==l.C0.ESC+"[1;3A"||(f.key=l.C0.ESC+"[1;5A")):f.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A";break;case 40:if(a.metaKey)break;t?(f.key=l.C0.ESC+"[1;"+(t+1)+"B",u||f.key!==l.C0.ESC+"[1;3B"||(f.key=l.C0.ESC+"[1;5B")):f.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B";break;case 45:a.shiftKey||a.ctrlKey||(f.key=l.C0.ESC+"[2~");break;case 46:f.key=t?l.C0.ESC+"[3;"+(t+1)+"~":l.C0.ESC+"[3~";break;case 36:f.key=t?l.C0.ESC+"[1;"+(t+1)+"H":h?l.C0.ESC+"OH":l.C0.ESC+"[H";break;case 35:f.key=t?l.C0.ESC+"[1;"+(t+1)+"F":h?l.C0.ESC+"OF":l.C0.ESC+"[F";break;case 33:a.shiftKey?f.type=2:a.ctrlKey?f.key=l.C0.ESC+"[5;"+(t+1)+"~":f.key=l.C0.ESC+"[5~";break;case 34:a.shiftKey?f.type=3:a.ctrlKey?f.key=l.C0.ESC+"[6;"+(t+1)+"~":f.key=l.C0.ESC+"[6~";break;case 112:f.key=t?l.C0.ESC+"[1;"+(t+1)+"P":l.C0.ESC+"OP";break;case 113:f.key=t?l.C0.ESC+"[1;"+(t+1)+"Q":l.C0.ESC+"OQ";break;case 114:f.key=t?l.C0.ESC+"[1;"+(t+1)+"R":l.C0.ESC+"OR";break;case 115:f.key=t?l.C0.ESC+"[1;"+(t+1)+"S":l.C0.ESC+"OS";break;case 116:f.key=t?l.C0.ESC+"[15;"+(t+1)+"~":l.C0.ESC+"[15~";break;case 117:f.key=t?l.C0.ESC+"[17;"+(t+1)+"~":l.C0.ESC+"[17~";break;case 118:f.key=t?l.C0.ESC+"[18;"+(t+1)+"~":l.C0.ESC+"[18~";break;case 119:f.key=t?l.C0.ESC+"[19;"+(t+1)+"~":l.C0.ESC+"[19~";break;case 120:f.key=t?l.C0.ESC+"[20;"+(t+1)+"~":l.C0.ESC+"[20~";break;case 121:f.key=t?l.C0.ESC+"[21;"+(t+1)+"~":l.C0.ESC+"[21~";break;case 122:f.key=t?l.C0.ESC+"[23;"+(t+1)+"~":l.C0.ESC+"[23~";break;case 123:f.key=t?l.C0.ESC+"[24;"+(t+1)+"~":l.C0.ESC+"[24~";break;default:if(!a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)if(u&&!d||!a.altKey||a.metaKey)!u||a.altKey||a.ctrlKey||a.shiftKey||!a.metaKey?a.key&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&a.keyCode>=48&&a.key.length===1?f.key=a.key:a.key&&a.ctrlKey&&(a.key==="_"&&(f.key=l.C0.US),a.key==="@"&&(f.key=l.C0.NUL)):a.keyCode===65&&(f.type=1);else{const i=m[a.keyCode],s=i==null?void 0:i[a.shiftKey?1:0];if(s)f.key=l.C0.ESC+s;else if(a.keyCode>=65&&a.keyCode<=90){const o=a.ctrlKey?a.keyCode-64:a.keyCode+32;let p=String.fromCharCode(o);a.shiftKey&&(p=p.toUpperCase()),f.key=l.C0.ESC+p}else if(a.keyCode===32)f.key=l.C0.ESC+(a.ctrlKey?l.C0.NUL:" ");else if(a.key==="Dead"&&a.code.startsWith("Key")){let o=a.code.slice(3,4);a.shiftKey||(o=o.toLowerCase()),f.key=l.C0.ESC+o,f.cancel=!0}}else a.keyCode>=65&&a.keyCode<=90?f.key=String.fromCharCode(a.keyCode-64):a.keyCode===32?f.key=l.C0.NUL:a.keyCode>=51&&a.keyCode<=55?f.key=String.fromCharCode(a.keyCode-51+27):a.keyCode===56?f.key=l.C0.DEL:a.keyCode===219?f.key=l.C0.ESC:a.keyCode===220?f.key=l.C0.FS:a.keyCode===221&&(f.key=l.C0.GS)}return f}},482:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Utf8ToUtf32=r.StringToUtf32=r.utf32ToString=r.stringFromCodePoint=void 0,r.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},r.utf32ToString=function(n,l=0,m=n.length){let a="";for(let h=l;h<m;++h){let u=n[h];u>65535?(u-=65536,a+=String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):a+=String.fromCharCode(u)}return a},r.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,l){const m=n.length;if(!m)return 0;let a=0,h=0;if(this._interim){const u=n.charCodeAt(h++);56320<=u&&u<=57343?l[a++]=1024*(this._interim-55296)+u-56320+65536:(l[a++]=this._interim,l[a++]=u),this._interim=0}for(let u=h;u<m;++u){const d=n.charCodeAt(u);if(55296<=d&&d<=56319){if(++u>=m)return this._interim=d,a;const f=n.charCodeAt(u);56320<=f&&f<=57343?l[a++]=1024*(d-55296)+f-56320+65536:(l[a++]=d,l[a++]=f)}else d!==65279&&(l[a++]=d)}return a}},r.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,l){const m=n.length;if(!m)return 0;let a,h,u,d,f=0,t=0,i=0;if(this.interim[0]){let p=!1,g=this.interim[0];g&=(224&g)==192?31:(240&g)==224?15:7;let C,T=0;for(;(C=63&this.interim[++T])&&T<4;)g<<=6,g|=C;const _=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,k=_-T;for(;i<k;){if(i>=m)return 0;if(C=n[i++],(192&C)!=128){i--,p=!0;break}this.interim[T++]=C,g<<=6,g|=63&C}p||(_===2?g<128?i--:l[f++]=g:_===3?g<2048||g>=55296&&g<=57343||g===65279||(l[f++]=g):g<65536||g>1114111||(l[f++]=g)),this.interim.fill(0)}const s=m-4;let o=i;for(;o<m;){for(;!(!(o<s)||128&(a=n[o])||128&(h=n[o+1])||128&(u=n[o+2])||128&(d=n[o+3]));)l[f++]=a,l[f++]=h,l[f++]=u,l[f++]=d,o+=4;if(a=n[o++],a<128)l[f++]=a;else if((224&a)==192){if(o>=m)return this.interim[0]=a,f;if(h=n[o++],(192&h)!=128){o--;continue}if(t=(31&a)<<6|63&h,t<128){o--;continue}l[f++]=t}else if((240&a)==224){if(o>=m)return this.interim[0]=a,f;if(h=n[o++],(192&h)!=128){o--;continue}if(o>=m)return this.interim[0]=a,this.interim[1]=h,f;if(u=n[o++],(192&u)!=128){o--;continue}if(t=(15&a)<<12|(63&h)<<6|63&u,t<2048||t>=55296&&t<=57343||t===65279)continue;l[f++]=t}else if((248&a)==240){if(o>=m)return this.interim[0]=a,f;if(h=n[o++],(192&h)!=128){o--;continue}if(o>=m)return this.interim[0]=a,this.interim[1]=h,f;if(u=n[o++],(192&u)!=128){o--;continue}if(o>=m)return this.interim[0]=a,this.interim[1]=h,this.interim[2]=u,f;if(d=n[o++],(192&d)!=128){o--;continue}if(t=(7&a)<<18|(63&h)<<12|(63&u)<<6|63&d,t<65536||t>1114111)continue;l[f++]=t}}return f}}},225:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.UnicodeV6=void 0;const n=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let m;r.UnicodeV6=class{constructor(){if(this.version="6",!m){m=new Uint8Array(65536),m.fill(1),m[0]=0,m.fill(0,1,32),m.fill(0,127,160),m.fill(2,4352,4448),m[9001]=2,m[9002]=2,m.fill(2,11904,42192),m[12351]=1,m.fill(2,44032,55204),m.fill(2,63744,64256),m.fill(2,65040,65050),m.fill(2,65072,65136),m.fill(2,65280,65377),m.fill(2,65504,65511);for(let a=0;a<n.length;++a)m.fill(0,n[a][0],n[a][1]+1)}}wcwidth(a){return a<32?0:a<127?1:a<65536?m[a]:function(h,u){let d,f=0,t=u.length-1;if(h<u[0][0]||h>u[t][1])return!1;for(;t>=f;)if(d=f+t>>1,h>u[d][1])f=d+1;else{if(!(h<u[d][0]))return!0;t=d-1}return!1}(a,l)?0:a>=131072&&a<=196605||a>=196608&&a<=262141?2:1}}},5981:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.WriteBuffer=void 0;const l=n(8460),m=n(844);class a extends m.Disposable{constructor(u){super(),this._action=u,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(u,d){if(d!==void 0&&this._syncCalls>d)return void(this._syncCalls=0);if(this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let f;for(this._isSyncWriting=!0;f=this._writeBuffer.shift();){this._action(f);const t=this._callbacks.shift();t&&t()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(u,d){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(d),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(d)}_innerWrite(u=0,d=!0){const f=u||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const t=this._writeBuffer[this._bufferOffset],i=this._action(t,d);if(i){const o=p=>Date.now()-f>=12?setTimeout(()=>this._innerWrite(0,p)):this._innerWrite(f,p);return void i.catch(p=>(queueMicrotask(()=>{throw p}),Promise.resolve(!1))).then(o)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=t.length,Date.now()-f>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}r.WriteBuffer=a},5941:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.toRgbString=r.parseColor=void 0;const n=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,l=/^[\da-f]+$/;function m(a,h){const u=a.toString(16),d=u.length<2?"0"+u:u;switch(h){case 4:return u[0];case 8:return d;case 12:return(d+d).slice(0,3);default:return d+d}}r.parseColor=function(a){if(!a)return;let h=a.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const u=n.exec(h);if(u){const d=u[1]?15:u[4]?255:u[7]?4095:65535;return[Math.round(parseInt(u[1]||u[4]||u[7]||u[10],16)/d*255),Math.round(parseInt(u[2]||u[5]||u[8]||u[11],16)/d*255),Math.round(parseInt(u[3]||u[6]||u[9]||u[12],16)/d*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),l.exec(h)&&[3,6,9,12].includes(h.length))){const u=h.length/3,d=[0,0,0];for(let f=0;f<3;++f){const t=parseInt(h.slice(u*f,u*f+u),16);d[f]=u===1?t<<4:u===2?t:u===3?t>>4:t>>8}return d}},r.toRgbString=function(a,h=16){const[u,d,f]=a;return`rgb:${m(u,h)}/${m(d,h)}/${m(f,h)}`}},5770:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PAYLOAD_LIMIT=void 0,r.PAYLOAD_LIMIT=1e7},6351:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DcsHandler=r.DcsParser=void 0;const l=n(482),m=n(8742),a=n(5770),h=[];r.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(d,f){this._handlers[d]===void 0&&(this._handlers[d]=[]);const t=this._handlers[d];return t.push(f),{dispose:()=>{const i=t.indexOf(f);i!==-1&&t.splice(i,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}reset(){if(this._active.length)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(d,f){if(this.reset(),this._ident=d,this._active=this._handlers[d]||h,this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].hook(f);else this._handlerFb(this._ident,"HOOK",f)}put(d,f,t){if(this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].put(d,f,t);else this._handlerFb(this._ident,"PUT",(0,l.utf32ToString)(d,f,t))}unhook(d,f=!0){if(this._active.length){let t=!1,i=this._active.length-1,s=!1;if(this._stack.paused&&(i=this._stack.loopPosition-1,t=f,s=this._stack.fallThrough,this._stack.paused=!1),!s&&t===!1){for(;i>=0&&(t=this._active[i].unhook(d),t!==!0);i--)if(t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!1,t;i--}for(;i>=0;i--)if(t=this._active[i].unhook(!1),t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!0,t}else this._handlerFb(this._ident,"UNHOOK",d);this._active=h,this._ident=0}};const u=new m.Params;u.addParam(0),r.DcsHandler=class{constructor(d){this._handler=d,this._data="",this._params=u,this._hitLimit=!1}hook(d){this._params=d.length>1||d.params[0]?d.clone():u,this._data="",this._hitLimit=!1}put(d,f,t){this._hitLimit||(this._data+=(0,l.utf32ToString)(d,f,t),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(d){let f=!1;if(this._hitLimit)f=!1;else if(d&&(f=this._handler(this._data,this._params),f instanceof Promise))return f.then(t=>(this._params=u,this._data="",this._hitLimit=!1,t));return this._params=u,this._data="",this._hitLimit=!1,f}}},2015:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.EscapeSequenceParser=r.VT500_TRANSITION_TABLE=r.TransitionTable=void 0;const l=n(844),m=n(8742),a=n(6242),h=n(6351);class u{constructor(i){this.table=new Uint8Array(i)}setDefault(i,s){this.table.fill(i<<4|s)}add(i,s,o,p){this.table[s<<8|i]=o<<4|p}addMany(i,s,o,p){for(let g=0;g<i.length;g++)this.table[s<<8|i[g]]=o<<4|p}}r.TransitionTable=u;const d=160;r.VT500_TRANSITION_TABLE=function(){const t=new u(4095),i=Array.apply(null,Array(256)).map((T,_)=>_),s=(T,_)=>i.slice(T,_),o=s(32,127),p=s(0,24);p.push(25),p.push.apply(p,s(28,32));const g=s(0,14);let C;for(C in t.setDefault(1,0),t.addMany(o,0,2,0),g)t.addMany([24,26,153,154],C,3,0),t.addMany(s(128,144),C,3,0),t.addMany(s(144,152),C,3,0),t.add(156,C,0,0),t.add(27,C,11,1),t.add(157,C,4,8),t.addMany([152,158,159],C,0,7),t.add(155,C,11,3),t.add(144,C,11,9);return t.addMany(p,0,3,0),t.addMany(p,1,3,1),t.add(127,1,0,1),t.addMany(p,8,0,8),t.addMany(p,3,3,3),t.add(127,3,0,3),t.addMany(p,4,3,4),t.add(127,4,0,4),t.addMany(p,6,3,6),t.addMany(p,5,3,5),t.add(127,5,0,5),t.addMany(p,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(o,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(s(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(o,7,0,7),t.addMany(p,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(s(64,127),3,7,0),t.addMany(s(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(s(48,60),4,8,4),t.addMany(s(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(s(32,64),6,0,6),t.add(127,6,0,6),t.addMany(s(64,127),6,0,0),t.addMany(s(32,48),3,9,5),t.addMany(s(32,48),5,9,5),t.addMany(s(48,64),5,0,6),t.addMany(s(64,127),5,7,0),t.addMany(s(32,48),4,9,5),t.addMany(s(32,48),1,9,2),t.addMany(s(32,48),2,9,2),t.addMany(s(48,127),2,10,0),t.addMany(s(48,80),1,10,0),t.addMany(s(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(s(96,127),1,10,0),t.add(80,1,11,9),t.addMany(p,9,0,9),t.add(127,9,0,9),t.addMany(s(28,32),9,0,9),t.addMany(s(32,48),9,9,12),t.addMany(s(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(p,11,0,11),t.addMany(s(32,128),11,0,11),t.addMany(s(28,32),11,0,11),t.addMany(p,10,0,10),t.add(127,10,0,10),t.addMany(s(28,32),10,0,10),t.addMany(s(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(s(32,48),10,9,12),t.addMany(p,12,0,12),t.add(127,12,0,12),t.addMany(s(28,32),12,0,12),t.addMany(s(32,48),12,9,12),t.addMany(s(48,64),12,0,11),t.addMany(s(64,127),12,12,13),t.addMany(s(64,127),10,12,13),t.addMany(s(64,127),9,12,13),t.addMany(p,13,13,13),t.addMany(o,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(d,0,2,0),t.add(d,8,5,8),t.add(d,6,0,6),t.add(d,11,0,11),t.add(d,13,13,13),t}();class f extends l.Disposable{constructor(i=r.VT500_TRANSITION_TABLE){super(),this._transitions=i,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new m.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(s,o,p)=>{},this._executeHandlerFb=s=>{},this._csiHandlerFb=(s,o)=>{},this._escHandlerFb=s=>{},this._errorHandlerFb=s=>s,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,l.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new a.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(i,s=[64,126]){let o=0;if(i.prefix){if(i.prefix.length>1)throw new Error("only one byte as prefix supported");if(o=i.prefix.charCodeAt(0),o&&60>o||o>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(i.intermediates){if(i.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let g=0;g<i.intermediates.length;++g){const C=i.intermediates.charCodeAt(g);if(32>C||C>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");o<<=8,o|=C}}if(i.final.length!==1)throw new Error("final must be a single byte");const p=i.final.charCodeAt(0);if(s[0]>p||p>s[1])throw new Error(`final must be in range ${s[0]} .. ${s[1]}`);return o<<=8,o|=p,o}identToString(i){const s=[];for(;i;)s.push(String.fromCharCode(255&i)),i>>=8;return s.reverse().join("")}setPrintHandler(i){this._printHandler=i}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(i,s){const o=this._identifier(i,[48,126]);this._escHandlers[o]===void 0&&(this._escHandlers[o]=[]);const p=this._escHandlers[o];return p.push(s),{dispose:()=>{const g=p.indexOf(s);g!==-1&&p.splice(g,1)}}}clearEscHandler(i){this._escHandlers[this._identifier(i,[48,126])]&&delete this._escHandlers[this._identifier(i,[48,126])]}setEscHandlerFallback(i){this._escHandlerFb=i}setExecuteHandler(i,s){this._executeHandlers[i.charCodeAt(0)]=s}clearExecuteHandler(i){this._executeHandlers[i.charCodeAt(0)]&&delete this._executeHandlers[i.charCodeAt(0)]}setExecuteHandlerFallback(i){this._executeHandlerFb=i}registerCsiHandler(i,s){const o=this._identifier(i);this._csiHandlers[o]===void 0&&(this._csiHandlers[o]=[]);const p=this._csiHandlers[o];return p.push(s),{dispose:()=>{const g=p.indexOf(s);g!==-1&&p.splice(g,1)}}}clearCsiHandler(i){this._csiHandlers[this._identifier(i)]&&delete this._csiHandlers[this._identifier(i)]}setCsiHandlerFallback(i){this._csiHandlerFb=i}registerDcsHandler(i,s){return this._dcsParser.registerHandler(this._identifier(i),s)}clearDcsHandler(i){this._dcsParser.clearHandler(this._identifier(i))}setDcsHandlerFallback(i){this._dcsParser.setHandlerFallback(i)}registerOscHandler(i,s){return this._oscParser.registerHandler(i,s)}clearOscHandler(i){this._oscParser.clearHandler(i)}setOscHandlerFallback(i){this._oscParser.setHandlerFallback(i)}setErrorHandler(i){this._errorHandler=i}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(i,s,o,p,g){this._parseStack.state=i,this._parseStack.handlers=s,this._parseStack.handlerPos=o,this._parseStack.transition=p,this._parseStack.chunkPos=g}parse(i,s,o){let p,g=0,C=0,T=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,T=this._parseStack.chunkPos+1;else{if(o===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const _=this._parseStack.handlers;let k=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(o===!1&&k>-1){for(;k>=0&&(p=_[k](this._params),p!==!0);k--)if(p instanceof Promise)return this._parseStack.handlerPos=k,p}this._parseStack.handlers=[];break;case 4:if(o===!1&&k>-1){for(;k>=0&&(p=_[k](),p!==!0);k--)if(p instanceof Promise)return this._parseStack.handlerPos=k,p}this._parseStack.handlers=[];break;case 6:if(g=i[this._parseStack.chunkPos],p=this._dcsParser.unhook(g!==24&&g!==26,o),p)return p;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(g=i[this._parseStack.chunkPos],p=this._oscParser.end(g!==24&&g!==26,o),p)return p;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,T=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let _=T;_<s;++_){switch(g=i[_],C=this._transitions.table[this.currentState<<8|(g<160?g:d)],C>>4){case 2:for(let B=_+1;;++B){if(B>=s||(g=i[B])<32||g>126&&g<d){this._printHandler(i,_,B),_=B-1;break}if(++B>=s||(g=i[B])<32||g>126&&g<d){this._printHandler(i,_,B),_=B-1;break}if(++B>=s||(g=i[B])<32||g>126&&g<d){this._printHandler(i,_,B),_=B-1;break}if(++B>=s||(g=i[B])<32||g>126&&g<d){this._printHandler(i,_,B),_=B-1;break}}break;case 3:this._executeHandlers[g]?this._executeHandlers[g]():this._executeHandlerFb(g),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:_,code:g,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const k=this._csiHandlers[this._collect<<8|g];let D=k?k.length-1:-1;for(;D>=0&&(p=k[D](this._params),p!==!0);D--)if(p instanceof Promise)return this._preserveStack(3,k,D,C,_),p;D<0&&this._csiHandlerFb(this._collect<<8|g,this._params),this.precedingCodepoint=0;break;case 8:do switch(g){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(g-48)}while(++_<s&&(g=i[_])>47&&g<60);_--;break;case 9:this._collect<<=8,this._collect|=g;break;case 10:const M=this._escHandlers[this._collect<<8|g];let S=M?M.length-1:-1;for(;S>=0&&(p=M[S](),p!==!0);S--)if(p instanceof Promise)return this._preserveStack(4,M,S,C,_),p;S<0&&this._escHandlerFb(this._collect<<8|g),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|g,this._params);break;case 13:for(let B=_+1;;++B)if(B>=s||(g=i[B])===24||g===26||g===27||g>127&&g<d){this._dcsParser.put(i,_,B),_=B-1;break}break;case 14:if(p=this._dcsParser.unhook(g!==24&&g!==26),p)return this._preserveStack(6,[],0,C,_),p;g===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let B=_+1;;B++)if(B>=s||(g=i[B])<32||g>127&&g<d){this._oscParser.put(i,_,B),_=B-1;break}break;case 6:if(p=this._oscParser.end(g!==24&&g!==26),p)return this._preserveStack(5,[],0,C,_),p;g===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&C}}}r.EscapeSequenceParser=f},6242:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.OscHandler=r.OscParser=void 0;const l=n(5770),m=n(482),a=[];r.OscParser=class{constructor(){this._state=0,this._active=a,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,u){this._handlers[h]===void 0&&(this._handlers[h]=[]);const d=this._handlers[h];return d.push(u),{dispose:()=>{const f=d.indexOf(u);f!==-1&&d.splice(f,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=a,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||a,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,u,d){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(h,u,d);else this._handlerFb(this._id,"PUT",(0,m.utf32ToString)(h,u,d))}start(){this.reset(),this._state=1}put(h,u,d){if(this._state!==3){if(this._state===1)for(;u<d;){const f=h[u++];if(f===59){this._state=2,this._start();break}if(f<48||57<f)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+f-48}this._state===2&&d-u>0&&this._put(h,u,d)}}end(h,u=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let d=!1,f=this._active.length-1,t=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,d=u,t=this._stack.fallThrough,this._stack.paused=!1),!t&&d===!1){for(;f>=0&&(d=this._active[f].end(h),d!==!0);f--)if(d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,d;f--}for(;f>=0;f--)if(d=this._active[f].end(!1),d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,d}else this._handlerFb(this._id,"END",h);this._active=a,this._id=-1,this._state=0}}},r.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,u,d){this._hitLimit||(this._data+=(0,m.utf32ToString)(h,u,d),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let u=!1;if(this._hitLimit)u=!1;else if(h&&(u=this._handler(this._data),u instanceof Promise))return u.then(d=>(this._data="",this._hitLimit=!1,d));return this._data="",this._hitLimit=!1,u}}},8742:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Params=void 0;const n=2147483647;class l{static fromArray(a){const h=new l;if(!a.length)return h;for(let u=Array.isArray(a[0])?1:0;u<a.length;++u){const d=a[u];if(Array.isArray(d))for(let f=0;f<d.length;++f)h.addSubParam(d[f]);else h.addParam(d)}return h}constructor(a=32,h=32){if(this.maxLength=a,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(a),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(a),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const a=new l(this.maxLength,this.maxSubParamsLength);return a.params.set(this.params),a.length=this.length,a._subParams.set(this._subParams),a._subParamsLength=this._subParamsLength,a._subParamsIdx.set(this._subParamsIdx),a._rejectDigits=this._rejectDigits,a._rejectSubDigits=this._rejectSubDigits,a._digitIsSub=this._digitIsSub,a}toArray(){const a=[];for(let h=0;h<this.length;++h){a.push(this.params[h]);const u=this._subParamsIdx[h]>>8,d=255&this._subParamsIdx[h];d-u>0&&a.push(Array.prototype.slice.call(this._subParams,u,d))}return a}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(a){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=a>n?n:a}}addSubParam(a){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=a>n?n:a,this._subParamsIdx[this.length-1]++}}hasSubParams(a){return(255&this._subParamsIdx[a])-(this._subParamsIdx[a]>>8)>0}getSubParams(a){const h=this._subParamsIdx[a]>>8,u=255&this._subParamsIdx[a];return u-h>0?this._subParams.subarray(h,u):null}getSubParamsAll(){const a={};for(let h=0;h<this.length;++h){const u=this._subParamsIdx[h]>>8,d=255&this._subParamsIdx[h];d-u>0&&(a[h]=this._subParams.slice(u,d))}return a}addDigit(a){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const u=this._digitIsSub?this._subParams:this.params,d=u[h-1];u[h-1]=~d?Math.min(10*d+a,n):a}}r.Params=l},5741:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AddonManager=void 0,r.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let n=this._addons.length-1;n>=0;n--)this._addons[n].instance.dispose()}loadAddon(n,l){const m={instance:l,dispose:l.dispose,isDisposed:!1};this._addons.push(m),l.dispose=()=>this._wrappedAddonDispose(m),l.activate(n)}_wrappedAddonDispose(n){if(n.isDisposed)return;let l=-1;for(let m=0;m<this._addons.length;m++)if(this._addons[m]===n){l=m;break}if(l===-1)throw new Error("Could not dispose an addon that has not been loaded");n.isDisposed=!0,n.dispose.apply(n.instance),this._addons.splice(l,1)}}},8771:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BufferApiView=void 0;const l=n(3785),m=n(511);r.BufferApiView=class{constructor(a,h){this._buffer=a,this.type=h}init(a){return this._buffer=a,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(a){const h=this._buffer.lines.get(a);if(h)return new l.BufferLineApiView(h)}getNullCell(){return new m.CellData}}},3785:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BufferLineApiView=void 0;const l=n(511);r.BufferLineApiView=class{constructor(m){this._line=m}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(m,a){if(!(m<0||m>=this._line.length))return a?(this._line.loadCell(m,a),a):this._line.loadCell(m,new l.CellData)}translateToString(m,a,h){return this._line.translateToString(m,a,h)}}},8285:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BufferNamespaceApi=void 0;const l=n(8771),m=n(8460),a=n(844);class h extends a.Disposable{constructor(d){super(),this._core=d,this._onBufferChange=this.register(new m.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new l.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new l.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}r.BufferNamespaceApi=h},7975:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ParserApi=void 0,r.ParserApi=class{constructor(n){this._core=n}registerCsiHandler(n,l){return this._core.registerCsiHandler(n,m=>l(m.toArray()))}addCsiHandler(n,l){return this.registerCsiHandler(n,l)}registerDcsHandler(n,l){return this._core.registerDcsHandler(n,(m,a)=>l(m,a.toArray()))}addDcsHandler(n,l){return this.registerDcsHandler(n,l)}registerEscHandler(n,l){return this._core.registerEscHandler(n,l)}addEscHandler(n,l){return this.registerEscHandler(n,l)}registerOscHandler(n,l){return this._core.registerOscHandler(n,l)}addOscHandler(n,l){return this.registerOscHandler(n,l)}}},7090:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.UnicodeApi=void 0,r.UnicodeApi=class{constructor(n){this._core=n}register(n){this._core.unicodeService.register(n)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(n){this._core.unicodeService.activeVersion=n}}},744:function(x,r,n){var l=this&&this.__decorate||function(t,i,s,o){var p,g=arguments.length,C=g<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(t,i,s,o);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(C=(g<3?p(C):g>3?p(i,s,C):p(i,s))||C);return g>3&&C&&Object.defineProperty(i,s,C),C},m=this&&this.__param||function(t,i){return function(s,o){i(s,o,t)}};Object.defineProperty(r,"__esModule",{value:!0}),r.BufferService=r.MINIMUM_ROWS=r.MINIMUM_COLS=void 0;const a=n(8460),h=n(844),u=n(5295),d=n(2585);r.MINIMUM_COLS=2,r.MINIMUM_ROWS=1;let f=r.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(t){super(),this.isUserScrolling=!1,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,r.MINIMUM_COLS),this.rows=Math.max(t.rawOptions.rows||0,r.MINIMUM_ROWS),this.buffers=this.register(new u.BufferSet(t,this))}resize(t,i){this.cols=t,this.rows=i,this.buffers.resize(t,i),this._onResize.fire({cols:t,rows:i})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,i=!1){const s=this.buffer;let o;o=this._cachedBlankLine,o&&o.length===this.cols&&o.getFg(0)===t.fg&&o.getBg(0)===t.bg||(o=s.getBlankLine(t,i),this._cachedBlankLine=o),o.isWrapped=i;const p=s.ybase+s.scrollTop,g=s.ybase+s.scrollBottom;if(s.scrollTop===0){const C=s.lines.isFull;g===s.lines.length-1?C?s.lines.recycle().copyFrom(o):s.lines.push(o.clone()):s.lines.splice(g+1,0,o.clone()),C?this.isUserScrolling&&(s.ydisp=Math.max(s.ydisp-1,0)):(s.ybase++,this.isUserScrolling||s.ydisp++)}else{const C=g-p+1;s.lines.shiftElements(p+1,C-1,-1),s.lines.set(g,o.clone())}this.isUserScrolling||(s.ydisp=s.ybase),this._onScroll.fire(s.ydisp)}scrollLines(t,i,s){const o=this.buffer;if(t<0){if(o.ydisp===0)return;this.isUserScrolling=!0}else t+o.ydisp>=o.ybase&&(this.isUserScrolling=!1);const p=o.ydisp;o.ydisp=Math.max(Math.min(o.ydisp+t,o.ybase),0),p!==o.ydisp&&(i||this._onScroll.fire(o.ydisp))}};r.BufferService=f=l([m(0,d.IOptionsService)],f)},7994:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CharsetService=void 0,r.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(n){this.glevel=n,this.charset=this._charsets[n]}setgCharset(n,l){this._charsets[n]=l,this.glevel===n&&(this.charset=l)}}},1753:function(x,r,n){var l=this&&this.__decorate||function(o,p,g,C){var T,_=arguments.length,k=_<3?p:C===null?C=Object.getOwnPropertyDescriptor(p,g):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(o,p,g,C);else for(var D=o.length-1;D>=0;D--)(T=o[D])&&(k=(_<3?T(k):_>3?T(p,g,k):T(p,g))||k);return _>3&&k&&Object.defineProperty(p,g,k),k},m=this&&this.__param||function(o,p){return function(g,C){p(g,C,o)}};Object.defineProperty(r,"__esModule",{value:!0}),r.CoreMouseService=void 0;const a=n(2585),h=n(8460),u=n(844),d={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:o=>o.button!==4&&o.action===1&&(o.ctrl=!1,o.alt=!1,o.shift=!1,!0)},VT200:{events:19,restrict:o=>o.action!==32},DRAG:{events:23,restrict:o=>o.action!==32||o.button!==3},ANY:{events:31,restrict:o=>!0}};function f(o,p){let g=(o.ctrl?16:0)|(o.shift?4:0)|(o.alt?8:0);return o.button===4?(g|=64,g|=o.action):(g|=3&o.button,4&o.button&&(g|=64),8&o.button&&(g|=128),o.action===32?g|=32:o.action!==0||p||(g|=3)),g}const t=String.fromCharCode,i={DEFAULT:o=>{const p=[f(o,!1)+32,o.col+32,o.row+32];return p[0]>255||p[1]>255||p[2]>255?"":`\x1B[M${t(p[0])}${t(p[1])}${t(p[2])}`},SGR:o=>{const p=o.action===0&&o.button!==4?"m":"M";return`\x1B[<${f(o,!0)};${o.col};${o.row}${p}`},SGR_PIXELS:o=>{const p=o.action===0&&o.button!==4?"m":"M";return`\x1B[<${f(o,!0)};${o.x};${o.y}${p}`}};let s=r.CoreMouseService=class extends u.Disposable{constructor(o,p){super(),this._bufferService=o,this._coreService=p,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const g of Object.keys(d))this.addProtocol(g,d[g]);for(const g of Object.keys(i))this.addEncoding(g,i[g]);this.reset()}addProtocol(o,p){this._protocols[o]=p}addEncoding(o,p){this._encodings[o]=p}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(o){if(!this._protocols[o])throw new Error(`unknown protocol "${o}"`);this._activeProtocol=o,this._onProtocolChange.fire(this._protocols[o].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(o){if(!this._encodings[o])throw new Error(`unknown encoding "${o}"`);this._activeEncoding=o}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(o){if(o.col<0||o.col>=this._bufferService.cols||o.row<0||o.row>=this._bufferService.rows||o.button===4&&o.action===32||o.button===3&&o.action!==32||o.button!==4&&(o.action===2||o.action===3)||(o.col++,o.row++,o.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,o,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(o))return!1;const p=this._encodings[this._activeEncoding](o);return p&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(p):this._coreService.triggerDataEvent(p,!0)),this._lastEvent=o,!0}explainEvents(o){return{down:!!(1&o),up:!!(2&o),drag:!!(4&o),move:!!(8&o),wheel:!!(16&o)}}_equalEvents(o,p,g){if(g){if(o.x!==p.x||o.y!==p.y)return!1}else if(o.col!==p.col||o.row!==p.row)return!1;return o.button===p.button&&o.action===p.action&&o.ctrl===p.ctrl&&o.alt===p.alt&&o.shift===p.shift}};r.CoreMouseService=s=l([m(0,a.IBufferService),m(1,a.ICoreService)],s)},6975:function(x,r,n){var l=this&&this.__decorate||function(s,o,p,g){var C,T=arguments.length,_=T<3?o:g===null?g=Object.getOwnPropertyDescriptor(o,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(s,o,p,g);else for(var k=s.length-1;k>=0;k--)(C=s[k])&&(_=(T<3?C(_):T>3?C(o,p,_):C(o,p))||_);return T>3&&_&&Object.defineProperty(o,p,_),_},m=this&&this.__param||function(s,o){return function(p,g){o(p,g,s)}};Object.defineProperty(r,"__esModule",{value:!0}),r.CoreService=void 0;const a=n(1439),h=n(8460),u=n(844),d=n(2585),f=Object.freeze({insertMode:!1}),t=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let i=r.CoreService=class extends u.Disposable{constructor(s,o,p){super(),this._bufferService=s,this._logService=o,this._optionsService=p,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,a.clone)(f),this.decPrivateModes=(0,a.clone)(t)}reset(){this.modes=(0,a.clone)(f),this.decPrivateModes=(0,a.clone)(t)}triggerDataEvent(s,o=!1){if(this._optionsService.rawOptions.disableStdin)return;const p=this._bufferService.buffer;o&&this._optionsService.rawOptions.scrollOnUserInput&&p.ybase!==p.ydisp&&this._onRequestScrollToBottom.fire(),o&&this._onUserInput.fire(),this._logService.debug(`sending data "${s}"`,()=>s.split("").map(g=>g.charCodeAt(0))),this._onData.fire(s)}triggerBinaryEvent(s){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${s}"`,()=>s.split("").map(o=>o.charCodeAt(0))),this._onBinary.fire(s))}};r.CoreService=i=l([m(0,d.IBufferService),m(1,d.ILogService),m(2,d.IOptionsService)],i)},9074:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DecorationService=void 0;const l=n(8055),m=n(8460),a=n(844),h=n(6106);let u=0,d=0;class f extends a.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(s=>s==null?void 0:s.marker.line),this._onDecorationRegistered=this.register(new m.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new m.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,a.toDisposable)(()=>this.reset()))}registerDecoration(s){if(s.marker.isDisposed)return;const o=new t(s);if(o){const p=o.marker.onDispose(()=>o.dispose());o.onDispose(()=>{o&&(this._decorations.delete(o)&&this._onDecorationRemoved.fire(o),p.dispose())}),this._decorations.insert(o),this._onDecorationRegistered.fire(o)}return o}reset(){for(const s of this._decorations.values())s.dispose();this._decorations.clear()}*getDecorationsAtCell(s,o,p){var g,C,T;let _=0,k=0;for(const D of this._decorations.getKeyIterator(o))_=(g=D.options.x)!==null&&g!==void 0?g:0,k=_+((C=D.options.width)!==null&&C!==void 0?C:1),s>=_&&s<k&&(!p||((T=D.options.layer)!==null&&T!==void 0?T:"bottom")===p)&&(yield D)}forEachDecorationAtCell(s,o,p,g){this._decorations.forEachByKey(o,C=>{var T,_,k;u=(T=C.options.x)!==null&&T!==void 0?T:0,d=u+((_=C.options.width)!==null&&_!==void 0?_:1),s>=u&&s<d&&(!p||((k=C.options.layer)!==null&&k!==void 0?k:"bottom")===p)&&g(C)})}}r.DecorationService=f;class t extends a.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=l.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=l.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(s){super(),this.options=s,this.onRenderEmitter=this.register(new m.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new m.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=s.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.InstantiationService=r.ServiceCollection=void 0;const l=n(2585),m=n(8343);class a{constructor(...u){this._entries=new Map;for(const[d,f]of u)this.set(d,f)}set(u,d){const f=this._entries.get(u);return this._entries.set(u,d),f}forEach(u){for(const[d,f]of this._entries.entries())u(d,f)}has(u){return this._entries.has(u)}get(u){return this._entries.get(u)}}r.ServiceCollection=a,r.InstantiationService=class{constructor(){this._services=new a,this._services.set(l.IInstantiationService,this)}setService(h,u){this._services.set(h,u)}getService(h){return this._services.get(h)}createInstance(h,...u){const d=(0,m.getServiceDependencies)(h).sort((i,s)=>i.index-s.index),f=[];for(const i of d){const s=this._services.get(i.id);if(!s)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${i.id}.`);f.push(s)}const t=d.length>0?d[0].index:u.length;if(u.length!==t)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${t+1} conflicts with ${u.length} static arguments`);return new h(...u,...f)}}},7866:function(x,r,n){var l=this&&this.__decorate||function(t,i,s,o){var p,g=arguments.length,C=g<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(t,i,s,o);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(C=(g<3?p(C):g>3?p(i,s,C):p(i,s))||C);return g>3&&C&&Object.defineProperty(i,s,C),C},m=this&&this.__param||function(t,i){return function(s,o){i(s,o,t)}};Object.defineProperty(r,"__esModule",{value:!0}),r.traceCall=r.setTraceLogger=r.LogService=void 0;const a=n(844),h=n(2585),u={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let d,f=r.LogService=class extends a.Disposable{get logLevel(){return this._logLevel}constructor(t){super(),this._optionsService=t,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),d=this}_updateLogLevel(){this._logLevel=u[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let i=0;i<t.length;i++)typeof t[i]=="function"&&(t[i]=t[i]())}_log(t,i,s){this._evalLazyOptionalParams(s),t.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+i,...s)}trace(t,...i){var s,o;this._logLevel<=h.LogLevelEnum.TRACE&&this._log((o=(s=this._optionsService.options.logger)===null||s===void 0?void 0:s.trace.bind(this._optionsService.options.logger))!==null&&o!==void 0?o:console.log,t,i)}debug(t,...i){var s,o;this._logLevel<=h.LogLevelEnum.DEBUG&&this._log((o=(s=this._optionsService.options.logger)===null||s===void 0?void 0:s.debug.bind(this._optionsService.options.logger))!==null&&o!==void 0?o:console.log,t,i)}info(t,...i){var s,o;this._logLevel<=h.LogLevelEnum.INFO&&this._log((o=(s=this._optionsService.options.logger)===null||s===void 0?void 0:s.info.bind(this._optionsService.options.logger))!==null&&o!==void 0?o:console.info,t,i)}warn(t,...i){var s,o;this._logLevel<=h.LogLevelEnum.WARN&&this._log((o=(s=this._optionsService.options.logger)===null||s===void 0?void 0:s.warn.bind(this._optionsService.options.logger))!==null&&o!==void 0?o:console.warn,t,i)}error(t,...i){var s,o;this._logLevel<=h.LogLevelEnum.ERROR&&this._log((o=(s=this._optionsService.options.logger)===null||s===void 0?void 0:s.error.bind(this._optionsService.options.logger))!==null&&o!==void 0?o:console.error,t,i)}};r.LogService=f=l([m(0,h.IOptionsService)],f),r.setTraceLogger=function(t){d=t},r.traceCall=function(t,i,s){if(typeof s.value!="function")throw new Error("not supported");const o=s.value;s.value=function(...p){if(d.logLevel!==h.LogLevelEnum.TRACE)return o.apply(this,p);d.trace(`GlyphRenderer#${o.name}(${p.map(C=>JSON.stringify(C)).join(", ")})`);const g=o.apply(this,p);return d.trace(`GlyphRenderer#${o.name} return`,g),g}}},7302:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.OptionsService=r.DEFAULT_OPTIONS=void 0;const l=n(8460),m=n(844),a=n(6114);r.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:a.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class u extends m.Disposable{constructor(f){super(),this._onOptionChange=this.register(new l.EventEmitter),this.onOptionChange=this._onOptionChange.event;const t=Object.assign({},r.DEFAULT_OPTIONS);for(const i in f)if(i in t)try{const s=f[i];t[i]=this._sanitizeAndValidateOption(i,s)}catch(s){console.error(s)}this.rawOptions=t,this.options=Object.assign({},t),this._setupOptions()}onSpecificOptionChange(f,t){return this.onOptionChange(i=>{i===f&&t(this.rawOptions[f])})}onMultipleOptionChange(f,t){return this.onOptionChange(i=>{f.indexOf(i)!==-1&&t()})}_setupOptions(){const f=i=>{if(!(i in r.DEFAULT_OPTIONS))throw new Error(`No option with key "${i}"`);return this.rawOptions[i]},t=(i,s)=>{if(!(i in r.DEFAULT_OPTIONS))throw new Error(`No option with key "${i}"`);s=this._sanitizeAndValidateOption(i,s),this.rawOptions[i]!==s&&(this.rawOptions[i]=s,this._onOptionChange.fire(i))};for(const i in this.rawOptions){const s={get:f.bind(this,i),set:t.bind(this,i)};Object.defineProperty(this.options,i,s)}}_sanitizeAndValidateOption(f,t){switch(f){case"cursorStyle":if(t||(t=r.DEFAULT_OPTIONS[f]),!function(i){return i==="block"||i==="underline"||i==="bar"}(t))throw new Error(`"${t}" is not a valid value for ${f}`);break;case"wordSeparator":t||(t=r.DEFAULT_OPTIONS[f]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=h.includes(t)?t:r.DEFAULT_OPTIONS[f];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${f} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(10*t)/10));break;case"scrollback":if((t=Math.min(t,4294967295))<0)throw new Error(`${f} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${f} cannot be less than or equal to 0, value: ${t}`);break;case"rows":case"cols":if(!t&&t!==0)throw new Error(`${f} must be numeric, value: ${t}`);break;case"windowsPty":t=t??{}}return t}}r.OptionsService=u},2660:function(x,r,n){var l=this&&this.__decorate||function(u,d,f,t){var i,s=arguments.length,o=s<3?d:t===null?t=Object.getOwnPropertyDescriptor(d,f):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(u,d,f,t);else for(var p=u.length-1;p>=0;p--)(i=u[p])&&(o=(s<3?i(o):s>3?i(d,f,o):i(d,f))||o);return s>3&&o&&Object.defineProperty(d,f,o),o},m=this&&this.__param||function(u,d){return function(f,t){d(f,t,u)}};Object.defineProperty(r,"__esModule",{value:!0}),r.OscLinkService=void 0;const a=n(2585);let h=r.OscLinkService=class{constructor(u){this._bufferService=u,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(u){const d=this._bufferService.buffer;if(u.id===void 0){const p=d.addMarker(d.ybase+d.y),g={data:u,id:this._nextId++,lines:[p]};return p.onDispose(()=>this._removeMarkerFromLink(g,p)),this._dataByLinkId.set(g.id,g),g.id}const f=u,t=this._getEntryIdKey(f),i=this._entriesWithId.get(t);if(i)return this.addLineToLink(i.id,d.ybase+d.y),i.id;const s=d.addMarker(d.ybase+d.y),o={id:this._nextId++,key:this._getEntryIdKey(f),data:f,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(o,s)),this._entriesWithId.set(o.key,o),this._dataByLinkId.set(o.id,o),o.id}addLineToLink(u,d){const f=this._dataByLinkId.get(u);if(f&&f.lines.every(t=>t.line!==d)){const t=this._bufferService.buffer.addMarker(d);f.lines.push(t),t.onDispose(()=>this._removeMarkerFromLink(f,t))}}getLinkData(u){var d;return(d=this._dataByLinkId.get(u))===null||d===void 0?void 0:d.data}_getEntryIdKey(u){return`${u.id};;${u.uri}`}_removeMarkerFromLink(u,d){const f=u.lines.indexOf(d);f!==-1&&(u.lines.splice(f,1),u.lines.length===0&&(u.data.id!==void 0&&this._entriesWithId.delete(u.key),this._dataByLinkId.delete(u.id)))}};r.OscLinkService=h=l([m(0,a.IBufferService)],h)},8343:(x,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createDecorator=r.getServiceDependencies=r.serviceRegistry=void 0;const n="di$target",l="di$dependencies";r.serviceRegistry=new Map,r.getServiceDependencies=function(m){return m[l]||[]},r.createDecorator=function(m){if(r.serviceRegistry.has(m))return r.serviceRegistry.get(m);const a=function(h,u,d){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(f,t,i){t[n]===t?t[l].push({id:f,index:i}):(t[l]=[{id:f,index:i}],t[n]=t)})(a,h,d)};return a.toString=()=>m,r.serviceRegistry.set(m,a),a}},2585:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.IDecorationService=r.IUnicodeService=r.IOscLinkService=r.IOptionsService=r.ILogService=r.LogLevelEnum=r.IInstantiationService=r.ICharsetService=r.ICoreService=r.ICoreMouseService=r.IBufferService=void 0;const l=n(8343);var m;r.IBufferService=(0,l.createDecorator)("BufferService"),r.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),r.ICoreService=(0,l.createDecorator)("CoreService"),r.ICharsetService=(0,l.createDecorator)("CharsetService"),r.IInstantiationService=(0,l.createDecorator)("InstantiationService"),function(a){a[a.TRACE=0]="TRACE",a[a.DEBUG=1]="DEBUG",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.OFF=5]="OFF"}(m||(r.LogLevelEnum=m={})),r.ILogService=(0,l.createDecorator)("LogService"),r.IOptionsService=(0,l.createDecorator)("OptionsService"),r.IOscLinkService=(0,l.createDecorator)("OscLinkService"),r.IUnicodeService=(0,l.createDecorator)("UnicodeService"),r.IDecorationService=(0,l.createDecorator)("DecorationService")},1480:(x,r,n)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.UnicodeService=void 0;const l=n(8460),m=n(225);r.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;const a=new m.UnicodeV6;this.register(a),this._active=a.version,this._activeProvider=a}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(a){if(!this._providers[a])throw new Error(`unknown Unicode version "${a}"`);this._active=a,this._activeProvider=this._providers[a],this._onChange.fire(a)}register(a){this._providers[a.version]=a}wcwidth(a){return this._activeProvider.wcwidth(a)}getStringCellWidth(a){let h=0;const u=a.length;for(let d=0;d<u;++d){let f=a.charCodeAt(d);if(55296<=f&&f<=56319){if(++d>=u)return h+this.wcwidth(f);const t=a.charCodeAt(d);56320<=t&&t<=57343?f=1024*(f-55296)+t-56320+65536:h+=this.wcwidth(t)}h+=this.wcwidth(f)}return h}}}},b={};function y(x){var r=b[x];if(r!==void 0)return r.exports;var n=b[x]={exports:{}};return v[x].call(n.exports,n,n.exports,y),n.exports}var E={};return(()=>{var x=E;Object.defineProperty(x,"__esModule",{value:!0}),x.Terminal=void 0;const r=y(9042),n=y(3236),l=y(844),m=y(5741),a=y(8285),h=y(7975),u=y(7090),d=["cols","rows"];class f extends l.Disposable{constructor(i){super(),this._core=this.register(new n.Terminal(i)),this._addonManager=this.register(new m.AddonManager),this._publicOptions=Object.assign({},this._core.options);const s=p=>this._core.options[p],o=(p,g)=>{this._checkReadonlyOptions(p),this._core.options[p]=g};for(const p in this._core.options){const g={get:s.bind(this,p),set:o.bind(this,p)};Object.defineProperty(this._publicOptions,p,g)}}_checkReadonlyOptions(i){if(d.includes(i))throw new Error(`Option "${i}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new u.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new a.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const i=this._core.coreService.decPrivateModes;let s="none";switch(this._core.coreMouseService.activeProtocol){case"X10":s="x10";break;case"VT200":s="vt200";break;case"DRAG":s="drag";break;case"ANY":s="any"}return{applicationCursorKeysMode:i.applicationCursorKeys,applicationKeypadMode:i.applicationKeypad,bracketedPasteMode:i.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:s,originMode:i.origin,reverseWraparoundMode:i.reverseWraparound,sendFocusMode:i.sendFocus,wraparoundMode:i.wraparound}}get options(){return this._publicOptions}set options(i){for(const s in i)this._publicOptions[s]=i[s]}blur(){this._core.blur()}focus(){this._core.focus()}resize(i,s){this._verifyIntegers(i,s),this._core.resize(i,s)}open(i){this._core.open(i)}attachCustomKeyEventHandler(i){this._core.attachCustomKeyEventHandler(i)}registerLinkProvider(i){return this._core.registerLinkProvider(i)}registerCharacterJoiner(i){return this._checkProposedApi(),this._core.registerCharacterJoiner(i)}deregisterCharacterJoiner(i){this._checkProposedApi(),this._core.deregisterCharacterJoiner(i)}registerMarker(i=0){return this._verifyIntegers(i),this._core.registerMarker(i)}registerDecoration(i){var s,o,p;return this._checkProposedApi(),this._verifyPositiveIntegers((s=i.x)!==null&&s!==void 0?s:0,(o=i.width)!==null&&o!==void 0?o:0,(p=i.height)!==null&&p!==void 0?p:0),this._core.registerDecoration(i)}hasSelection(){return this._core.hasSelection()}select(i,s,o){this._verifyIntegers(i,s,o),this._core.select(i,s,o)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(i,s){this._verifyIntegers(i,s),this._core.selectLines(i,s)}dispose(){super.dispose()}scrollLines(i){this._verifyIntegers(i),this._core.scrollLines(i)}scrollPages(i){this._verifyIntegers(i),this._core.scrollPages(i)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(i){this._verifyIntegers(i),this._core.scrollToLine(i)}clear(){this._core.clear()}write(i,s){this._core.write(i,s)}writeln(i,s){this._core.write(i),this._core.write(`\r
`,s)}paste(i){this._core.paste(i)}refresh(i,s){this._verifyIntegers(i,s),this._core.refresh(i,s)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(i){this._addonManager.loadAddon(this,i)}static get strings(){return r}_verifyIntegers(...i){for(const s of i)if(s===1/0||isNaN(s)||s%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...i){for(const s of i)if(s&&(s===1/0||isNaN(s)||s%1!=0||s<0))throw new Error("This API only accepts positive integers")}}x.Terminal=f})(),E})())})(tl);var Ji={},il={get exports(){return Ji},set exports(e){Ji=e}};(function(e,c){(function(v,b){e.exports=b()})(self,()=>(()=>{var v={};return(()=>{var b=v;Object.defineProperty(b,"__esModule",{value:!0}),b.FitAddon=void 0,b.FitAddon=class{activate(y){this._terminal=y}dispose(){}fit(){const y=this.proposeDimensions();if(!y||!this._terminal||isNaN(y.cols)||isNaN(y.rows))return;const E=this._terminal._core;this._terminal.rows===y.rows&&this._terminal.cols===y.cols||(E._renderService.clear(),this._terminal.resize(y.cols,y.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const y=this._terminal._core,E=y._renderService.dimensions;if(E.css.cell.width===0||E.css.cell.height===0)return;const x=this._terminal.options.scrollback===0?0:y.viewport.scrollBarWidth,r=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(r.getPropertyValue("height")),l=Math.max(0,parseInt(r.getPropertyValue("width"))),m=window.getComputedStyle(this._terminal.element),a=n-(parseInt(m.getPropertyValue("padding-top"))+parseInt(m.getPropertyValue("padding-bottom"))),h=l-(parseInt(m.getPropertyValue("padding-right"))+parseInt(m.getPropertyValue("padding-left")))-x;return{cols:Math.max(2,Math.floor(h/E.css.cell.width)),rows:Math.max(1,Math.floor(a/E.css.cell.height))}}}})(),v})())})(il);const Mn="10.0.24223.355",Ws={RESET:"\x1B[0m",BLACK:"\x1B[30m",RED:"\x1B[31m",GREEN:"\x1B[32m",LIGHT_YELLOW:"\x1B[93m",YELLOW:"\x1B[33m",YELLOW_BACKGROUND:"\x1B[43m",BLUE:"\x1B[34m",PURPLE:"\x1B[35m",CYAN:"\x1B[36m",WHITE:"\x1B[37m",BOLD:"\x1B[1m",UNBOLD:"\x1B[21m",UNDERLINE:"\x1B[4m",STOP_UNDERLINE:"\x1B[24m",BLINK:"\x1B[5m"};function sl(e){const c=v=>{const b=rt.getState("USER_HOME").USER_HOME;let y=b,E="",x=0,r="",n=navigator.clipboard,l="",m=0,a=[],h=0;function u(S){y=S.replace(/\\+/g,"/"),E=y+">",x=E.length}u(b),G(e)&&u(e),me.readFile(b+"/.cmdHistory",(S,B)=>{!S&&G(B)&&B.text().then(H=>{try{a=JSON.parse(H),h=a.length-1}catch{}})});const d=new Zi.Terminal({cursorBlink:!0,cursorStyle:"underline",allowTransparency:!0,fontFamily:"Consolas"}),f=new Ji.FitAddon;d.loadAddon(f);let t;t=w("div",{className:"w-full h-full",onmousedown:_}),d.open(t);const i={cls:"Clears the screen.",dir:"Displays a list of files and subdirectories in a directory.",cd:"Displays the name of or changes the current directory.",mkdir:"Creates a directory.",rm:"Removes a directory.",print:"Prints a text file.",help:"Provides Help information for Windows commands.",exit:"Quits"};function s(){Object.keys(i).forEach(S=>{d.write(`\r
`+S+"	"+i[S])}),d.write(`\r
`),g()}const o=`[Version ${Mn}]`;function p(){return Ws.GREEN+E+Ws.WHITE}function g(){d.write(`\r
`+p())}o.split(`
`).map(S=>d.writeln(S)),g(),d.onKey(({key:S,domEvent:B})=>{const H=B.key;if(!/^(?!F[0-9]).*/g.test(H))return;const F=!B.altKey&&!B.ctrlKey&&!B.metaKey;if(B.ctrlKey){const O=H.toLowerCase();O==="l"?d.clear():O==="a"?d.selectAll():O==="c"?d.hasSelection()?C():(l="",g()):O==="v"&&T();return}if(H===Be.ArrowLeft)d.buffer.active.cursorX>x&&d.write("\x1B[1D");else if(H===Be.ArrowRight)d.buffer.active.cursorX<l.length+x&&d.write("\x1B[1C");else if(H===Be.ArrowUp)a.length>0&&(l=a[h],d.write("\x1B[2K\r"+p()+l),h>0&&(h-=1));else if(H===Be.ArrowDown)h+1<a.length&&(h+=1,l=a[h],d.write("\x1B[2K\r"+p()+l));else if(H===Be.BackSpace){if(d.buffer.active.cursorX>x)if(d.buffer.active.cursorX===x+l.length)l=l.slice(0,-1),d.write("\b \b");else{const O=l.slice(0,d.buffer.active.cursorX-x-1),P=l.slice(d.buffer.active.cursorX-x);l=O+P,m=x+l.length-d.buffer.active.cursorX+1,d.write("\x1B[2K\r"+p()+l+"\x1B["+m+"D")}}else if(H===Be.Delete){if(d.buffer.active.cursorX>=x&&d.buffer.active.cursorX<x+l.length){const O=E+l,P=O.slice(x,d.buffer.active.cursorX),L=O.slice(d.buffer.active.cursorX+1,O.length);l=P+L,m=x+l.length-d.buffer.active.cursorX,d.write("\x1B[2K\r"+p()+l+(L.length>0?"\x1B["+m+"D":""))}}else if(H===Be.Home)d.buffer.active.cursorX>x&&(m=d.buffer.active.cursorX-x,d.write("\x1B["+m+"D"));else if(H===Be.End){const O=E+l;d.buffer.active.cursorX<O.length&&(m=O.length-d.buffer.active.cursorX,d.write("\x1B["+m+"C"))}else{if(H===Be.Insert)return;if(H===Be.Enter)l.replace(/^\s+|\s+$/g,"").length!=0?D(l):g(),l="";else{if(H===Be.Tab)return;if(F){if(d.buffer.active.cursorX===x+l.length)l+=S,d.write(S);else if(d.buffer.active.cursorX<x+l.length){const O=E+l,P=O.slice(x,d.buffer.active.cursorX),L=O.slice(d.buffer.active.cursorX,O.length);l=P+S+L,m=x+l.length-d.buffer.active.cursorX-1,d.write("\x1B[2K\r"+p()+l+(L.length>0?"\x1B["+m+"D":""))}}}}});function C(){r=d.getSelection(),n.writeText(r)}function T(){n.readText().then(S=>{if(d.buffer.active.cursorX===x+l.length)d.write(S),l=l+S;else if(d.buffer.active.cursorX<x+l.length){const B=E+l,H=B.slice(x,d.buffer.active.cursorX),F=B.slice(d.buffer.active.cursorX,B.length);l=H+S+F,m=x+l.length-d.buffer.active.cursorX,d.write("\x1B[2K\r"+p()+l+(F.length>0?"\x1B["+m+"D":""))}})}function _(S){S.button===2&&(d.hasSelection()?(C(),d.clearSelection()):T())}function k(S){const B=S.replace(/\\+/g,"/").replace(/\/+/g,"/").split("/").filter(F=>F!=="");let H=y.split("/").filter(F=>F!=="");for(let F of B)F==="~"?H=b.split("/").filter(O=>O!==""):F===".."?H.length-1>0&&H.splice(H.length-1,1):H.push(F);return H.join("/")}function D(S){f.fit(),h=a.push(S)-1,me.writeFile(b+"/.cmdHistory",new Blob([JSON.stringify(a)]));let B=[];if(S.indexOf('"')>-1?B=S.split('"'):S.indexOf("'")>-1?B=S.split("'"):B=S.split(" "),B=B.filter(O=>O!==""),!B.length)return;const H=B[0].replace(/\s+/g,"");let F=B[1];if(G(i[H])){if(H==="dir"){let O=function(){d.write(`\r
The system cannot find the path specified.
`),g()},P=function(L){me.readFolder(L,(I,A)=>{if(I)M(I);else{d.write(`\r
Directory of `+L+`
`);const N=A.some(q=>q.type!=="folder"),z=A.some(q=>q.type==="folder"),j=A.every(q=>q.type!=="folder"),V=A.every(q=>q.type==="folder");A.forEach(q=>{const Z=new Date(q.mdate);d.write(`\r
`+ji(Z)+"  "+It(Z)+"	"+(N&&z?(q.type==="folder"?"<DIR> 	 	":" 	")+(Vi(q.size)?q.size.toPrecision()+"	":""):(V&&q.type==="folder"?"<DIR>	":"")+(j&&Vi(q.size)?q.size.toPrecision()+"		":""))+q.name)}),d.write(`\r
`),g()}})};if(F||(F=y),Xe(F)||bt(F))P(F);else if(Xt(F)){const L=k(F);P(L)}else O()}else if(H==="exit")g(),setTimeout(()=>{v.close()},200);else if(H==="cls")d.clear(),l="",d.write("\x1B[2K\r"+p());else if(H==="help")s();else if(H==="cd"){let O=function(){d.write(`\r
The system cannot find the path specified.
`),g()};if(!F)O();else if(Xe(F)||bt(F))me.stats(F,P=>{P?(d.write(`\r
`+P.message),O()):(u(F),g())});else if(Xt(F)){const P=k(F);me.stats(P,L=>{L?O():(u(P),g())})}else O()}else if(H==="mkdir"){let O=function(P){P?d.write(`\r
`+P+`
`):d.write(`\r
The system cannot find the path specified.
`),g()};if(!F)O();else if(Xe(F))me.createFolder(F,P=>{P?O(P.message):g()});else if(Xt(F)){const P=k(F);me.createFolder(P,L=>{L?O(L.message):g()})}else bt(F)?(d.write(`\r
Folder already exisist!`),g()):O()}else if(H==="rm"){let O=function(P){P?d.write(`\r
`+P+`
`):d.write(`\r
The system cannot find the path specified.
`),g()};if(!F)O();else{let P=function(L,I,A=0){const N=I[A];if(!G(N)){g();return}me.unlink(L+"/"+N.name,z=>{z?(O(z.message),g()):P(L,I,A+1)})};if(F=F.trim(),F==="*")me.readFolder(y,(L,I)=>{L?(O(L.message),g()):P(y,I),g()});else if(Xe(F)){const L=F.replace(/\\+/g,"/").replace(/\/+/g,"/");if(y.indexOf(L)>-1){O("Can not execute this action!");return}me.unlink(L,I=>{I?O(I.message):g()})}else if(Xt(F)){const L=k(F);if(y.indexOf(L)>-1){O("Can not execute this action!");return}me.unlink(L,I=>{I?O(I.message):g()})}else O()}}else if(H==="print"){let O=function(L){L?d.write(`\r
`+L+`
`):d.write(`\r
The system cannot find the path specified.
`),g()},P=function(L){if(y.indexOf(L)>-1){O("Can not execute this action!");return}me.readFile(L,(I,A)=>{I?O(I.message):G(A)?A.size>1e4?(d.write(`\r
Name: `+(A.name||et(L))+" Size: "+A.size),g()):A.text().then(N=>{const z=N.split(`
`);for(let j of z)d.write(`\r
`+j);d.write(`\r
`),g()}):O()})};if(!F)O();else if(Xe(F)){const L=F.replace(/\\+/g,"/").replace(/\/+/g,"/");P(L)}else if(Xt(F)){const L=k(F);P(L)}else O()}}else G(ki[H])?(g(),ki[H](F)):(d.write(`\r
"`+H+`" is not recognized as an internal or external command, operable program or batch file.
`),d.write(`\r
Type "help" for available commands
`),g())}function M(S){d.write(`\r
`+S.message+`
`),g()}return v.addEventListener("focus",()=>{d.focus()}),v.addEventListener("close",()=>{d.dispose()}),v.addEventListener("passiveResize",ia(()=>{f.fit()},200)),v.addEventListener("ready",()=>{f.fit()}),t};lt({icon:ie.cmd.icon,name:ie.cmd.name,title:ie.cmd.productName,top:100,left:100,width:800,height:450,center:!0,content:c,className:"cmd-app",extendContextMenu:[{divider:!0},{text:"Properties"}]})}function nl(e){lt({args:e,icon:wt.mediaPlayer.icon,hideIcon:!0,name:wt.mediaPlayer.name,title:wt.mediaPlayer.productName,autoHideTitleBar:!0,top:50,left:50,width:800,height:480,minWidth:300,minHeight:100,center:!0,singleInstance:!0,content:c=>{let v;function b(y){const E=gt(y);if(Mi(E)){const x=w("div",{className:"w-full h-full relative"},[w("video",{className:"w-full h-full",controls:!0,autoplay:!0,style:{objectFit:"contain"},mySrc:y})]);return c.setSize({width:800,height:480}),c.setTitle(et(y)),x}if(Uo(E)){const x=w("div",{className:"w-full h-full relative p-20"},[w("audio",{className:"w-full h-full",controls:!0,autoplay:!0,mySrc:y})]);return c.setSize({width:800,height:124}),c.setTitle(et(y)),x}return w("div",{},"Not supported file")}return c.addEventListener("secondInstance",y=>{v=b(y),c.setContent(v),c.isVisible()||c.show(),c.focus()}),c.addEventListener("ready",()=>{v=b(e),c.setContent(v)}),null}})}function rl(e){if(!G(e)){Fe("photos");return}lt({args:e,icon:wt.photoViewer.icon,hideIcon:!0,name:wt.photoViewer.name,title:wt.photoViewer.productName,hideTitle:!0,top:50,left:50,width:800,height:480,minWidth:580,minHeight:200,center:!0,singleInstance:!0,titlebarHeight:40,stretchTitlebarContent:!0,transprencyContent:!0,content:c=>{let v,b,y,E,x,r,n,l,m=0,a=0,h=0,u=0,d=0,f=0,t=0,i=0,s,o=0,p=0,g=0,C=0,T,_;b=w("div",{className:"photo-viewer-titlebar-content w-full h-full flex items-center"},[w("div",{className:"flex items-center flex-1 h-full"},[w("div",{className:"photo-viewer-titlebar-home flex items-center content-center flex-shrink-0",style:{width:"40px",height:"40px"},innerHTML:en(20),onclick(){Fe("photos")}}),w("div",{["drag-region"]:"drag",className:"w-full h-full flex items-center",style:{padding:"0 10px"}},y=w("div",{className:"text-ellipsis line-clamp-1"}))]),w("div",{className:"flex items-center content-center h-full"},[w("div",{title:"Edit Image",className:"photo-viewer-titlebar-content-button",innerHTML:zr()}),w("div",{title:"Rotate",className:"photo-viewer-titlebar-content-button",innerHTML:br}),w("div",{title:"Delete",className:"photo-viewer-titlebar-content-button",innerHTML:qr()}),w("div",{title:"Add to favorites",className:"photo-viewer-titlebar-content-button",innerHTML:Xr()}),w("div",{title:"Print",className:"photo-viewer-titlebar-content-button",innerHTML:Gr()}),w("div",{title:"Share",className:"photo-viewer-titlebar-content-button",innerHTML:Yr()}),w("div",{title:"More options",className:"photo-viewer-titlebar-content-button",innerHTML:Qs(),onclick(U){const Y=U.currentTarget,W=Y.getBoundingClientRect();Vt({top:W.top+W.height,left:W.left},Y,[{text:"Set as desktop wallpaper",onClick(){Xe(l)?hs(l,(_e,Q)=>{_e||te(URL.createObjectURL(Q))}):te(l);function te(_e){as(_e,(Q,re)=>{const ee=et(l),we=rt.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/"+"Thumbnails/"+ee;me.writeFile(we,re,()=>{Ue.setBackgroundImage({name:ee,path:l,thumbnailPath:we})})})}c.focus()}},{text:"Resize image",onClick(){c.focus()}},{text:"Copy as path",onClick(){c.focus()}},{text:"Settings",onClick(){c.focus()}}],!1)}})]),w("div",{["drag-region"]:"drag",className:"flex items-center flex-1 h-full"})]),c.titlebar.setTitlebarContent(b),v=w("div",{className:"w-full h-full",style:{position:"relative",paddingBottom:"40px"}},[x=w("div",{className:"w-full h-full flex items-center content-center",style:{position:"relative",overflow:"hidden"},onwheel:O,ontouchstart:M},E=w("div",{className:"photo-viewer-container w-full h-full",onmousedown:D})),w("div",{className:"photo-viewer-bottom flex items-center"},[w("div",{}),w("div",{className:"flex items-center",style:{marginLeft:"auto"}},[r=w("div",{style:{paddingRight:"10px"}}),w("div",{title:"Zoom out",className:"photo-viewer-bottom-button",innerHTML:Ur(18),onclick:()=>{V(-1)}}),w("div",{title:"Zoom in",className:"photo-viewer-bottom-button",innerHTML:$r(18),onclick:()=>{V(1)}}),w("div",{title:"Zoom to fit",className:"photo-viewer-bottom-button",innerHTML:jr(18),onclick:z}),w("div",{title:"Zoom to actual size",className:"photo-viewer-bottom-button",innerHTML:Vr(18),onclick:j}),w("div",{title:"Fullscreen",className:"photo-viewer-bottom-button",innerHTML:Kr(14),onclick:()=>{c.toggleFullscreen()}})])])]);function k(U){const Y=gt(U);if(!Di(Y)){E.textContent="Not supported file";return}$o(U,te=>{G(te)&&(l=U,E.textContent="",E.style.myBackgroundImage=U,s=te,A(),(s.width>n.width||s.height>n.height)&&z(),s.width<n.width&&s.height<n.height&&N())});const W=et(U);c.setTitle(W),y.textContent=W}function D(U){U.button===0&&(U.preventDefault(),g=U.clientX,C=U.clientY,document.onmouseup=F,document.onmousemove=S)}function M(U){U.touches.length===1?(U.preventDefault(),g=U.touches[0].clientX,C=U.touches[0].clientY,window.addEventListener("touchmove",B,!1),window.addEventListener("touchend",F,!1)):U.touches.length===2&&(U.preventDefault(),T=U.touches[0],_=U.touches[1],window.addEventListener("touchmove",P,!1),window.addEventListener("touchend",L,!1))}function S(U){o=g-U.clientX,p=C-U.clientY,g=U.clientX,C=U.clientY,H()}function B(U){const Y=U.touches[0];o=g-Y.clientX,p=C-Y.clientY,g=Y.clientX,C=Y.clientY,H()}function H(){const U=E.offsetTop-p,Y=E.offsetLeft-o;h>n.width&&(Y>0?a=0:Y+h<n.width?a=n.width-h:a=Y,E.style.left=a+"px"),u>n.height&&(U>0?m=0:U+u<n.height?m=n.height-u:m=U,E.style.top=m+"px")}function F(){document.onmouseup=null,document.onmousemove=null,window.removeEventListener("touchmove",B,!1),window.removeEventListener("touchend",F,!1)}function O(U){let Y=U.deltaY>0?-1:1;t=U.offsetX,i=U.offsetY,V(Y)}function P(U){const Y=U.touches[0],W=U.touches[1],te=E.getBoundingClientRect();let _e=Math.abs(W.clientX-Y.clientX)-Math.abs(_.clientX-T.clientX),Q=Math.abs(W.clientY-Y.clientY)-Math.abs(_.clientY-T.clientY),re=_e>0||Q>0?1:-1;T.clientX===Y.clientX?t=T.clientX-te.x:_.clientX===W.clientX?t=_.clientX-te.x:t=W.clientX-Y.clientX-te.x,T.clientY===Y.clientY?i=T.clientY-te.y:_.clientY===W.clientY?i=_.clientY-te.y:i=W.clientY-Y.clientY-te.y,V(re,_e)}function L(){window.removeEventListener("touchmove",P,!1),window.removeEventListener("touchend",L,!1)}function I(){n={width:x.offsetWidth,height:x.offsetHeight}}function A(){if(R())f=100;else{const U=n.width/n.height;let Y=0;U<s.ratio?Y=n.width:Y=n.height*s.ratio,f=Y/s.width*100}}function N(){m=(n.height-s.height)/2,a=(n.width-s.width)/2,h=s.width,u=s.height,f=100,d=100,ve(E,{top:m+"px",left:a+"px",width:h+"px",height:u+"px"}),Z()}function z(){I();const U=n.width/n.height,Y={};if(U<s.ratio){const W=n.width/s.ratio;m=(n.height-W)/2,a=0,h=n.width,u=W}else{const W=n.height*s.ratio,te=(n.width-W)/2;m=0,a=te,h=W,u=n.height}d=h/s.width*100,h<n.width&&u<n.height?f=100:f=d,Y.top=m+"px",Y.left=a+"px",Y.width=h+"px",Y.height=u+"px",Z(),ve(E,Y)}function j(){q(100)}function V(U,Y){h<n.width&&(t=h/2),u<n.height&&(i=u/2);let W=h;G(Y)?W=h+h*.01*U:W=h+h*.1*U,(h<s.width&&s.width<W||h>s.width&&s.width>W)&&(W=s.width);let te=t/h,_e=i/u,Q=W/s.width*100;Q<f&&(Q=f,W=Q*s.width/100),Q>5e3&&(Q=5e3,W=Q*s.width/100),d=Q,h=W,u=h/s.ratio;let re=te*h-t,ee=_e*u-i;a-=re,m-=ee,U===-1&&(h>n.width?(a>0&&(a=0),a+h<n.width&&(a=n.width-h)):a=(n.width-h)/2,u>n.height?(m>0&&(m=0),m+u<n.height&&(m=n.height-u)):m=(n.height-u)/2),h<n.width&&u<n.height&&(m=(n.height-u)/2,a=(n.width-h)/2),ve(E,{width:h+"px",height:u+"px",top:m+"px",left:a+"px"}),Z()}function q(U){const Y=U*s.width/100,W=Y/s.ratio,te=.5*Y-h/2,_e=.5*W-u/2;d=U,m-=_e,a-=te,h=Y,u=W,ve(E,{top:m+"px",left:a+"px",width:h+"px",height:u+"px"}),Z()}function Z(){r.textContent=Math.round(d)+" %"}function R(){return I(),s.width<n.width&&s.height<n.height}function $(){d===f?R()?N():z():d>f&&(A(),a>0&&(a=0,E.style.left=a+"px"),h+a<n.width&&(a=(n.width-h)/2,E.style.left=a+"px"),m>0&&(m=0,E.style.top=m+"px"),u+m<n.height&&(m=(n.height-u)/2,E.style.top=m+"px"))}function X(){setTimeout(()=>{$()},250)}return c.addEventListener("resize",Ye(()=>{$()},50)),c.addEventListener("maximize",()=>{X()}),c.addEventListener("unmaximize",()=>{X()}),c.addEventListener("snap",()=>{X()}),c.addEventListener("unSnap",()=>{X()}),c.addEventListener("restore",()=>{X()}),c.addEventListener("fullscreen",()=>{X()}),c.addEventListener("secondInstance",U=>{c.isVisible()||c.show(),c.focus(),k(U)}),c.addEventListener("ready",()=>{c.setContent(v),k(e)}),null}})}const ki={settings:Qa,explorer:ba,notepad:Sa,word:()=>{qe(ie.word)},powerpoint:()=>{qe(ie.powerpoint)},onenote:()=>{qe(ie.onenote)},mail:()=>{qe(ie.mail)},todo:()=>{qe(ie.todo)},store:()=>{qe(ie.store)},photos:Aa,photoViewer:rl,mediaPlayer:nl,yourphone:()=>{qe(ie.yourphone)},whiteboard:()=>{qe(ie.whiteboard)},calculator:el,spotify:()=>{qe(ie.spotify)},twitter:()=>{qe(ie.twitter)},vscode:()=>{qe(ie.vscode)},terminal:()=>{qe(ie.terminal)},cmd:sl,github:()=>{qe(ie.github)},discord:()=>{qe(ie.discord)}};const In=vn();String.prototype.toFirstUpperCase=function(){return this.charAt(0).toUpperCase()+this.substring(1,this.length)};const ol=localStorage.getItem("OS_VERSION");G(ol)||(xe.reset(),localStorage.setItem("OS_VERSION",Mn));ea&&document.documentElement.classList.add("isWebkit");In&&document.documentElement.classList.add("isMobile");document.documentElement.style.setProperty("--taskbar-height",We.toString()+"px");document.addEventListener("dragover",e=>{e.preventDefault()});document.addEventListener("drop",e=>{e.preventDefault()});document.addEventListener("contextmenu",e=>{e.preventDefault()});const Ge=xe.getState();Ge.recentImages||(Ge.recentImages=[je[15],je[9],je[21],je[0],je[8]]);let Ei=Ge.themeIndex>-1?Ge.themes[Ge.themeIndex]:Ge.customTheme;G(Ei)||(Ei=Ge.themes[0],xe.setState({themeIndex:0}));G(Ge.brightness)&&ri.setBrightness(Ge.brightness);Ge.nightlight&&ri.setNightLight(Ge.nightlight);un(Ge.scale);qi(Ge.roundedCorner);fn(Ge.useBorder);gn(Ei);pn(Ei.background.thumbnailPath);In&&document.body.appendChild(w("div",{style:{position:"absolute",zIndex:"-100",width:"100%",height:window.innerHeight+50+"px"}}));function wi(e,c){const v=ki[e];G(v)?ki[e](c):Jo()}function al(e){if(e.type==="link")window.open(e.args,"_blank");else if(e.type==="app")wi(e.name,e.args);else if(e.type==="file"){const c=Ut(ta(e.args));wi(c.appName,e.args)}else e.type==="folder"&&wi(ie.explorer.name,e.args)}Ne(ae.createWindow,"index",({appName:e,args:c})=>{wi(e,c)});Ne(ae.startProcess,"index",e=>{al(e)});Ne(ae.backgroundImageChange,"index",e=>{pn(e.thumbnailPath)});me.addEventListener("ready","index",()=>{me.addEventListener("removed","index",e=>{oi.removeThumbnail(e)})});
